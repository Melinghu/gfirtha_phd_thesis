\documentclass[10pt,twoside]{article}
\usepackage[a5paper,inner=1.5cm,outer=2.0cm,top=2.0cm,bottom=2.5cm,pdftex]{geometry}
\usepackage[utf8]{inputenc}						% UTF-8 encoding
\usepackage[T1]{fontenc}
\usepackage[magyar,american]{babel}
\usepackage{palatino}							% Font
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm} 							% Theorem customization
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{overpic}
\usepackage{rotating}
\usepackage{multirow}
\usepackage{xcolor}
\usepackage[bf,small]{caption}
\usepackage[backend=bibtex,hyperref=true,babel=hyphen,style=numeric-comp,isbn=false,sorting=none,defernumbers=true,maxnames=10,doi=false,url=false]{biblatex}
\addbibresource{../LatexProject/dissertation.bib}


\usepackage[pdftitle={A Unified Wave Field Synthesis Theory (Ph.D. Thesis Booklet)},%
  pdfauthor={Gergely Firtha},% 
%  colorlinks=true,% 
%  urlcolor=blue,% 
%  linkcolor=blue,% 
%  citecolor=blue,% 
%  filecolor=green,% 
%  raiselinks=false,% 
  hyperfootnotes=true]{hyperref}

% Citation categories
\DeclareBibliographyCategory{journal} 
\DeclareBibliographyCategory{conference}
\DeclareBibliographyCategory{tech}
\DeclareBibliographyCategory{other}
% Citation commands
\newcommand*{\citeJ}[2][]{\addtocategory{journal}{#2}\cite[#1]{#2}}
\newcommand*{\citeC}[2][]{\addtocategory{conference}{#2}\cite[#1]{#2}}
\newcommand*{\citeO}[2][]{\addtocategory{other}{#2}\cite[#1]{#2}}
\newcommand*{\citeT}[2][]{\addtocategory{tech}{#2}\cite[#1]{#2}}
% No citation commands
\newcommand*{\nociteJ}[1]{\addtocategory{journal}{#1}\nocite{#1}}
\newcommand*{\nociteC}[1]{\addtocategory{conference}{#1}\nocite{#1}}
\newcommand*{\nociteO}[1]{\addtocategory{other}{#1}\nocite{#1}}
\newcommand*{\nociteT}[1]{\addtocategory{tech}{#1}\nocite{#1}}

%\def \mylastname {Firtha}
%\DeclareNameFormat{author}{%
%\ifthenelse{\equal{#1}{\mylastname}}%
%    {\underline{\ifblank{#4}{}{#4\space}#1}}%
%    {\ifblank{#4}{}{#4\space}#1}%
%\ifthenelse{\value{listcount}<\value{liststop}}%
%    {\addcomma\space}
%    {}}

\renewcommand{\bibfont}{\normalfont\small}
\newtheoremstyle{thesisgroupstyle}%
	{1em}% 				% Space above
	{0mm}% 				% Space below
	{\slshape}%			% Font type of body
	{0mm}%				% Indentation			
	{\bfseries}%		% Font of title
	{\newline}%			% Punctuation between head and body
	{1em}%				% Space after theorem head
	{}% 				% Manually specify head
\theoremstyle{thesisgroupstyle}
\newtheorem{thesisgroup}{Thesis group}
\renewcommand{\thethesisgroup}{\Roman{thesisgroup}}
\newtheorem{thesis}{Thesis}[thesisgroup]


\newcommand{\theauthor}{Gergely Firtha}
\newcommand{\authorprof}{M.Sc.E.E.}
\author{\theauthor}
\title{A Unified Wave Field Synthesis Theory\\[.5ex]with Application for Moving Virtual Sources}

\begin{document}

\newcommand{\schoolname}{Budapest University of Technology and Economics}
\newcommand{\facultyname}{Faculty of Electrical Engineering and Informatics}
\newcommand{\doctoralname}{Doctoral School of Electrical Engineering}
\newcommand{\bookname}{Ph.D.\ Thesis Booklet}
\newcommand{\authorname}{Author}
\newcommand{\supervisorname}{Supervisor}
\newcommand{\supervisor}{PÃ©ter Fiala, PhD.}
\newcommand{\creationdate}{Budapest, 2018.}
\def \deptlogo {logos/hit_logo_en.png}

\selectlanguage{american}
\nonfrenchspacing

\input{cover}
\thispagestyle{empty}
\cleardoublepage
\setcounter{page}{1}

\section{Introduction}

\subsection{Aim of sound field synthesis}
%
Spatial audio aims at the recreation of a sound scene containing sources of sound, termed as audio objects, in a sense that the human listener perceives the spatial characteristics of the desired acoustic environment.
Sound field reproduction achieves this by driving an arrangement of fix positioned loudspeakers, so that the superposition of the sound waves emerging from the individual loudspeakers generate the impression of the desired virtual audio object, present in the sound scene.
Sound field reproduction has been the subject of excessive study and development over the second half of the XX. century, starting with the work of Blumlein, who introduced the first two-loudspeaker system in 1931 and thereby created the basics of stereophony.
Modern stereophonic systems include the well-known Dolby stereo, 5.1, 7.1 systems, the 22.2 system of the NHK or the currently state-of-the-art commercial spatial audio systems, the Dolby Atmos and the DTS-X.
Generally speaking---independently from the number of the speakers applied---stereophony generates the desired spatial impression by the recreation of localization cues at the listener position.
Correct sound localization therefore can be ensured only over a limited listening area, termed as the \emph{sweet spot}, being a central limitation of these techniques.

Opposed to stereophony, the aim of sound field synthesis (SFS) is the reproduction of the physical properties of a desired sound field over an extended listening area. 
By doing so, it is inherently ensured that the listener perceives the desired perceptual properties in an arbitrary position within the listening region.
Obviously, controlling the sound field over an extended region requires numerous loudspeakers, positioned on the boundary of the control region.
Hence, these techniques are often referred to as \emph{massive multichannel sound reproduction methods} \footfullcite{Spors2013:Survey}.
The central question of SFS is the derivation of the loudspeaker driving signals, termed the \emph{driving function}, so that the resultant field of the loudspeaker arrangement coincides with the desired, \emph{virtual field}.
The loudspeaker array applied for reproduction is termed as the \emph{secondary source distribution} in the followings.
The general geometry is depicted in Figure \ref{fig:introduction:sfs_aim}.

\begin{figure}  
\small
  \begin{minipage}[c]{0.64\textwidth}
	\begin{overpic}[width = 1\columnwidth ]{figs/sfs_aim.png}
	\small
	\put(60,30){listening region}
	\put(0,45){\parbox{.5in}{virtual sound source}}
	\put(45,7){secondary source distribution}
	\end{overpic}   \end{minipage}\hfill
	\begin{minipage}[c]{0.3\textwidth}
    \caption{The general geometry for sound field synthesis: the goal of synthesis is to reproduce the physical properties of a virtual sound object, or primary source of sound inside a control region, bounded by a densely spaced loudspeaker ensemble.}
\label{fig:introduction:sfs_aim}  \end{minipage}
\end{figure}

Over the last several decades numerous SFS techniques emerged, approaching the problem both numerically and analytically.
Analytical approaches include the direct solution of the involved integral formulations, termed as the explicit solution, and the most traditional SFS technique, deriving driving function based on the Huygens principle, termed as Wave Field Synthesis.

\subsection{Wave Field Synthesis history}
%
The original theory of Wave Field Synthesis---often referred to as \emph{traditional WFS}---evolved from the works of Berkhout et al. at the Technical University of Delft utilizing concepts, well-known in the field of seismic migration.%, applied for sound field control.
The basis of WFS theory were the Rayleigh integrals, the mathematical form of the Huygens' principle, representing a sound field as the sum of spherical waves emerging from an infinite plane.
Berkhout applied the stationary phase method (SPA) to the Rayleigh integrals in order to arrive at loudspeaker driving signals for a linear array of loudspeakers instead of the practically infeasible planar array.
The original formulation provided driving signals for loudspeakers with dipole characteristics \footfullcite{Berkhout1988}\textsuperscript{,}\footfullcite{Berkhout1993:Acoustic_control_by_WFS}---soon extended for monopole loudspeakers as well \footfullcite{doi:10.1121/1.404755}\textsuperscript{,}\footfullcite{Start1997:phd}\textsuperscript{,}\footfullcite{Verheijen1997:phd}---, reproducing the wavefront of a virtual spherical wave in the horizontal plane, containing the loudspeaker array.
It was discussed that reducing the secondary source distribution from an enclosing surface to a more practical contour of loudspeakers, results that amplitude correct reproduction is restricted to a control curve in the plane of synthesis, termed here as the reference curve.
For traditional WFS this reference curve was usually chosen to be a reference line, parallel with the loudspeaker arrangement \footfullcite{Start1997:phd}.
Furthermore, the traditional approach considered exclusively virtual point sources as the virtual field model.

Traditional WFS was also the subject of various research projects, most notably the CARROUSO project, aiming at the integration of the technique into the MPEG-4 standard. This endeavor was not realized eventually, but two "spin-off" companies of the project, the IOSONO and Sonic Emotion are still offering commercially available WFS systems nowadays.

The latest milestone in Wave Field Synthesis theory were the works of Spors et al., generalizing WFS towards the synthesis of an arbitrary analytically available sound field, applying an arbitrary shaped loudspeaker contour \footfullcite{Spors2008:WFSrevisited}.
The presented loudspeaker driving signals allowed the synthesis of general 2-dimensional sound fields, ensuring amplitude correct synthesis at a single reference point,
allowing the reproduction of complex virtual sound scenes, e.g. the field, generated by a moving sound source \footfullcite{Ahrens2008moving}.
The method however---since it derived driving signals from the 2D Rayleigh integral---failed to control the amplitude of general 3D sound fields.
Furthermore, the exact connection between traditional and the latter \emph{revisited WFS} formulations has not been known so far.

\subsection{Motivation of the present research}
The present dissertation revisits the theoretical basics of Wave Field Synthesis.
The motivation behind the research was to give a unified theoretical framework for Wave Field Synthesis that allows the reproduction of an arbitrary analytically available virtual sound field, by applying an arbitrary secondary source contour, and optimizing the synthesis to an arbitrary reference curve.
Hence, the presented framework contains the previous WFS approaches as special cases: choosing the virtual source to a point source, applying a linear SSD and referencing the synthesis to a line, parallel with the SSD returns the well-known traditional WFS driving function.
Choosing the virtual source to be a general 2D sound field and referencing the synthesis to a single reference point results in the revisited WFS formulation.

Besides the connection between traditional and revisited WFS, also the exact link between WFS and the direct, explicit solution has not been investigated in the related literature for the case of an arbitrary virtual sound field.
For the special case of circular SSDs and specific virtual field models it has been shown that WFS constitutes a high frequency approximation for the explicit method \footfullcite{Ahrens2012}\textsuperscript{,}\footfullcite{Spors2010:analysis_and_improvement}.
A further motivation of the present research was hence to establish this connection for arbitrary virtual sound fields and arbitrary SSDs and reference curves.

As a complex application example for the presented framework the reproduction of moving virtual sources was investigated in details.
The reproduction of moving sources has been the subject of studies since the early age of WFS theory, as an obvious need when dynamic sound scenes are to be synthesized.
Early formulations attempted to synthesize the field of a moving point source by applying the traditional WFS driving signals with changing the virtual source position as the function of time.
This approach however failed to properly recreate Doppler effect, leading to serious artifacts in the synthesized field.
Ahrens et al. used the revisited WFS formulation in order to recreate the field of a moving source \footfullcite{Ahrens2008moving}\textsuperscript{,}\footfullcite{Ahrens2008moving_b}.
However, due to physical constrains of revisited WFS theory, it failed to control the amplitude of the synthesized source.
Hence, a further research goal was to extend the presented framework to include the possibility of synthesizing dynamic sound scenes.

\section{Methodology}

This section briefly summarizes the methodology and analysis tools, applied throughout the thesis.

The derivation of novel, unified Wave Field Synthesis and spatial domain explicit driving functions (that allows the comparison with WFS) requires the asymptotic evaluation of convolutional and spectral integrals.
First, I introduced local wavefield properties ---the local wavenumber vector and local wavefront curvature---, later serving as tools in order to give a meaningful physical interpretation for the results, concerning the integral approximations.
These quantities are well-known in the field of ray acoustics and high frequency acoustics, but has not been introduced in the context of sound field synthesis so far.

The central method, forming the backbone of the present thesis is the \emph{stationary phase approximation} (SPA), applied frequently in asymptotical analysis in order to approximate integrals around their critical points, termed as the \emph{stationary point}.
Loosely speaking the main topic of the present dissertation is how the SPA can be applied 
\begin{itemize}
\item to boundary integral representations of the virtual sound field, allowing the extraction of WFS driving function 
\item to spectral integral representations, to derive novel, spatial domain explicit driving functions.
\end{itemize}
The validity of the analytical results were verified via the numerical simulation of the synthesized field.
Throughout the thesis these simulations were performed by the simple summation of the analytically available field of the individual SSD elements (weighted by the driving function), assuming free field conditions.

\section{Results}

\clearpage	
\section{Theses}

\begin{thesisgroup}
I introduced a unified WFS framework, allowing one to synthesize arbitrary sound fields with arbitrary shaped loudspeaker ensembles (secondary source distribution (SSD)), and to optimize the synthesis on an arbitrary reference curve. 
The unified framework inherently contains the existing WFS approaches as special cases.
\begin{enumerate}
\item[] \vspace{-7mm}\begin{thesis}I established a physical interpretation of the stationary phase approximation (SPA) for the Rayleigh integral.
By defining the local wavenumber vector of a time-harmonic sound field I showed that the SPA ensures wave front matching of the virtual field and the secondary sound fields at the receiver position.\end{thesis}
\item[] \vspace{-7mm}\begin{thesis}I exploited the physical interpretation to derive WFS driving functions for an arbitrary shaped SSD curve within the validity of the physical optics approximation of the Kirchhoff-Helmholtz integral.\end{thesis}
\item[] \vspace{-7mm}\begin{thesis}I derived an analytical expression for the general \emph{reference curve} that connects the points in the synthesis plane where the amplitude error is minimal.
I critically revised existing WFS solutions by the analytical characterization of their reference curves.\end{thesis}
\item[] \vspace{-7mm}\begin{thesis}I introduced the \emph{referencing function}---an amplitude correction term in the driving functions---that controls the shape of the reference curve.
I derived the referencing function for an arbitrary reference curve.
As a special case I showed that a linear SSD with a parallel reference line yields the traditional WFS driving functions.\end{thesis}
\end{enumerate}
\end{thesisgroup}


\begin{thesisgroup}
Besides the implicit WFS technique---yielding the required driving functions as an implicit integral kernel in a reduced surface integral---explicit solutions exist, obtaining the driving functions as a spectral integral.
For a linear SSD the explicit solution is termed as the \emph{Spectral Division Method (SDM)}.
So far the connection of the implicit and explicit solutions has been investigated for several special target sound fields.
Applying the SPA to the SDM driving functions I derived the spatial representation of the explicit driving functions, and I highlighted its general equivalence of the explicit and implicit solutions in the high-frequency region.
\begin{enumerate}
\item[] \vspace{-7mm}\begin{thesis}SDM yields the linear driving functions in the form of an inverse spatial Fourier transform.
Applying the SPA to the Fourier integral I gave the analytical SDM driving functions purely in the spatial domain.
Unlike WFS the new, so far unknown driving functions express the SSD driving signals in terms of the target sound field measured along an arbitrary reference curve.\end{thesis}
\item[] \vspace{-7mm}\begin{thesis}I expressed the newly introduced driving functions in terms of the target field's gradient measured on the SSD.
The obtained expressions can be directly compared with the unified WFS driving functions.
I proved, that under high-frequency assumptions the explicit SDM and the implicit WFS driving functions are completely equivalent for an arbitrary target sound field.\end{thesis}
\end{enumerate}
\end{thesisgroup}

\begin{thesisgroup}
In the aspect of synthesizing dynamic sound scenes the synthesis of moving sources is of primary importance.
I adapted the unified WFS framework to the synthesis of sound fields induced by moving point sources.
\begin{enumerate}
\item[] \vspace{-7mm}\begin{thesis}I adapted the unified 3D WFS theory to the field of a point source moving along an a-priory known trajectory, and defined driving functions for an arbitrary SSD surface.
The solution takes the Doppler-effect inherently into account.\end{thesis}
\item[] \vspace{-7mm}\begin{thesis}For the case of a 3D moving source synthesized with a 2D SSD contour the compensation for the virtual source dimensionality mismatch is not straightforward.
I adapted the stationary phase method in order to derive the correct compensation factors in the referencing function. 
Applying the obtained referencing function I derived 2.5D WFS driving functions for an arbitrary shaped SSD contour.\end{thesis}
\item[] \vspace{-7mm}\begin{thesis}I verified, that for the special case of a linear SSD and a parallel reference line the moving source driving functions coincide with the traditional stationary source WSF driving functions, with the stationary source position replaced with the source position at the emission time.\end{thesis}
\item[] \vspace{-7mm}\begin{thesis}The solution with an arbitrary source trajectory requires the a-priori determination of the propagation time delay---the time it takes for the wavefront emitted by the moving source to reach the receiver position---, which leads to the solution of a non-linear equation for each SSD element at each time instant.
I proposed an iterative scheme relying on the first order Taylor's approximation of the propagation time delay function.
The proposed scheme requires the solution of the non-linear equation only at the time origin, and makes real time implementations feasible.\end{thesis}
\item[] \vspace{-7mm}\begin{thesis}For a uniformly moving source the propagation time delay can be expressed explicitly.
I utilized this solution to give explicit WFS driving functions for sources in uniform motion.\end{thesis}
\item[] \vspace{-7mm}\begin{thesis}For a uniformly moving source the frequency content of the radiated field may be expressed analytically.
I adapted the SPA to this formulation in order to derive frequency domain 2.5D WFS driving functions for a linear SSD.\end{thesis}
\end{enumerate}
\end{thesisgroup}

\begin{thesisgroup}
For the case of a linear SSD and a parallel reference line the spatial Fourier-transform of the involved functions (i.e. the target field, the SSD's sound field and the driving function) may be defined.
In the wavenumber domain the synthesis problem can be formulated as a spectral multiplication, and the driving functions are obtained via a spectral division, (hence the term \emph{Spectral Division Method (SDM)}).
I gave analytical expressions for the required transforms for the case of uniformly moving virtual sources, resulting in the explicit reference solution.
	\begin{enumerate}
	\item[] \vspace{-7mm}\begin{thesis} I gave analytical expression for the wavenumber-frequency content of the sound field generated by a moving acoustic point source with an arbitrary inclined trajectory.
	I verified that the analytic expression converges weakly to a Dirac-delta distribution for a sound source, moving along the direction of the Fourier-transform \end{thesis}
	\item[] \vspace{-7mm}\begin{thesis} Based on the expression for the wavenumber-content I gave the SDM driving functions for the synthesis of a moving point source in the wavenumber domain.
	For the special case of a source moving parallel to the secondary source distribution I derived analytical, closed form driving function in the spatial-frequency domain.\end{thesis}
	\item[] \vspace{-7mm}\begin{thesis} For the case of a source moving parallel to the SSD I showed that the WFS solution is the high-frequency/farfield approximation of the SDM. An analog relation had already been known for a stationary point source in the related literature.\end{thesis}
	\item[] \vspace{-7mm}\begin{thesis} Based on the wavenumber representation of the synthesis problem I presented an analytical treatment of the spatial aliasing artifacts emerging from the practically unavoidable discretization of the SSD.
	By expressing the temporal-frequency representation of the additive aliasing components I identified two main artifacts in the synthesized field: \emph{Amplitude ringing}, due to the temporally varying interference pattern of the ideal field and the aliasing components, as well as \emph{Frequency ringing}, as undesired frequency components in the synthesized field.\end{thesis}
	\item[] \vspace{-7mm}\begin{thesis} I connected the phenomena of frequency ringing with poles in the secondary sources wavenumber representation (hence the terminology \emph{ringing}), and I analytically expressed the ringing frequency components.
	I showed that the artifact can be avoided by applying an SSD that does not exhibit poles on the receiver curve.
	This requirement holds for any smooth enclosing SSD, which has been demonstrated for the case of a circular SSD via numerical simulations.\end{thesis}
\end{enumerate} 
\end{thesisgroup}

\printbibliography[title={Journal papers}, category=journal, prefixnumbers={J}, heading=subbibliography,resetnumbers=true]
\printbibliography[title={Conference papers}, category=conference, prefixnumbers={C}, heading=subbibliography, resetnumbers=true]
\printbibliography[title={Other publications}, category=other, prefixnumbers={O}, heading=subbibliography, resetnumbers=true]

\end{document}
