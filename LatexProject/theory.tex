In the following chapter the theoretical basis of sound radiation and sound field reproduction is introduced. The section starts with discussing the physics of sound propagation and radiation by deriving the formulation and solution of the governing homogeneous and inhomogeneous wave equations. Various integral representation of sound fields are presented including wave-number domain representation and the Kirchhoff-Helmholtz integral. After formulating the basic sound field synthesis problem, the explicit (Spectral Division Method) and implicit (Wave Field Synthesis) solutions are discussed for a linear loudspeaker distribution.
%

\section{Theory of wave propagation and radiation problems}

Sound is a mechanical disturbance propagating in an elastic fluid, causing an alternation in the pressure (along with density) and in the displacement of the medium's particles. The propagation of the disturbance is described fully by the acoustic wave equation. First the homogeneous wave equation is introduced briefly, which is valid for \emph{source-free} domains. For a detailed treatise on the derivation please refer to \cite{Beranek1993, Morse1968, Williams1999, Blackstock2000}.

\subsection{The homogeneous wave equation}

Consider a homogeneous, elastic fluid, modeled as an ideal gas with no viscosity. In the aspect of the present thesis it is feasible to investigate sound propagation solely in air at room temperature. 

%
The domain of investigation ie. where sound waves propagate is termed as \emph{sound field} hereinafter.
The acoustical quantities of the the sound field is described by \emph{dynamic field variables} in each point $\vx$ at each time instant $t$: the vector variable \emph{particle velocity} $\mathbf{v}(\vx,t)$ and the scalar \emph{instantaneous sound pressure} $p(\vx,t)$ superimposed onto the static pressure $P_0 \approx 10^5~\mathrm{Pa}$.
The medium is quiescent, meaning on average each particle is at rest with zero particle displacement --thus zero particle velocity-- and with the static pressure $P_0$. 
The presence of a sound wave causes incremental change in the instantaneous pressure and the particle velocity.
%

In order to apply a linear model for sound propagation two assumptions are made.
Since the traveling speed of thermal diffusion is small compared to the speed of sound and the acoustical wave length in the audible frequency range, it is feasible to assume, that heat exchange in the wave due to compression and expansion is negligible: the state changes are modeled as adiabatic changes.
Furthermore the alternation of the instantaneous sound pressure must be small compared to the static pressure, so the non-linear adiabatic state-change characteristics can be linearized around $P_0$. This later assumption is also fulfilled for pressure magnitudes below the threshold of pain of the human auditory system, as it was pointed out in \cite{Gumerov2004, Ahrens2012}.
%

The linear wave equation may be derived by utilizing two fundamental physical principles.
\begin{itemize}
\item \emph{The equation of motion:} By applying Newton's second law for an infinitesimal small volume of gas we obtain the connection between the particle velocity vector and the pressure field at each point at each time instant. The resulting \emph{Euler's equation} states that the force acting on the volume, which is proportional to the pressure on the surface causes an acceleration, which is given by the time derivative of the particle velocity:
\begin{equation}
\nabla p(\vx,t) = -\rho_0 \frac{\partial}{\partial t} \mathbf{v}(\vx,t),
\label{Eq:Theory:Eulers_equation}
\end{equation}
\nomenclature[2]{$\nabla$}{Gradient operator. In Descartes-coordinates it is given by $\nabla = \frac{\partial}{\partial x} \mathbf{e}_x + \frac{\partial}{\partial y} \mathbf{e}_y + \frac{\partial}{\partial z} \mathbf{e}_z$}.
%
where $\nabla$ is the gradient operator and $\rho_0$ is the fluid ambient density. In room temperature for the above given static pressure it is given as $\rho_0 = 1.18~\mathrm{kg}/\mathrm{m}^3$.
Equation \eqref{Eq:Theory:Eulers_equation} may be transformed wrt. time into the angular frequency domain, supposing steady-state harmonic wave solutions. Using the differentiation theorem the frequency domain Euler's equation reads
\begin{equation}
\nabla P(\vx,\omega) = \ti \omega \rho_0 \mathbf{V}(\vx,\omega),
\label{Eq:Theory:Freq_Eulers_equation}
\end{equation}

\item \emph{The gas law:} For adiabatic processes the change of state is governed by the following equation
\begin{equation}
P V^{\gamma} = \mathrm{constant},
\label{Eq:Theory:Adiabatic_change}
\end{equation}
where $\gamma = c_P/c_V$ is the ratio of specific heat of the fluid in constant pressure and with constant volume. For air $\gamma = 1.4$. Linerization of \eqref{Eq:Theory:Adiabatic_change} and expressing the change in pressure --equaling the instantaneous pressure-- one obtains
\begin{equation}
\Delta P = p(\vx,t) = -\gamma P_0 \frac{\Delta V}{V_0},
\end{equation}
where $V_0$ is the undisturbed volume. The relative change of volume may be expressed as the sum of particle displacement over the boundary surface. Applying the definition of divergence and expressing the equation in terms of particle velocity yields
\begin{equation}
\frac{\partial}{\partial t} p(\vx,t) = -\gamma P_0 \nabla \cdot \mathbf{v}(\vx,t),
\label{Eq:Theory:Second_eq}
\end{equation}
where $\nabla \cdot$ is the \emph{divergence operator}.
\end{itemize}
%
Taking the derivative wrt. time of equation \ref{Eq:Theory:Second_eq} and the divergence of equation \ref{Eq:Theory:Eulers_equation} the particle velocity may be eliminated. By using the \emph{Laplacian-operator} $\nabla \cdot \nabla = \nabla^2$ the scalar linear homogeneous wave equation is obtained for the sound pressure
\begin{equation}
\nabla^2 p(\vx,t) - \frac{1}{c^2} \frac{\partial^2}{\partial t^2} p(\vx,t) = 0,
\label{Eq:Theory:Scalar_wave_equation}
\end{equation}
\nomenclature[1]{$c$}{Speed of sound}%
\nomenclature[3]{$\nabla^2$}{Laplacian operator. In Descartes-coordinates: $\nabla^2 = \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} +  \frac{\partial^2}{\partial z^2}$}%
where $c \equiv \sqrt{ \frac{\gamma P_0}{\rho_0} }$ is the speed of the sound wave in the medium. For air in room temperature it is given as $c = 343.1 ~ \mathrm{m}/\mathrm{s}$.

The instantaneous pressure may be also eliminated. In this case the vector wave equation is obtained for the particle velocity, valid for curl-free media
\begin{equation}
\nabla^2 \mathbf{v}(\vx,t) - \frac{1}{c^2} \frac{\partial^2}{\partial t^2} \mathbf{v}(\vx,t) = 0,
\label{Eq:Theory:Vector_wave_equation}
\end{equation}
where $\nabla^2 = \nabla \left( \nabla \cdot \right)$.
%
The wave equations fully describe the properties of acoustic wave propagation as long as the the assumptions are fulfilled.
%

\vspace{3mm}
%
Equation \eqref{Eq:Theory:Scalar_wave_equation} can be transformed into the frequency domain by performing a temporal Fourier-transform according to \eqref{Eq:Math:Temp_Fourier}. By using the differentiation property of Fourier-transform given in \eqref{Eq:Math:Fourier_tr_diff} the \emph{homogeneous Helmholtz-equation is obtained}:
\begin{equation}
\nabla^2 P(\vx,\omega) + k^2 P(\vx,\omega) = 0,
\label{Eq:Theory:Homog_Helmholtz}
\end{equation}
where $k$ is the \emph{acoustic wavenumber}, which is related to the temporal frequency trough the \emph{dispersion relation}:
\begin{equation}
k = \frac{\omega}{c}.
\end{equation}
%
Equation \eqref{Eq:Theory:Homog_Helmholtz} must hold for every physically possible \emph{steady-state} wave form with harmonic time-dependence for a source-free volume (which latter is indicated with the zero load term on the right side). In the aspect of the present thesis the time-domain wave equation is rarely solved, therefore in the followings the general solution for the Helmholtz-equation is presented.

\subsection{Solution of the homogeneous wave equation}

Since understanding plane wave theory is of major importance in the aspect of the present thesis we will focus our interest to the free-field solution of the homogeneous Helmholtz-equation in Cartesian coordinate system.

The Descartes coordinate form of the Laplace-operator is given by
\begin{equation}
\nabla^2 = \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} +  \frac{\partial^2}{\partial z^2}.
\end{equation}
The general solution for the Helmholtz-equation is obtained by the separation of variables \cite{Devaney2012}: let's try to find the solution in the form
\begin{equation}
P(\vx,\omega) = \hat{P}(\omega) X(x)Y(y)Z(z).
\label{Eq:Theory:Seperated_variables}
\end{equation}
Let's substitute it into \eqref{Eq:Theory:Homog_Helmholtz} and divide both sides by $\hat{P}(\omega) X(x)Y(y)Z(z)$!
\begin{equation}
\underbrace{\frac{\partial^2 X(x)}{\partial x^2}\frac{1}{X(x)}}_{-k_x^2} + 
\underbrace{\frac{\partial^2 Y(y)}{\partial y^2}\frac{1}{Y(y)}}_{-k_y^2} + 
\underbrace{\frac{\partial^2 Z(z)}{\partial z^2}\frac{1}{Z(z)}}_{-k_z^2}
= - k^2.
\label{Eq:Theory:Seperated_variables_expanded}
\end{equation}
Since in the equation each term contains a total derivative --independent from any other variable-- equality may hold only if each term is constant. These constant are denoted by $k_x-k_y-k_z$. Consequently each part of the equation leads to a simple eigenvalue problem, for which the eigenfunction solution is well-known. Given eg. for $x$-variable it reads
\begin{equation}
\frac{\partial^2 X(x)}{\partial x^2} = -k_x^2 X(x) \hspace{5mm} \rightarrow \hspace{5mm} X(x) = A_1 \te^{-\ti k_x x} + A_2 \te^{\ti k_x x}.
\end{equation}
The solutions may substituted back to equation \eqref{Eq:Theory:Seperated_variables}. In order to include every possible solution the general solution for the free-field homogeneous Helmholtz-equation is yielded by summation over all possible values of $k_x-k_y-k_z$ weighted by arbitrary constants. However, the variables are not independent, since for a fixed temporal frequency they are related according the dispersion relation
(resulting from \eqref{Eq:Theory:Seperated_variables_expanded}):
\begin{equation}
k^2 = \left( \frac{\omega}{c} \right)^2 = k_x^2 + k_y^2 + k_z^2.
\end{equation}
As a dependent variable we will use $k_y$ trough this treatise so that
\begin{equation}
k_y = \sqrt{ k^2 - k_x^2 - k_z^2 }.
\end{equation}
Using this and by denoting the arbitrary constant by $\hat{P}(k_x,k_z, \omega)$ the general solution reads
\begin{equation}
P(\vx,\omega) = \frac{1}{4\pi^2}\iint_{-\infty}^{\infty} \hat{P}(k_x,k_z, \omega)  \te^{- \ti \left( k_x x + k_y y + k_z z \right) }
\td k_x\td k_z.
\label{Eq:Theory:Helmholtz_Inverse_Fourier}
\end{equation}
Constant $\frac{1}{4\pi^2}$ is introduced due to proper Fourier-transform normalization as we will see later.

\vspace{3mm}
One separated solution from the integral is in the form of \cite{Williams1999}
\begin{equation}
P(\vx,\omega) = \hat{P}(\omega) \te^{-\ti \left( k_x x + k_y y + k_z z \right) } =  \hat{P}(\omega) \te^{-\ti \mathbf{k}^{\mathrm{T}} \vx },
\end{equation}
where $\mathbf{k}^{\mathrm{T}} = [k_x,\ k_y,\ k_z]$ is the wavenumber vector, with the length equaling the acoustic wavenumber $k = \sqrt{ \mathbf{k}^{\mathrm{T}}  \mathbf{k}}$.
The solution represents a \emph{plane wave} component traveling in the direction $\mathbf{k}$ with the acoustic wavelength of $\lambda = 2\pi/k$. The terminology indicates that the surface of constant phase points are lying along an infinite plane. Refer to figure xy for the illustration of a traveling plane wave.

\begin{figure}[!h]
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Theory/plane_wave.png}
	\end{overpic}
\caption{Plane Wave}
	\label{Fig:Theory:plane_wave}
\end{figure}

As it is indicated in the figure $k_x-k_y-k_z$ variables are the $x-y-z$ directional components of the wavenumber vector. For the sake of simplicity assume that $k_z = 0$, thus the propagation direction of the plane wave is parallel with the $z=0$ plane. In this case the wavenumber components are expressed as
\begin{eqnarray}
k_x = k \sin \theta , \\
k_y = k \cos \theta .
\end{eqnarray}
  
\subsubsection{Evanescent waves}
It is important to note, that there is no constraint on the values of $k_x^2$ and $k_z^2$ as long as they are real, their value may span from $-\infty$ to $\infty$. The plane wave equation is satisfied also when $k_x>k$ or $k_z>k$. Resulting from the dispersion relation in these cases $k_y$ becomes complex, reading
\begin{equation}
k_y = -\ti \sqrt{ k_x^2 + k_z^2 - k^2 }=-\ti k_y',
\end{equation}
by ignoring the non-physical positive sign solution.
The expressed waves describe plane waves, propagating perpendicular to the $y$-axis, exhibiting an exponential decaying amplitude along $y$-direction (see Figure \ref{Fig:Theory:plane_wave} (b)):
\begin{equation}
P(\vx,\omega) = \hat{P}(\omega) \te^{-k_y' y} \te^{-\ti \left( k_x x + k_z z \right) }.
\end{equation}

In these cases component of the wave-length is shorter, then the acoustic wave-length. As a consequence the wave can not propagate from the $y = 0$ surface, but an exponentially decaying radiation phenomena occurs. These type of waves are termed \emph{evanescent waves} opposed to \emph{propagating waves}, when all wavenumber components are real valued.

Evanescent waves are often the results of the difference between the speed of sound in different materials: in solids the speed of sound is significantly higher, than in the air. As a consequence in case of e.g. a vibrating solid surface important higher-order modes will not be radiated into the free-space, since the wave length on the surface of the object is shorter, than the acoustic wave length would be in air. In these cases air above the surface acts as a hydrodynamic short-circuit.

Due to the foregoing the presence of evanescent waves is of central importance in the aspect of \emph{Nearfield Acoustic Holography}, when one needs a high-resolution image from the velocity distribution on the vibrating object's surface.
However plane wave contribution is often neglected in the aspect of Sound Field Synthesis, when the listener is relatively far from the secondary loudspeaker array.


\subsubsection{The Angular Spectrum and Wave Field Extrapolation}

Loosely speaking an arbitrary 3-dimensional function could be expanded into exponential function via a spatial Fourier-transformation, for which a Fourier-transform exist. The dispersion relation sifts the solutions of the Helmoltz-equation. This process could be treated mathematically by multiplying the 3-dimensional inverse Fourier-transform by $\delta(k_y - \sqrt{k^2-k_x^2-k_z^2})$ and integrating wrt. $k_y$.
As stated in the foregoing an arbitrary free-field sound field can be therefore written in the form of equation \eqref{Eq:Theory:Helmholtz_Inverse_Fourier}.
This formulation is termed as the \emph{angular spectrum representation} \cite{Ahrens2010phd, Ahrens2012, Williams1999} or the \emph{plane wave expansion} \cite{Spors2005} of the sound field.
By expressing the pressure at the infinite plane $y=0$ the interpretation of $\hat{P}(k_x,k_y, \omega)$ is revealed
\begin{equation}
P(x,0,z,\omega) = \frac{1}{4\pi^2}\iint_{-\infty}^{\infty} \hat{P}(k_x,k_z, \omega)  \te^{- \ti k_x x} \te^{- \ti k_z z  }
\td k_x\td k_z.
\label{Eq:Theory:P_x0z}
\end{equation}
It is clear, that \eqref{Eq:Theory:P_x0z} expresses a double inverse Fourier-transform wrt. $k_x-k_z$-variables. 
The \emph{angular spectrum}, or \emph{plane wave expansion coefficients} $\hat{P}(k_x,k_z, \omega)$ can be therefore expressed as the forward Fourier-transform of the pressure distribution at $y=0$
\begin{equation}
\hat{P}(k_x,k_z, \omega) = \iint_{-\infty}^{\infty} P(x,0,z,\omega)  \te^{ \ti k_x x} \te^{ \ti k_z z  }\td x \td z.
\end{equation}
From now on the domain, denoted by $k_x$,$k_z$ is termed as the \emph{wavenumber domain}.
Equation \eqref{Eq:Theory:Helmholtz_Inverse_Fourier} therefore constitutes a connection between the pressure distribution of an arbitrary sound field measured an arbitrary point and at the plane $y=0$. In the wave-number domain the equation reads:
\begin{equation}
\mathcal{F}_x\mathcal{F}_z \left\{ P(\vx,\omega) \right\} = \hat{P}(k_x,y,k_z,\omega) = \hat{P}(k_x,0,k_z,\omega) \te^{-\ti k_y y}.
\label{Eq:Theory:Wave_field_extrapolation}
\end{equation}
Note, that wave propagation is determined by the phase change of the plane wave expansion's $y$-component, therefore generally speaking the following equation holds:
\begin{equation}
\hat{P}(k_x,y,k_z,\omega) = \hat{P}(k_x,y',k_z,\omega) \te^{-\ti k_y ( y - y' ) }.
\end{equation}

By taking the inverse Fourier transform of both sides:
\begin{equation}
P(\vx,\omega) = \frac{1}{4\pi^2}\iint_{-\infty}^{\infty} \hat{P}(k_x,y',k_z,\omega) \te^{-\ti k_y ( y - y' ) }  \te^{- \ti \left( k_x x + k_y y + k_z z \right) }
\td k_x\td k_z.
\label{Eq:Theory:Pressure_propagated}
\end{equation}
Taking the normal derivative of $\hat{P}(k_x,y',k_z,\omega)$ using the Fourier-transformation differentiation theorem \eqref{Eq:Math:Fourier_tr_diff} and using the Euler's equation \eqref{Eq:Theory:Eulers_equation} to relate the pressure and the normal velocity the following expression is obtained
\begin{equation}
P(\vx,\omega) = \frac{1}{4\pi^2}\iint_{-\infty}^{\infty} \rho_0 c k\hat{V}_{\mathrm{n}}(k_x,y',k_z,\omega) \frac{\te^{-\ti k_y ( y - y' ) } }{k_y} \te^{- \ti \left( k_x x + k_y y + k_z z \right) }
\td k_x\td k_z.
\label{Eq:Theory:Velocity_propagated}
\end{equation}

These formulations are extremely important, and plays a leading role in the field of Fourier-acoustics. They state that an arbitrary sound field is completely determined by either the pressure, or by the normal velocity component, measured along an infinite plane. Wave propagation is calculated by multiplying the measured spectra with an exponential term, referred as the propagators: from \eqref{Eq:Theory:Pressure_propagated} term $\te^{-\ti k_y ( y - y' ) }$ is referred as the \emph{pressure propagator} and from \eqref{Eq:Theory:Velocity_propagated} term $\frac{\te^{-\ti k_y ( y - y' ) } }{k_y}$ is called the \emph{velocity propagator}.

These statements are completely equivalent with the \emph{Ralyeigh-integral} formulations of sound fields, and these integral formulations could be derived directly from equations \eqref{Eq:Theory:Pressure_propagated}-\eqref{Eq:Theory:Vector_wave_equation}. In the present thesis however the Rayleigh-integrals will be derived from the Kirchhoff-Helmholtz integral formulation.
The importance of these statements will be further investigated in the latter sections, dealing with Sound Field Synthesis using a planar secondary source distribution.

\vspace{3mm}
Similarly to the Cartesian-solution the general solution for the free-field homogeneous Helmholtz equation can be found for spherical and cylindrical coordinate system. The results are given also in the form of an infinite series of spherical and cylindrical harmonics.These functions connect the radiated sound at an arbitrary point, and the sound field, measured on a spherical or infinite cylindrical surface. These solutions are of great importance when spherical, or circular secondary source distributions are applied for sound field reconstruction. Since the present thesis deal exclusively with planar and linear loudspeaker arrays, there the presentation of the spherical and cylindrical solutions are omitted. For a detailed investigation
please refer to \cite{Williams1999, Zotter2009phd, Ahrens2012}

\subsubsection{Boundary conditions}

\begin{figure}
	\centering
	\begin{overpic}[width = .5\columnwidth]{Figures/Theory/boundary_conditions.png}
	\put(20,14){$\mathbf{n}$}
	\put(45,30){$\Omega_i$}
	\put(80,55){$\Omega_e$}
	\put(10,44){$\partial \Omega$}
	\end{overpic}
	\caption{Boundary conditions}
	\label{Fig:Theory:bounday_condition}
\end{figure}

So far we considered wave propagation in free-field, ie. no boundaries are present. In order to be able to solve the wave equation both inital conditions and boundary must be known. As initial conditions trough the present thesis we suppose  \emph{Cauchy initial conditions}, by setting $p(\vx,0) = 0$, $\frac{\partial}{\partial t}p(\vx,t)|_{t=0} = 0$.

In the presence of boundaries the wave field must satisfy prescribed boundary conditions.
If the domain of interest is the exterior of the enclosing boundary, while the sources of radiation is inside the volume --or it is the vibrating boundary surface itself-- the problem to be solved is termed as an \emph{exterior radiation problem}. On the other hand, if we want to determine the sound field inside a source-free volume we are facing an \emph{interior problem}.

The boundary conditions are typically continuous pressure or particle velocity. By supposing zero pressure or velocity on the boundary surface \emph{homogeneous boundary conditions} are considered. Non-zero field variables on the other hand represent a vibrating surface and are termed \emph{inhomogeneous bondary conditions}.

In the aspect of this thesis two important types of boundary conditions are of interest:
\begin{itemize}
\item \emph{Dirichlet boundary condition}:
Dirichlet boundary condition prescribes the pressure, measured on the boundary surface. The homogeneous Dirichlet boundary conditions are thus
\begin{equation}
P(\vx,\omega) = 0, \hspace{3mm} \forall \hspace{3mm} \vx \in \partial \Omega.
\end{equation}
These types of boundaries are called \emph{sound-soft}, or \emph{pressure release} boundaries. These types of boundary conditions are used to model eg. the surface of the ocean wrt. a wave propagating in the water \cite{Blackstock2000, Ziomek1995}.

The inhomogeneous Dirichlet boundary condition assumes a prescribed pressure value on the boundary surface:
\begin{equation}
P(\vx,\omega) = f_D(\vx,\omega), \hspace{3mm} \forall \hspace{3mm} \vx \in \partial \Omega.
\end{equation}

\item \emph{Neumann boundary condition}:
Neumann boundary condition gives the normal derivative of the pressure on the boundary surface, ie. prescribes the normal velocity of the surface. For the sake of simplicity the normal derivative taken on the surface uses the following notation and definition
\begin{equation}
\frac{\partial}{\partial n} f(\vx)\equiv \left. \frac{\partial}{\partial \mathbf{n}(\vx)} f(\vx) \right|_{\partial \Omega} \equiv \left. \langle \nabla f(\vx), \mathbf{n}(\vx) \rangle \right|_{\partial \Omega},
\end{equation}
where $ \mathbf{n}(\vx) $ is the normal vector of the boundary surface. For interior problems the inward pointing normal is used.

Homogeneous Neumann boundary condition are
\begin{equation}
\frac{\partial}{\partial  n }P(\vx,\omega)= 0.
\end{equation}
These type of boundaries are termed as \emph{sound hard}, or \emph{rigid} boundaries representing the fact, that it is ensured, that any incident wave can not move the boundary surface.

Inhomogeneous Neumann boundary conditions are given by
\begin{equation}
\frac{\partial}{\partial n }P(\vx,\omega) = f_N(\vx,\omega), \hspace{3mm} \forall \hspace{3mm} \vx \in \partial \Omega.
\end{equation}
Vibrating surfaces --eg. a mounted loudspeaker, or a baffled piston-- are most often modeled with these type of boundary conditions.

\end{itemize}

\newpage
\subsection{The inhomogeneous wave equation and the Green's function}

So far we investigated wave propagation in source-free volumes. Sources may be included into the wave-equation resulting in the inhomogeneous wave equation
\begin{equation}
\nabla^2 p(\vx,t) -\frac{1}{c^2}\frac{\partial^2}{\partial t^2}p(\vx,t) = -q(\vx,t),
\label{Eq:Theory:Inhomogene_wave_eq_time_domain}
\end{equation}
and by transforming wrt. time in the inhomogeneous Helmholtz-equation:
\begin{equation}
(\nabla^2 + k^2 ) P(\vx,\omega ) = -Q(\mathrm{x},\omega).
\end{equation}
Term $q(\vx,t)$ is referred as the \emph{load term}, and it describes the spatial extension and time history of the excitation.

It should be noted, that the solution of the inhomogeneous wave equation is not unique, since any solution for the homogeneous wave equation may be added to the solution, the inhomogeneous wave equation is still satisfied. In order to obtain a unique solution again, we impose \emph{Cauchy initial conditions}.

Note, that since the free-field solution is considered no boundary conditions are assumed except for the \emph{Sommerfeld-radiation condition}, which ensures that no reflected wave are present: the sound field consist of only outgoing waves. Mathematically it is ensured by implying boundary conditions at infinity:
\begin{equation}
\lim_{r \rightarrow \infty} r \left( \frac{\partial}{\partial r}P(\vx,\omega) +\ti \frac{\omega}{c}P(\vx,\omega) \right) = 0.
\label{Eq:Theory:Sommerfeld_radiation_condition}
\end{equation}

\vspace{3mm}
A common way to obtain the solution for the inhomogeneous wave equation is using the \emph{Green's function}. We define the \emph{3D free-field Green's function} as the solution for the following equation \cite{Gumerov2004, Williams1999}
\begin{equation}
\nabla^2 g(\vx|\vxo,t) -\frac{1}{c^2}\frac{\partial^2}{\partial t^2} g(\vx|\vxo,t) = -\delta\left( \vx - \vxo \right)\delta\left( t - t_0 \right),
\label{Eq:Theory:Green_function_def}
\end{equation}
where $\delta()$ is the Dirac-delta distribution. The Green's function therefore describes the propagation of waves measured at $\vx$, deriving from a point source located at $\vxo$ with an impulse excitation at $t_0$. The Green's function is often referred as the \emph{spatio-temporal impulse response} of the domain of interest.
Similarly the temporal Fourier-transform $G(\vx|\vxo,\omega)$ is referred as the \emph{spatio-temporal transfer function} of a point source, or an \emph{acoustic monopole}, located at $\vxo$. 

The motivation behind the use of the Green's function is the following:
Let's assume an arbitrary linear differential operator $\mathcal{L}\left\{ \right\}$ acting on a distribution $p(\vx)$. The Green's function of the operator is then defined as
\begin{equation}
\mathcal{L}\left\{ g(\vx-\vxo) \right\} = -\delta( \vx-\vxo ).
\label{Eq:Theory:Basic_Green_function_eq}
\end{equation}
The Green's function may be used to solve the following equation!
\begin{equation}
\mathcal{L}\left\{ p(\vx) \right\} = -f(\vx)
\label{Eq:Theory:General_Green}
\end{equation}
Let's multiply both sides of \eqref{Eq:Theory:Basic_Green_function_eq} by the source term $f(\mathbf{x_0})$ and integrate over the domain of investigation. Using the Dirac-delta sifting property:
\begin{equation}
\int_{\vxo} \mathcal{L}\left\{ g(\vx-\vxo) \right\} f(\vxo) \td \vxo  = -\int_{\vxo } \delta( \vx-\vxo ) f(\vx) \td \vxo  = -f(\vx).
\end{equation}
Due to linearity integration and the differential operator may be interchanged:
\begin{equation}
\mathcal{L}\left\{ \int_{\vxo }  g(\vx-\vxo) f(\vxo) \td \vxo  \right\} 
= -f(\vx).
\end{equation}
Comparing with \eqref{Eq:Theory:General_Green} it is revealed, that the solution takes the form:
\begin{equation}
p(\vx) = \int_{\vxo }  g(\vx-\vxo) f(\vxo) \td \vxo.
\end{equation}
Thus once the Green's function is found for a differential equation with given boundary and initial conditions, the solution for arbitrary load terms may be found by convolving the Green's function with the load term in each spatial and temporal dimensions.

The Green's function is usually obtained by eigenfunction expansion. For the present case the Green's function may be obtained by taking the spatio-temporal Fourier-transform of \eqref{Eq:Theory:Green_function_def}. By using the Fourier-transform differentiation theorem and the Fourier-transform of the Dirac-delta function, by denoting $\mathbf{k} = [k_x,\ k_y,\ k_z]^{\mathrm{T}}$:
\begin{equation}
(-(k_x^2 + k_y^2 + k_z^2) + \left(\frac{\omega}{c} \right)^2)G(\mathbf{k},\omega) = 1.
\end{equation}
Thus the Green's function in the wavenumber space reads \cite{Devaney2012, Watanabe2015}
\begin{equation}
G(\mathbf{k},\omega) = \frac{1}{\left( \frac{\omega}{c}\right)^2 - \mathbf{k}^{\mathrm{T}} \mathbf{k}}.
\label{Eq:Theory:3D_kxkykzw_Green}
\end{equation}
Using the convolution theorem the wavenumber representation of the solution using the Green's function reads
\begin{equation}
P(\mathbf{k},\omega)  = F(\mathbf{k},\omega) G(\mathbf{k},\omega) =\frac{F(\mathbf{k},\omega)}{\left( \frac{\omega}{c}\right)^2 -  \mathbf{k}^{\mathrm{T}} \mathbf{k} },
\end{equation}
and the solution in the spatio-temporal domain is yielded by the inverse Fourier-transform:
\begin{equation}
p(\vx,t) =\frac{1}{(2\pi)^4} \iiiint^{\infty}_{-\infty} \frac{F(\mathbf{k},\omega)}{\left( \frac{\omega}{c}\right)^2 -  \mathbf{k}^{\mathrm{T}} \mathbf{k} } \te^{-\ti \left( \mathbf{k}^{\mathrm{T}}\vx - \omega t \right) } \td k_x \td k_y \td k_z \td \omega.
\end{equation}

\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Theory/point_source.png}
	\end{overpic}
	\caption{3D point source}
	\label{Fig:Theory:point_source}
\end{figure}

The different representations of the 3D free-field Green's function may be obtained by the corresponding inverse Fourier-transform of \eqref{Eq:Theory:3D_kxkykzw_Green} (setting $\mathbf{x_0} = 0$, ie. the point source is placed at the origin) \cite{Devaney2012, Ahrens2010a, Ahrens2012}
\begin{equation}
G(k_x,y,k_z,\omega ) = -\frac{\ti}{2}\frac{\te^{-\ti \sqrt{ \left( \frac{\omega}{c} \right)^2 - k_x^2 - k_z^2  }}|y|}{\sqrt{ \left( \frac{\omega}{c} \right)^2 - k_x^2 - k_z^2  }} ,
\label{Eq:Theory:3D_kxykzw_Green}
\end{equation}
\begin{equation}
G(k_x,y,z,\omega) = -\frac{\ti}{4} H_0^{(2)}\left( \sqrt{ \left( \frac{\omega}{c} \right)^2 - k_x^2 } \sqrt{y^2 + z^2} \right)
\label{Eq:Theory:3D_kxyzw_Green}
\end{equation}
\begin{equation}
G(\vx,\omega) = \frac{1}{4\pi} \frac{\te^{ -\ti \frac{\omega}{c}|\vx| } }{ |\vx| },
\label{Eq:Theory:3D_xyzw_Green}
\end{equation}
\begin{equation}
g(\vx,t) = \frac{1}{4\pi} \frac{\delta \left( t - \frac{|\vx|}{c}  \right)}{|\vx|}.
\label{Eq:Theory:3D_xyzt_Green}
\end{equation}
The solution for the inhomogeneous wave equation is then yielded by convolving \eqref{Eq:Theory:3D_xyzt_Green} over the extension and time history of the source term.

In the field of Sound Field Synthesis the application of 2-dimensional Green's function is frequent. The 2D Green's function is the particular solution of the 2D inhomogeneous Helmhotz-equation with a spatial impulse load term, and it reads \cite{Gibson2008}
\begin{equation}
G_{2\mathrm{D}}(\vx,\omega) = \frac{\ti}{4}H_0^{(2)}\left( \frac{\omega}{c} \sqrt{x^2 + y^2} \right),
\end{equation}
which is the transfer function of a 2-dimensional point source.
In 3-dimensions the 2D Green's function can be interpreted as the field of an infinite vertical line source.

\begin{figure}
	\centering
	\begin{overpic}[width = .5\columnwidth]{Figures/Theory/dipole_source.png}
	\end{overpic}
	\caption{3D dipole}
	\label{Fig:Theory:dipole_source}
\end{figure}

\vspace{3mm}
For the solution of the wave equation in enclosures the Green's function must satisfy the imposed boundary conditions. In these cases the Green's function --except for special cases-- varies with $\vxo$, therefore it is translation variant.
For an more general treatment please refer to \cite{Spors2005}. 
When the Green's function satisfies Neumann-boundary conditions (ie. $G(\vx_{S},\omega) = 0$) it is called \emph{Neumann Green's function}, while if it satisfies Dirichlet boundary conditions it is termed as \emph{Dirichlet Green's function}.
For special geometries the Neumann and Dirichlet Green's functions may be expressed analytically, as we will see in the following section.

\vspace{3mm}
Besides simple monopoles the superposition of several point sources is of importance in this thesis. The superposition of two anti-phase monopoles placed infinitesimally close to each other forms an acoustic dipole. Mathematically its field is derivad as the directional gradient of the field of a monopole, eg. in the $y$-direction:
\begin{equation}
G_d(\vx|\vxo,\omega) =
\frac{\partial}{\partial y} G(\vx|\vxo,\omega)|= 
- \frac{y}{4\pi}\left( \frac{1}{| \vx - \vxo |} + \ti \frac{\omega}{c} \right) 
\frac{\te^{-\ti \frac{\omega}{c}  | \vx - \vxo | }}{| \vx - \vxo |^2}.
\end{equation}
The sound field of this dipole is depicted in figure \ref{Fig:Theory:dipole_source}.

\newpage
\subsection{The Kirchhoff-Helmholtz integral equation}

In the foregoing of this chapter we were dealing with the free-space solutions of the wave equation. In the following the presence of enclosures will be investigated.

Any sound field obeying the homogeneous Helmholtz-equation may be written in the form of a surface integral above an enclosing surface, termed as the \emph{Kirchhoff-Helmholtz integral equation}. This integral formulation, which solves the homogeneous wave equation with inhomogeneous boundary conditions is of central importance in the field of acoustics, eg. forms the backbone of the Boundary Element Method, and SVD-based Conformal Nearfield Acoustic Holography.

In this chapter we investigate the integral formulation of interior problems in source-free volumes.
Note, that the effect of direct sources may be straightforwardly included in the following results by the proper addition of the solution of the inhomogeneous Helmholtz equation. See \cite{Spors2005} for the examination of this case.
\begin{figure}[!h]
	\centering
	\begin{overpic}[width = .65\columnwidth]{Figures/Theory/Kirchhoff-Helmholtz.png}
	\end{overpic}
\caption{Kirchhoff-Helmholtz integral geometry}
	\label{Fig:Theory:HIE_geometry}
\end{figure}

Let $\Omega$ be a 3D volume, bounded by the surface $\partial \Omega$ with arbitrary position vectors $\vxo$ and $\vx$. Refer to figure xy for the geometry. For two continuous, differentiable scalar valued functions $\Phi(\vxo)$, $\Psi(\vxo)$ the Green's theorem reads (see \ref{App:Green_theorem} for the derivation)
\begin{equation}
\iiint_{\Omega}          \left(  \Phi(\vxo) \nabla^2 \Psi(\vxo) - \Psi(\vxo) \nabla^2 \Phi(\vxo)   \right)   \td \Omega = 
\iint_{\partial \Omega}  \left(  \Psi(\vxo) \frac{\partial \Phi(\vxo)}{\partial n}  - \Phi(\vxo) \frac{\partial \Psi(\vxo)}{\partial n}  \right)   \td \partial \Omega,
\label{Eq:Theory:Greens-theorem}
\end{equation}
with $\frac{\partial}{\partial n}$ denoting the inward normal derivative. Let these functions satisfy the homogeneous and inhomogeneous Helmholtz-equations:
\begin{equation}
(\nabla^2 + k^2)\Phi(\mathbf{x_0}) = 0,
\label{Eq:Theory:Phi}
\end{equation}
\begin{equation}
(\nabla^2 + k^2)\Psi(\vx|\vxo) = -\delta(\vx - \vxo).
\label{Eq:Theory:Psi}
\end{equation}
Although the continuity requirement is not fulfilled for $\Psi$, with proper mathematical workaround the singularity may be excluded from the volume integral\cite{Williams1999}. By setting the homogeneous solution of \eqref{Eq:Theory:Psi} to 0 and assuming acoustically transparent boundary the particular solution is given by the free-field Green's function
\begin{equation}
\Psi(\vx | \vxo) = G(\vx| \vxo,\omega) = \frac{1}{4\pi} \frac{\te^{-\ti \frac{\omega}{c} |\vx-\vxo|}}{|\vx-\vxo|},
\end{equation}
describing the field of a point source located at $\vx$ measured at $\vxo$. For acoustic problems the scalar valued function satisfying the Helmholtz equation is generally the pressure field, thus $\Phi(\vxo) = P(\vxo,\omega) $
 
Let's combine equations \eqref{Eq:Theory:Greens-theorem}-\eqref{Eq:Theory:Phi}-\eqref{Eq:Theory:Psi}!
\begin{equation}
\iiint_{\Omega} - P(\vxo) \delta(\vx - \vxo)
  \td \Omega(\vxo) = 
\iint_{\partial \Omega}  \left(  G(\vx|\vxo) \frac{\partial P(\vxo)}{\partial n}  - P(\vxo)  \frac{\partial G(\vx|\vxo)}{\partial n}  \right)   \td \partial \Omega ( \vxo),
\end{equation}

The sifting property of the Dirac-delta may be exploited, by taking into account, that the singularity is located in the enclosure: if $\vxo$ lies outside the volume the integral is identically zero, while if it is on the surface it is assumed, that "only half of the Dirac-impulse is in the volume". As a result the \emph{Kirchhoff-Helmholtz integral}, or \emph{Helmholtz integral equation (HIE)} is obtained:
\begin{equation}
\alpha P(\vx,\omega) = 
\iint_{\partial \Omega}  \left( 
P(\vxo,\omega)  \frac{\partial G(\vx|\vxo,\omega)}{\partial n}  -  
G(\vx|\vxo,\omega) \frac{\partial P(\vxo,\omega)}{\partial n} 
\right)   \td \partial \Omega ( \vxo),
\label{Eq:Theory:Kirchhoff-Helmholtz}
\end{equation}
with
\begin{equation*}
\alpha = \begin{cases} 
1           & \hspace{1mm} \forall \hspace{5mm}  \vxo \in \Omega_i  	   \\
\frac{1}{2} & \hspace{1mm} \forall \hspace{5mm}  \vxo \in \partial \Omega  \\
0 			& \hspace{1mm} \forall \hspace{5mm}  \vxo \in \Omega_e.
\end{cases}
\end{equation*}
Point $\vx$ is termed as \emph{evaluation point}, while $\vxo$ is termed the \emph{field point}. Utilizing the Euler's equation \eqref{Eq:Theory:Eulers_equation}
\begin{equation}
\frac{\partial P(\vxo,\omega)}{\partial n} = \ti \rho_0 c k V_{\mathrm{n}}(\vxo,\omega),
\end{equation}
ie. the normal component of the velocity on the surface:
\begin{equation}
\alpha P(\vx,\omega) = 
\iint_{\partial \Omega}  \left(  
P(\vxo,\omega)  \frac{\partial G(\vx|\vxo,\omega)}{\partial n}  -
\ti \rho_0 c k V_{\mathrm{n}}(\vxo,\omega) G(\vx|\vxo,\omega) 
\right)   \td \partial \Omega ( \vxo),
\label{Eq:Theory:Kirchhoff}
\end{equation}

The equation states that the pressure field inside an enclosure is completely determined by the boundary conditions for the pressure and normal velocity on the boundary surface.
The interior HIE describes the pressure field only inside the volume of investigation, outside the volume the pressure field is identically zero. For exterior radiation problems the exterior HIE can be derived in a very similar manner --By calculating with the outward normal velocity on the surface and positioning the Dirac-delta outside the enclosure--, and the formulation will result in correct pressure field outside the volume and zero pressure inside \cite{Williams1999}.
In both cases the method is capable of dealing only with forward propagation problems.
\vspace{3mm}

It should be noted, that HIE is consist of two integral components:
\begin{equation}
S_{\mathrm{monopole}}(\vx,\omega) = 
\iint_{\partial \Omega}  \frac{\partial P(\vxo)}{\partial n} G(\vxo|\vx) \td \partial \Omega (\vxo),
\label{Eq:Theory:Single_Layer_Potential}
\end{equation}
\begin{equation}
S_{\mathrm{dipole}}(\vx,\omega) = 
\iint_{\partial \Omega}  P(\vxo,\omega)  \frac{\partial G(\vx|\vxo,\omega)}{\partial n}   \td \partial \Omega (\vxo).
\label{Eq:Theory:Double_Layer_Potential}
\end{equation}
The components are termed \emph{single layer potential} and \emph{double layer potential} respectively in the field of potential theory. The terminology represents the fact, that single layer potential describes the field as the weighted sum of a single layer of monopoles, characterized by $ G(\vxo|\vx) $. On the other hand double layer potential describes the field of an ensemble of dipoles whose field is described by 
$\frac{\partial G(\vx|\vxo,\omega)}{\partial n}$ and which can be physically realized by two anti-phase monopoles, thus by a double layer.

\vspace{3mm}
One drawback of interior HIE is that it overspecifies the problem in order to ensure zero pressure and velocity outside the domain of interest. In the aspect of Sound Field Synthesis the presence of both single and double layer potentials is infeasible. By letting the sound field non-zero outside the enclosure it is possible to completely describe the sound field in the region of interest in terms of only single or double layer potentials.
This can be done by modifying the Green's function in order to satisfy Dirichlet or Neumann boundary conditions, or to impose these boundary conditions to the sound field $ P(\vxo,\omega) $ itself in an equivalent scattering problem (leading to the simple source formulation).
In the following section the former approach is applied for planar boundaries resulting in the Rayleigh integral theorem.

\subsection{The Rayleigh-integrals}
\label{Section:Theory:Rayleigh}

The Rayleigh integrals formulate the sound field with merely the pressure field or the normal velocity measured on an infinite plane. The derivation utilizes the Neumann and Dirichlet Green's functions for the geometry, that can be seen in figure \ref{Fig:Theory:Rayleigh_geometry}.

In this scenario we investigate an interior problem with the volume bounded by a plane and a hemisphere: the HIE is written into this two surfaces. As we increase the radius of the hemisphere to infinity ($r_s \rightarrow \infty$) the Sommerfeld-radiation condition is invoked and the integral on the sphere vanishes: the radiated field is described by a surface integral written on the infinite plane. Also by noticing that $\frac{\partial}{\partial n} = \frac{\partial}{\partial y_0}$:
\begin{multline}
P(\vx,\omega) = \lim_{r\rightarrow \infty} \left( \int_{\partial \Omega_P} + \int_{\partial \Omega_S} \td \partial \Omega \right) = \\
\iint_{\partial \Omega_S}  \left( 
P(\vxo,\omega)  \frac{\partial G(\vx|\vxo,\omega)}{\partial y_0}  -
\ti \rho_0 c k V_{\mathrm{n}}(\vxo,\omega)  G(\vx|\vxo,\omega) 
\right)   \td \partial \Omega_S ( \vxo).
\end{multline}

It can be easily proven, that any homogeneous solution of the Helmholtz equation -- satisfying free field boundary conditions -- may be added to the Green's function, the Kirchhoff-Helmholtz integral still holds. In order to eliminate either the single or the double layer potential in the HIE we set the homogeneous solution in the Green's function to non-zero.\begin{itemize}
\item \emph{Neumann Green's function} eliminate the double layer potential, by describing Neumann boundary conditions for the Green's function on the bounding infinite plane:
\begin{equation}
G_N = G + g_N,
\end{equation}
\begin{equation}
\frac{\partial G_N}{\partial n}|_{\partial \Omega_P} = 0.
\label{Eq:Theory:Neumann_Greenfun_def}
\end{equation}
\item \emph{Dirichlet Green's function} eliminate the double layer potential in the same manner by prescribing
\begin{equation}
G_D(\vxo) = G + g_D = 0, \hspace{3mm} \forall \hspace{3mm} \vxo \in \partial \Omega_S.
\end{equation}
\end{itemize}

\begin{figure}
	\centering
	\begin{overpic}[width = .5\columnwidth]{Figures/Theory/Rayleigh_integral.png}
	\end{overpic}
	\caption{Rayleigh geometry}
	\label{Fig:Theory:Rayleigh_geometry}
\end{figure}
\vspace{3mm}
First we are looking for the Neumann's Green function for the planar geometry under discussion:
For the free field Green's function the partial derivative on the plane $y_0 = 0$ is given by
\begin{equation}
\frac{\partial}{\partial y} G(\vx|\vxo,\omega)|_{y_0 = 0} = 
- \frac{y}{4\pi}\left( \frac{1}{| \vx - \vxo |} + \ti \frac{\omega}{c} \right) 
\frac{\te^{-\ti \frac{\omega}{c}  | \vx - \vxo | }}{| \vx - \vxo |^2}
\end{equation}

The construction of Neumann's Green function is now straightforward. In order ensure that \eqref{Eq:Theory:Neumann_Greenfun_def} is fulfilled the solution must have the form
\begin{equation}
\frac{\partial}{\partial y} g_N(\vx|\vxo,\omega)|_{y_0 = 0} = \frac{\partial}{\partial y} G(\vx|\vxo,\omega)|_{y_0 = 0},
\end{equation}
which is the normal derivative of a point source, positioned at $-y$, thus the image of $G(\vx|\vxo,\omega)$ mirrored on the infinite plane. Since this mirror singularity lies outside the domain of investigation, therefore in the $y > 0$ volume it satisfies the homogeneous Helmholtz equation. The Neumann Green's function on the plane then takes the form
\begin{equation}
G_N(\vx|\vxo, \omega)|_{y = 0} = 
2G(\vx|\vxo, \omega)|_{y = 0} = 
\frac{1}{2\pi} \frac{\te^{-\ti \frac{\omega}{c} |\vx-\vxo|}}{ |\vx-\vxo| }
\end{equation}
and the HIE is simplfied into the \emph{Rayleigh's first integral}
\begin{multline}
P(\vx,\omega) =
- 2 \iint_{\partial \Omega_S} \frac{\partial P(\vxo)}{\partial n} G(\vxo|\vx) \td \vxo 
=
 - \frac{\ti \rho_0 c k}{2\pi} \iint_{\partial \Omega_S} V_{\mathrm{n}}(\vxo,\omega)   \frac{\te^{-\ti \frac{\omega}{c} |\vx-\vxo|}}{ |\vx-\vxo| } \td \vxo.
\label{Eq:Theory:RayleighI}
\end{multline}

\vspace{3mm}
The construction of Dirichlet Green's function is simple: by driving the mirror source anti-phase $G_D = G + g_D = 0$ is obtained on the surface, while for the derivative
\begin{equation}
\frac{\partial}{\partial y} G_N(\vx|\vxo,\omega)|_{y_0 = 0} = 2 \frac{\partial}{\partial y} G(\vx|\vxo,\omega)|_{y_0 = 0}
\end{equation}
holds. Substituting that into the HIE the double-layer potential is eliminated and \emph{Rayleigh's second integral} is yielded:
\begin{equation}
P(\vx,\omega) = 
2 \iint_{\partial \Omega_S}  P(\vxo,\omega)  \frac{\partial G(\vx|\vxo,\omega)}{\partial y_0}     \td \vxo.
\label{Eq:Theory:RayleighII}
\end{equation}

The Rayleigh I integral is of major importance in the aspect of Sound Field Synthesis, and in the theory of diffraction from finite aperture. It is also extensively used in the calculation of radiated fields from finite radiators, mounted in infinite walls, eg. field of loudspeakers. It states that the radiated field from a rigid vibrating plane can be calculated by summing the field of monopoles, driven by the normal velocity distribution, or mathematically speaking: by convolving the Green's function with the velocity distribution over the infinite surface.

\vspace{3mm}
Finally inverse Fourier-transform with respect to time leads us to the time domain version of the Rayleigh I integral\cite{Pierce1991}:
\begin{equation}
p(\vx,t) = \frac{\rho_0}{2\pi} \iint_{\partial \Omega_S} \frac{\partial}{\partial t} \frac{v_{\mathrm{n}}(\vxo,t-\frac{ | \vx-\vxo | }{c})}{| \vx-\vxo |} \td \vx_0,
\end{equation}
Note, that since the Rayleigh integral describes the field of an ensemble of point source on the plane $y = 0$, therefore the pressure field is the solution for the following equation \cite{Pierce1991}
\begin{equation}
\nabla^2 p(\mathbf{x},t) - \frac{1}{c^2}\frac{\partial^2 p(\mathbf{x},t)}{\partial t^2} = -2\rho_0 \frac{\partial}{\partial t} v_{\mathrm{n}}(x,z,t)\delta(y).
\end{equation}

\newpage

\section{Theory of Sound Field Synthesis}

\subsection{The problem formulation}
\begin{figure}[b!]
	\centering
	\begin{overpic}[width = .8\columnwidth]{Figures/Theory/general_sfs.png}
	\scriptsize
	\put(0,26){virtual source}
	\put(45,0.5){$\mathbf{0}$}
	\put(71,31){$\vx$}
	\put(43,15){$\vxo$}
	\begin{turn}{27}
	\put(57,-3){$|\vx - \vxo|$}
	\end{turn}
	\put(50,35){$\Omega$}
	\put(80,20.5){$\partial \Omega$}
	\end{overpic}
	\caption{General SFS geometry}
	\label{Fig:Theory:general_sfs_geometry}
\end{figure}


Now we are able the formulate the general Sound Field Synthesis problem. Consider a source-free volume $\Omega \subset \mathbb{R}^n$, bounded by a continuous set of acoustic sources forming the surface $\partial \Omega$.
The enclosing source ensemble is termed as the \emph{secondary source distribution (SSD)}.
For the general geometry see Figure \ref{Fig:Theory:general_sfs_geometry}.
For sake of simplicity we assume, that the secondary sources are acoustic point sources, i.e. monopoles, described by the $n$-dimensional Green's function $G(\vx,\omega)$. Since dynamical loudspeakers can be modeled as 3D monopoles in the low-frequency region, this assumption is feasible. The incorporation of non-ideal secondary source elements in the generalized SFS theory will be discussed in the next chapter.

With these assumptions the pressure at any $\vx \in \Omega$ is given by the sum of the individual SSD elements, written as a single layer potential \cite{Ahrens2012,Ahrens2010phd,Wierstorf2014,Schultz2014:Comparing_approaches}:
\begin{equation}
P(\vx,\omega) = \oint_{\partial \Omega} D(\vxo,\omega) G(\vx - \vxo , \omega ) \td \partial \Omega ( \vxo ).
\label{Eq:Theory:3D_SFS}
\end{equation}
The weighting factor $D(\vxo,\omega)$ is termed as the \emph{driving function} for the given SSD. 
The Sound Field Synthesis problem can be formulated as the following: given a \emph{target sound field}, or the sound field of a \emph{virtual source} $P(\vx,\omega)$. Our aim is to solve the integral equation for $D(\vxo,\omega)$, so that the weighted sum of the SSD's sound field --i.e. the \emph{synthesized field}-- equals to the target sound field. 
The problem is therefore an inverse problem and has a unique solution for general enclosures.

Comparing with the Kirchhoff-Helmholtz integral formulation \eqref{Eq:Theory:Kirchhoff-Helmholtz} it becomes clear, that SFS with a single layer SSD is not able to ensure identically zero sound field outside the enclosure. Practically speaking the removal of the double layer result in that no dipoles are present on the surface which would extinguish the field of the monopoles outside the volume.
In the present thesis free-field conditions are assumed, the exterior sound field satisfies the Sommerfeld radiation condition, thus the effect of the listening environment in practical applications is not included.

In the present thesis exclusively planar and linear SSD geometries are considered employing 3-dimensional secondary sources.

\paragraph{Planar SSD geometry:}
The geometry for the planar case may be derived in the same manner as the geometry for the Rayleigh-integral: we assume that the boundary surface consists of a simply connected disc and hemisphere. Refer to \cite[p.~84,p.~275]{Ahrens2012, Williams1999} for the geometry. For sake of convenience the disk is located in the plane $\vxo = [x_0,\ 0,\ z_0]^{\mathrm{T}}$. By increasing the radius of the hemisphere to infinity and by invoking the Sommerfeld-radiation condition the reproduced field is written as an integral over an infinite plane $\vxo$:
\begin{equation}
P(\vx,\omega) = \iint_{-\infty}^{\infty} D(\vxo,\omega) G(\vx - \vxo , \omega ) \td x_0 \td z_0,
\label{Eq:Theory:3D_planar_SFS}
\end{equation}
and $\Omega$ becomes the half-space $y>0$, often termed as \emph{target half-space}.
$p(\vx,t)$ therefore satisfies the inhomogeneous wave equation with homogeneous Neumann boundary condition
\begin{equation}
\nabla^2 p(\vx,t) - \frac{1}{c^2}\frac{\partial^2}{\partial t^2} p(\vx,t) = - d(x,z,t)\delta(y).
\label{Eq:Theory:3D_planar_SFS_time}
\end{equation}
The planar SSD geometry is depicted in Figure \ref{Fig:Theory:planar_linear_geometry} (a).


\paragraph{Linear SSD geometry:}
From the practical point of view the application of planar loudspeaker geometry is unfeasible. Instead, in practical arrangements linear SSDs are applied.
For a linear SSD positioned at $\vxo = [x_0,\ 0,\ 0]^{\mathrm{T}}$ the synthesized field reads
\begin{equation}
P(\vx,\omega) = \int_{-\infty}^{\infty} D(\vxo,\omega) G(\vx - \vxo , \omega ) \td x_0.
\label{Eq:Theory:Linear_SFS}
\end{equation}
%
\begin{figure} 
	\centering
	\begin{overpic}[width = .8\columnwidth]{Figures/Theory/planar_linear_geometry.png}
	\footnotesize
	\put(34.5,41){$x$}
	\put(40,26){$y$}
	\put(16,54){$z$}
	%
	\put(91,41){$x$}
	\put(96,26){$y$}
	\put(84,26){$\yref$}
	\put(62,26){$-\yref$}
	\put(72,54){$z$}
	\end{overpic}
	\caption{Planar and linear SSD geometry}
	\label{Fig:Theory:planar_linear_geometry}
\end{figure}
It is clear, that equation \eqref{Eq:Theory:Linear_SFS} describes a cylindrically symmetric sound field with the symmetry axis being the SSD. In practice we restrict the investigation of the synthesized field to the horizontal half-plane containing the SSD $z = 0, y>0$, termed as the \emph{synthesis-plane}.
Furthermore, even the explicit solution for the linear problem allows us the ensure theoretically perfect synthesis only along a line parallel to the SSD, termed as the \emph{reference line}. 
Refer to Figure \ref{Fig:Theory:planar_linear_geometry} for the linear SFS geometry.

There are several approaches to solve the problem including physics based implicit and merely mathematical explicit solutions. For special geometries -- planar, linear, spherical, circular or cylindrical SSDs -- analytical expressions are available. In the following these approaches are shortly introduced focusing on planar and linear SSD arrays.

\subsection{Explicit solution: The Spectral Division Method}

The explicit solution for the general SFS problem utilizes compact operator theory by exploiting the fact, that integral \ref{Eq:Theory:3D_SFS} constitutes a compact Fredholm operator with the operator kernel being the Green's function $G(\vx - \vxo , \omega )$ \cite{Ahrens2012,MorseFeshbach1953}.
Such an operator, and the involved acoustic fields can by expanded into the series of orthogonal eigenfunctions of the wave equation on the boundary surface $\partial \Omega$, that form a complete basis of the solution. The inverse problem can be straightforwardly solved for the driving function expansion coefficients by a comparison of the corresponding eigenvalues, as long as none of the expansion coefficient of the operator kernel is zero. Otherwise the problem is termed \emph{ill-conditioned}. 
Finally an explicit analytical solution is found for the driving function as an infinite sum of the weighted basis functions.
The method is often refered as \emph{mode-matching} solutions, since the eigenfunctions of the given geometry are termed the \emph{modes}.

This solution utilizing the single layer potential is unique for general enclosures and also for the non-enclosing planar case as shown in \cite{Zotter2013:uniqueness} and \cite{Fazi2010} respectively. In contrary sound field control utilizing the Kirchhoff-Helmholtz formulation would be non-unique on the eigenfrequencies of the enclosure, or cavity due to resonance phenomena.

The determination of the appropriate eigenfunctions for a general geometry is a tough challenge.
For spherical and circular geometries spherical and circular harmonics form the demanded basis functions. For a rigorous treatment for SFS using spherical and circular SSDs see \cite{Ahrens2010phd,Zotter2009phd,Ahrens2012,Ahrens2009:circularSSD_mismatch,Ahrens2009:circular25D_SFR,Ahrens2008:Analytical_Circ_Spherical_SFS}
In the present thesis only the planar and linear geometries are investigated in details.

\subsubsection{Planar SSD geometry}

For the planar geometry Equation \eqref{Eq:Theory:3D_planar_SFS} is termed a Fredholm-integral of the first kind. Due to the infinite integration limit such integrals are called \emph{singular integrals} thus not form a compact operator \cite[p.~921.]{MorseFeshbach1953}. 
In this case the infinite, non-denumerable eigenvalues of the problem form a continuous function \cite{MorseFeshbach1953,Schultz2014:Comparing_approaches}.
However, due to the reciprocity of the integration kernel the inverse problem can be solved applying the convolution theorem, utilizing that basically \eqref{Eq:Theory:3D_planar_SFS} describes a continuous convolution along the $y=0$ plane:
\begin{equation}
P(\vx,\omega) = D(x,z,\omega)\ast_{x} \ast_{z} G(x,y,z,\omega).
\end{equation}
Here $G(x,y,z,\omega)$ denotes the sound field of a secondary source element placed at the origin.

For the infinite planar geometry the orthogonal basis is given by the continuous set of exponentials, therefore the expansion of the involved quantities is given by a double inverse Fourier-transform \cite{Ahrens2012, Arfken2005,Schultz2014:Comparing_approaches}, with the physical interpretation of a plane wave decomposition:
\begin{equation}
G(\vx - \vxo,\omega) = \frac{1}{4\pi^2} \iint_{-\infty}^{\infty} \tilde{G}(k_x,y,k_z, \omega)  \te^{\ti (k_x x_0 + k_z z_0)} \te^{-\ti (k_x x + k_z z)} \td k_x \td k_z.
\label{Eq:Theory:G_x_inverse_fourier}
\end{equation}
\begin{equation}
P(\vx,\omega) = \frac{1}{4\pi^2} \iint_{-\infty}^{\infty} \tilde{P}(k_x,y,k_z, \omega) \te^{-\ti (k_x x + k_z z)} \td k_x \td k_z.
\end{equation}
In \eqref{Eq:Theory:G_x_inverse_fourier} the translation property of the Fourier-transform is applied.
The expansion coefficients i.e. the angular spectrum of the involved sound fields may be obtained by a forward Fourier-transform.

The series expansions --along with the expansion of driving function-- may be substituted into Equation \eqref{Eq:Theory:3D_planar_SFS}. By changing the order of integration, utilizing the orthogonality of the exponental functions and exploiting the sifting property of the Dirac-delta one finally obtains
\begin{equation}
\tilde{P}(k_x,y,k_z, \omega) = \tilde{D}(k_x,k_z, \omega)  \tilde{G}(k_x,y,k_z, \omega),
\end{equation}
thus the convolution theorem for the Fourier-transform holds \cite{Girod2001}.

The expansion coefficient are therefore obtained by a comparison of spectral coefficients and the driving function takes the form:
\begin{equation}
D(k_x,k_z,\omega) = \frac{\tilde{P}(k_x,y,k_z, \omega)}{ \tilde{G}(k_x,y,k_z, \omega)} = 
\frac{\mathcal{F}\left\{ P(\vx,\omega) \right\} }
{  \mathcal{F}\left\{ G(\vx,\omega) \right\} },
\end{equation}
\begin{equation}
D(x_0,z_0,\omega) = \frac{1}{4\pi^2} \iint_{-\infty}^{\infty} \tilde{D}(k_x,k_z, \omega) \te^{-\ti (k_x x_0 + k_z z_0)} \td k_x \td k_z.
\label{Eq:Theory:Dkx_inverse_Fourier}
\end{equation}
Since the driving function spectrum is yielded by a division in the spectral domain the approach is termed as the \emph{Spectral Division Method} \cite{Ahrens2010a, Ahrens2012:Ambisonics_for_planar_linear, Ahrens2011:icassp, Ahrens2010:Ambisonics_w_planar_linear}.

It is shall be noticed, that this method does not give a constraint on the integral kernel. Theoretically an arbitrary transfer function may be assigned for the SSD elements: as long the problem is well-conditioned --i.e. the spectrum of the transfer function does not exhibit zeros-- unique driving functions may be derived applying the foregoing.

\vspace{3mm}
For general 3D SFS problems the elements of the SSD are described by the 3D Green's function. The plane wave expansion of the 3D free field Green's function is termed as the Weyl's integral representation \cite{Williams1999, Lalor1969}:
\begin{equation}
G(\vx - \vxo,\omega ) = \frac{1}{4\pi} \iint_{-\infty}^{\infty} -\frac{\ti}{2}\frac{\te^{ -\ti k_y  | y |  }}{ k_y }
\te^{\ti (k_x x_0 + k_z z_0)} \te^{-\ti (k_x x + k_z z)} \td k_x \td k_z.
\label{Eq:Theory:Weyls_integra}
\end{equation}
with $k_y = \sqrt{ \left( \frac{\omega}{c} \right )^2 - k_x^2 - k_z^2 }$, thus the angular spectrum of the Green's function at $\vxo = [0,\ 0,\ 0]^{\mathrm{T}}$ measured at a fixed $y$ is given as:
\begin{equation}
\tilde{G}(k_x,y,k_z,\omega) =-\frac{\ti}{2}\frac{\te^{ -\ti k_y  | y |  }}{ k_y }.
\end{equation}
With the angular spectrum representation the target sound field on a fixed, arbitrary $(y=\mathrm{const})$ plane may be expressed from the field measured on $y=0$ using equation \eqref{Eq:Theory:Wave_field_extrapolation}:
\begin{equation}
\tilde{P}(k_x,y,k_z,\omega) = \tilde{P}(k_x,0,k_z,\omega) \te^{- k_y y}.
\end{equation}
By carrying out the division for the planar case the exponential pressure propagators cancel out, and the driving function becomes independent from the $y$-coordinate and the spectral representation reads
\begin{equation}
\tilde{D}(k_x,k_z,\omega) = 2\ti k_y \tilde{P}(k_x,0,k_z,\omega).
\label{Eq:Theory:Planar_explicit_driv_fun}
\end{equation}
Straightforwardly, the explicit expression of the driving function is obtained by the proper inverse Fourier-transform according to \eqref{Eq:Theory:Dkx_inverse_Fourier}.

\subsubsection{Linear SSD geometry}

Similarly to the planar case the basis functions for a linear SSD is given by exponentials.
By realizing that equation \eqref{Eq:Theory:Linear_SFS} can be regarded as a convolution integral along the $x$-axis,
the convolution is transformed into a multiplication vby means of a forward Fourier-transform
\begin{equation}
\tilde{P}(k_x,y,z, \omega) = \tilde{D}(k_x,\omega)\tilde{G}(k_x,y,z, \omega).
\end{equation}
The driving function spectra is then obtained as a spectral ratio
\begin{equation}
\tilde{D}(k_x,\omega) = \frac{\tilde{P}(k_x,y,z, \omega)}{\tilde{G}(k_x,y,z, \omega)} = \frac{\mathcal{F}_x\left\{ P(\vx,\omega) \right\}}{\mathcal{F}_x\left\{ G(\vx,\omega) \right\}},
\end{equation}
and the frequency domain driving function therefore reads
\begin{equation}
D(\vxo,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \frac{\tilde{P}(k_x,y,z, \omega) }{\tilde{G}(k_x,y,z, \omega)} \te^{-\ti k_x x_0} \td k_x.
\label{Eq:Theory:LinearSDM1}
\end{equation}
In order to kepp the problem well-conditioned the transfer function $\tilde{G}(k_x,y,z, \omega)$ may not exhibit zeros.
For 3D problems applying point sources as SSD elements the Fourier-transform coefficients of the Green's function is given as \cite{Ahrens2010a}
\begin{equation}
\tilde{G}(k_x,y,z,\omega) = -\frac{\ti}{4} H_0^{(2)}\left( \sqrt{ \left( \frac{\omega}{c} \right)^2 - k_x^2 } \sqrt{ y^2 + z^2 } \right).
\end{equation}

\vspace{3mm}
Note, that unlike the planar case here the driving function contains both $y$ and $z$ position thus the driving function is dependent upon the listener position: Equation \eqref{Eq:Theory:LinearSDM1} may be solved only for positions on the surface of a cylinder for fixed $d = \sqrt{y^2 + z^2}$ \cite[p.~60.]{Ahrens2010phd}.
Also since an infinite line source --i.e. the SSD-- can only radiate wavefronts with cylindrical symmetry the following  dispersion relation must hold:
\begin{equation}
\left( \frac{\omega} {c}\right)^2 - k_x^2 = k_y^2 + k_z^2 = k_{\rho}^2,
\end{equation}
with $k_{\rho}$ being the radial wavenumber. That suggest, that on a fixed temporal frequency only component $k_x$ can be controlled individually using a linear SSD .

These restrictions will have the following consequence:
Since for a fixed $k_x$ the radial wavenumber and the propagation direction of the synthesized field is determined, perfect synthesis may be assured only along a straight line, parallel with the SSD: where the distance from the SSD determined by $d = \sqrt{x^2 + y^2}$, and on which the radial wavenumber of the target sound field corresponds to that of the synthesized field, determined by $\left( \frac{\omega} {c}\right)^2 - k_x^2$.

For practical applications we choose the horizontal plane $z=0$ for the plane of synthesis, and reference the driving functions to the \emph{reference line}, by setting $y = \yref$.
See Figure \ref{Fig:Theory:planar_linear_geometry} (b) for an illustration. The driving function thus reads
\begin{equation}
D(x_0,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \frac{\tilde{P}(k_x,\yref,0, \omega) }{\tilde{G}(k_x,\yref,0, \omega)} \te^{-\ti k_x x_0} \td k_x.
\label{Eq:Theory:Linear_SDM}
\end{equation}
In this geometry amplitude correct synthesis is restricted to the reference line, furthermore the propagation direction can be reconstructed for those sound fields, for that $k_z = 0$ in the $z=0$ plane. Practically that means plane waves propagating along the horizontal plane or point sources located in the plane of synthesis.

\vspace{3mm}
It's worth noting that the analytic Fourier-transform cofficients of the target sound field is available only for limited cases. In any other cases numerical transforms are needed.
For a practical and optimized implementation of the SDM for an arbitrary target sound field refer to \cite{ahrens2013a:efficientSDM}

% To check: SDM w linear sources from the helical spectrum representation (eg. single layer potential, or scattering from a rigid line source)
%
% To check: Approximation of explicit linear SSD driving functions to by reduce it to the wavefield on the SSD

% To check: why Frank writes, that no solution is known for (A12) in Schultz,Spors Analytical SFS... It is given is Fourier Acoustics (2.65)

\newpage
\subsection{Implicit solution of the SFS equation}

The implicit solution for the general SFS problem aims at the reduction of the Kirchhoff-Helmholtz Integral (\emph{KHIE}) equation to a single layer potential instead of the explicit solution of the inverse problem, as treated in the previous subsection. Naturally this will result in a non-zero field outside the enclosure.

As we could see the using the KHIE describes the sound field inside the enclosure in the form of a double layer potential:
\begin{equation}
P(\vx,\omega) = 
\iint_{\partial \Omega}  \left( 
P(\vxo,\omega)  \frac{\partial G(\vx|\vxo,\omega)}{\partial n}  -  
G(\vx|\vxo,\omega) \frac{\partial P(\vxo,\omega)}{\partial n} 
\right)   \td \partial \Omega ( \vxo),
\end{equation}
with $\vx \in \Omega$.
In order to let the double layer vanish two different approaches exist:
\begin{itemize}
\item Imposing homogeneous Dirichlet boundary conditions on the total field --which in the interior equals to the target sound field-- in an equivalent scattering problem: 
\begin{equation}
P(\vxo,\omega) = 0.
\end{equation}
The resulting single layer potential is termed as the \emph{simple source formulation}.
\item Deriving the Neumann Green's function for the geometry, that's normal derivative vanishes on the boundary:
\begin{equation}
\frac{\partial G(\vx|\vxo,\omega)}{\partial n}  = 0.
\end{equation}
\end{itemize}
In section \ref{Section:Theory:Rayleigh} the Rayleigh-integrals were introduced from the latter, Neumann Green's function approach. Since Rayleigh integrals represent a single layer potential applying the free field Green's function, this formulation could be used directly for SFS applying planar SSD. 
This property however can not be generalized: in general geometries the resulting Neumann Green's function can not be expressed in terms of the the free field Green's function, therefore the obtained formulation --although being a single layer potential-- can not be realized in practice with real life sound sources \cite{Schultz2014:Comparing_approaches}.

For sake of completeness here it is shown, that the simple source formulation theoretically ensures the realizable driving functions for an arbitrary geometry, leading to the same result for the planar case as the Neumann Green's function approach.

\paragraph{Simple Source Formulation/Equivalent Scattering Problem:\\}

The simple source formulation is derived from the KHIE by the construction of a separate exterior and interior radiation problem with describing the same inhomogeneous Dirichlet boundary condition for both fields on the boundary surface $\partial \Omega$.

Assume that we have an exterior sound field $P_{\mathrm{e}}(\vx,\omega)$, $\vx \in \Omega_{\mathrm{e}}$, satisfying the homogeneous Helmholtz equation, meaning that all sources are located within the enclosure. The exterior wave field is the sum of  radiating, or diverging waves. On the other hand assume an interior sound field $P_{\mathrm{i}}(\vx,\omega)$ inside the enclosure $\vx \in \Omega$, emerging from a sound field located outside the volume of investigation, thus also satisfying the homogeneous Helmholtz equation. The sound field is described by a set of incoming or converging waves.
The two spatial disjunct problems are connected through the following boundary condition written onto the boundary surface
\begin{equation}
P_{\mathrm{e}}(\vxo,\omega) = P_{\mathrm{i}}(\vxo,\omega), \hspace{15mm} \vxo \in \partial \Omega
\end{equation}
Both fields may be expressed in terms of an exterior and an interior KHIE respectively.
By subtracting the exterior from the interior KHIE due to the coupled boundary condition terms containing the pressure on the boundary vanishes and the following integral expression is obtained

\begin{equation}
\iint_{\partial \Omega} 
G(\vx|\vxo,\omega) 
\left(
\frac{\partial P_{\mathrm{e}}(\vxo,\omega)}{\partial n} - \frac{\partial P_{\mathrm{i}}(\vxo,\omega)}{\partial n} 
\right)
\td \partial \Omega ( \vxo)
= 
\begin{cases} 
P_{\mathrm{e}}(\vxo,\omega)           & \hspace{1mm} \forall \hspace{5mm}  \vxo \in \Omega_e  	   \\
P_{\mathrm{e}}=P_{\mathrm{i}} & \hspace{1mm} \forall \hspace{5mm}  \vxo \in \partial \Omega  \\
P_{\mathrm{i}}(\vxo,\omega) 			& \hspace{1mm} \forall \hspace{5mm}  \vxo \in \Omega_i.
\end{cases}
\end{equation}
The minus sign from $P_{\mathrm{i}}$ vanishes since $\mathbf{n}_{\mathrm{e}}(\vxo) = -\mathbf{n}_{\mathrm{i}}(\vxo), \hspace{1mm} {\vxo}\in \partial \Omega$. The equation states that either the interior or the exterior sound field, satisfying the homogeneous Helmholtz equation may be determined using as a single layer potential, by constructing the corresponding exterior or interior problem respectively. The single layer strength function is given by 
\begin{equation}
D(\vxo,\omega) = 
\frac{\partial P_{\mathrm{e}}(\vxo,\omega)}{\partial n} - \frac{\partial P_{\mathrm{i}}(\vxo,\omega)}{\partial n}.
\label{Eq:Theory:Jump_relation}
\end{equation}
Equation \eqref{Eq:Theory:Jump_relation} is termed as the \emph{jump relation}, expressing the fact that the sound field generated by the single layer potential exhibits a continuous pressure in the boundary $\partial \Omega$, while the velocity shows a discontinuity (\emph{jump}).

In terms of sound field synthesis the interior sound field is the target sound field itself. The simple source formulation therefore states that for an arbitrary geometry the SSD driving function is given by
\begin{equation}
D(\vxo,\omega) = 
\frac{\partial P_{\mathrm{e}}(\vxo,\omega)}{\partial n} - \frac{\partial P(\vxo,\omega)}{\partial n},
\end{equation}
where $P_{\mathrm{e}}(\vxo,\omega)$ is the corresponding exterior sound field.