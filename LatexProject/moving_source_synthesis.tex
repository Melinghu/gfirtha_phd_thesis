In the previous chapters merely the description and reproduction of stationary sound fields were discussed.
The presented sound field synthesis methods however, were not restricted for the synthesis of stationary sound fields.
In addition to the static case the synthesis of moving sources gained increasing interest.
This chapter deals with the synthesis of the sound fields generated by moving sound sources, constituting a complex application example of the foregoing.

For this dynamic case the primary challenge is the proper reconstruction of the \emph{Doppler effect}, occuring due to the constant, finite wave propagation velocity in a homogeneous medium:
Since wavefronts, generated by a source under motion propagate away from the excitation position with a finite sound speed, therefore in front of the source---towards the direction of the source motion---the wavefronts are compressed, while behind the source a rarefaction of wavefronts occurs.
This phenomenom leads to an altered perceived frequency in case of a harmonic source excitation, termed as the \emph{Doppler shift}.

The proper reconstruction of the Doppler effect is inherently solved when analytical source models are applied.
Thus, first the analytical description of a sound field, generated by a moving source is investigated.

\section{Description of moving sources}

This section extends the description and high-frequency/asymptotic properties of stationary sound fields for the particular case of a moving 3D point source.
Obviously, the solution obtained in the followings can be applied in order to describe spatially extended moving sources, while an inclusion of source directivity can be found in \cite{Warren1976, Ahrens2011_moving_source_WFS}.

\subsection{Time domain description}
	
As the simplest case for a moving sound source the field, excited by a 3D point source under arbitrary motion is examined in details \cite{deHoop2005}.
Assume a point source, moving along an arbitrary trajectory with an arbitrary velocity profile, with the source location time history given by $\vxs(t) = \posvec{3}{x(t)}{y(t)}{z(t)}$.
The spatio-temporal impulse response of such a moving source, satisfying the inhomogeneous wave equation
\begin{equation}
\left( \Dx^2 -\frac{1}{c^2}\frac{\partial^2}{\partial t^2} \right) g_{\mathrm{m}}(\vx-\vxs(\hat{t}),t-\hat{t}) = -\delta\left( \vx - \vxs(\hat{t}) \right)\delta\left( t - \hat{t} \right),
\label{Eq:Theory:Green_function_def}
\end{equation}
is given by the \emph{retarded Green's function} \cite{Jackson1999}
\begin{equation}
g_{\mathrm{m}}(\vx-\vxs(\hat{t}),t-\hat{t}) = \frac{1}{4\pi} \frac{\delta( t - \hat{t} - \frac{|\vx-\vxs(\hat{t})|}{c} )}{|\vx-\vxs(\hat{t})|},
\end{equation}
where $\hat{t}$ referred to as the \emph{emission time}: 
the time instant at which the impulse was emitted that arrives to the receiver position $\vx$ at the time instant $t$.
A moving source therefore radiates spherical wavefronts with the center being the source position at the emission time.
Obviously, the time instant of emission depends on the receiver position and time, denoted as $\hat{t}(\vx,t)$

The field generated by a moving source with a source excitation time history $s(t)$ is obtained by modeling the excitation signal as the sum of a continuous sequence of Dirac-pulses \cite{Ahrens2012, Girod2001}.
Each pulse is weighted by the retarded Green's function describing the wave propagation from the actual source position to the receiver position.
The radiated field therefore can be written as 
\begin{multline}
p_{\mathrm{m}}(\vx,t) = \int_{-\infty}^{\infty} s(\hat{t}(\vx,t)) g_{\mathrm{m}}(\vx-\vxs(\hat{t}(\vx,t)),t-\hat{t}(\vx,t)) \td \hat{t}(\vx,t) = \\ =
\frac{1}{4\pi}\int_{-\infty}^{\infty} s(\hat{t}(\vx,t))  \frac{\delta( t - \hat{t}(\vx,t) - \frac{|\vx-\vxs(\hat{t}(\vx,t))|}{c} )}{|\vx-\vxs(\hat{t}(\vx,t))|} \td \hat{t}(\vx,t),
\end{multline}
describing a non-stationary convolution with the time-variant convolution kernel being the moving source impulse response.
\begin{figure} 
	\small
    \begin{minipage}[c]{0.65\textwidth}
    \hspace{0cm}
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/moving_source_geometry.png}
	\small
	\put(95,18){$x$}
	\put(-2,7){$z$}
	\put(6,56){$y$}
	\put(74,51.5){$\vx$}
	\put(58,26){$\vxs(t)$}
	\put(33,25){$\vxs(t-\tau)$}
	\begin{turn}{29}
	\put(50,11.5){$R(t-\tau) = \tau  c $}
	\end{turn}
	\put(64,30){$\vv(t)$}
	\put(78, 9){$\begin{matrix}
		\text{source}\\
		\text{trajectory}
		\end{matrix}$}
	\end{overpic} 
	\end{minipage}
	\hspace{10mm}
	\begin{minipage}[c]{0.25\textwidth}
    \caption{
	 Arrangement for the description of a source, moving at an arbitrary trajectory}
	\label{Fig:Moving_source:source_geometry}
	\end{minipage}
\end{figure}  

The convolution may be evaluated either by the generalization of the Dirac delta's sifting property\footnote{
For a Dirac delta with a function arguments as a generalization $\delta(f(x)) = \sum_{i}\frac{\delta(x-x_i)}{f'_{x})(x_i}$ holds, where $x_i$ are the roots of $f(x)$.}, 
or equivalently by introducing a new variable $t'(\hat{t}(\vx,t)) = \hat{t}(\vx,t) - \frac{|\vx-\vxs(\hat{t}(\vx,t))|}{c}$.
The Jacobian is expressed by applying the chain rule, reading 
\begin{equation}
\frac{\td t'(\hat{t}(\vx,t))}{\td \hat{t}(\vx,t)} = 1 - \frac{1}{c} \frac{\left< \frac{\partial}{\partial \hat{t}}\vxs(\hat{t}(\vx,t)) \cdot \vx-\vxs(\hat{t}(\vx,t))\right> }{|\vx-\vxs(\hat{t}(\vx,t))|}.
\end{equation}
The temporal derivative of the source position $\vvs(\hat{t}(\vx,t)) = \frac{\partial}{\partial \hat{t}}\vxs(\hat{t}(\vx,t))$ can be recognized as the source velocity vector at the emission time.
As the Dirac delta sifts out $t = t'(\hat{t}(\vx,t))$ the evaluation of the integral results in the field of a moving 3D point source, reading
\begin{equation}
p_{\mathrm{m}}(\vx,t) =
\frac{1}{4\pi} \frac{ s(t - \frac{|\vx-\vxs(\hat{t}(\vx,t))|}{c} ) }{|\vx-\vxs(\hat{t}(\vx,t))| - \frac{1}{c}\left< \vvs(\hat{t}(\vx,t)) \cdot \vx-\vxs(\hat{t}(\vx,t))\right> }
\end{equation}
where $t - \hat{t}(\vx,t) = \frac{|\vx-\vxs(\hat{t}(\vx,t))|}{c}$ is satisfied.
The geometry is illustrated in Figure \ref{Fig:Moving_source:source_geometry}.

Conventionally the radiated field is expressed in terms of the propagation time-delay $\tau(\vx,t) = t - \hat{t}(\vx,t)$.
Introducing $\Delta(\vx,t)$ for the attenuation factor the radiated field is given as
\begin{equation}
p_{\mathrm{m}}(\vx,t) = \frac{1}{4\pi}\frac{q( t - \tau( \vx,t ) )}{\Delta(\vx,t-\tau( \vx, t ))},
\label{eq:moving_source_field}
\end{equation}
with
\begin{equation}
\Delta( \vx,t ) = |\vx - \vxs(t)| - \left<\, \frac{1}{c}\vvs(t) \cdot (\vx - \vxs(t)) \right> 
 =  |\vx - \vxs(t)|\left( 1 - M(t) \cos \vartheta(\vx,t) \right),
\label{eq:delta}
\end{equation}
where $M(t) = |\vvs(t)|/c$ is the \emph{Mach number} and $\vartheta(\vx,t)$ is the angle between the velocity vector and the source-receiver vector and the propagation time delay $\tau(\vx,t)$ satisfies the non-linear quadratic equation
%
\begin{equation}
\tau(\vx,t) =  \frac{| \vx - \vxs( t - \tau(\vx,t)) |  }{c}.
\label{eq:tau}
\end{equation}
%
For subsonic velocities (i.e.\ $v<c$) only the positive root of the quadratic equation ($\tau(\vx,t)>0$) is taken into consideration \citep{deHoop2005}. 
In the present thesis exclusively subsonic velocities are discussed.
For a detailed treatment on sources moving at supersonic velocities refer to \cite{Ahrens2012, Ahrens2008moving_b}.

In equation \eqref{eq:delta} $\left( 1 - M(t) \cos \vartheta(\vx,t) \right)^{-1}$ is termed as the \emph{Doppler factor}.
Equation \eqref{eq:delta} states that as a part of the Doppler effect, due to the compression of wavefronts towards the direction of the source motion the resulting amplitude of the wave field increases compared to that of a stationary source.
Similarly, behind the moving source due to the rarefaction of the wavefront the amplitude of the source decreases.
This relative change of the attenuation factor is also described by the Doppler factor.

\subsubsection{High frequency description of moving sources}
In order to gain more insight into the harmonic behaviour of moving sources to apply the high frequency approximations discussed in the previous chapters assume a moving source with a harmonic time dependence $s(t) = \te^{\ti \omega_0 t}$, oscillating at the angular frequency $\omega_0$.
The radiated field reads as
\begin{equation}
P_{\mathrm{m}}(\vx,t,\omega_0) = \frac{1}{4\pi}\frac{\te^{\ti \omega_0\left( t - \tau( \vx,t )\right)}}{\Delta(\vx,t-\tau( \vx, t ))}.
\label{eq:harmonic_moving_source_field}
\end{equation}
As the first important property of the radiated wave field, the time history of the perceived angular frequency at a fixed receiver position $\omega(\vx,t)$ can be obtained by generalizing the frequency as the temporal derivative of the phase function \cite{Morse1968}:
\begin{equation}
\omega(\vx,t) = \frac{\partial}{\partial t}\phi^P(\vx,t) =  \omega_0 \left( 1 - \frac{\partial}{\partial t} \tau(\vx,t)) \right).
\end{equation}
The temporal derivative of the propagation time delay can be expressed by the differentiation of its implicit definition \eqref{eq:tau}, reading
\begin{equation} 
\frac{\partial}{\partial t} \tau(\vx,t)) = \frac{1}{c}\frac{\partial}{\partial t} | \vx - \vxs( t - \tau(\vx,t)) |  =
\frac{-\frac{1}{c} \left<\, \vvs(t-\tau(\vx,t)) \cdot (\vx - \vxs(t-\tau(\vx,t))) \right> }{\Delta(\vx,t-\tau(\vx,t))}.
\end{equation}
and the perceived frequency can be expressed as 
\begin{equation}
\omega(\vx,t) =\frac{  \omega_0  }{1 - M(t) \cos \vartheta(\vx,t) }.
\end{equation}
This expression is the general Doppler formula, describing the relative frequency shift in case of a harmonic source signal \cite{Morse1968}. 
Thus in front of the point source both the perceived frequency and the amplitude of the source increasing according to the Doppler factor.

Now the high-frequency/asymptotic characteristics introduced for stationary wave fields in Chapter \ref{sec:high_freq_approx} are extended for the field of a moving point source.
Assume a general non-stationary harmonic sound field, satisfying the wave equation, written in a general polar form
\begin{equation}
\left( \Lx - \frac{1}{c^2}\frac{\partial^2}{\partial t^2}\right) A^P(\vx,t) \te^{\ti \phi^P(\vx,t)} = 0.
\end{equation}
The equation holds for the field, generated by a moving point source \eqref{eq:harmonic_moving_source_field} excluding the the source position at the emission time.
Expanding the spatial and temporal derivatives yields
\begin{multline}
\left( 
\frac{\Lx A^P}{A^P} 
- 
| \Dx \phi^P |^2
-\frac{1}{c^2} \frac{A^{P''}_{tt}}{A^P} +\frac{1}{c^2}|\phi^{P'}_{t}|^2 + \\
+ \ti \left(  
\Lx \phi^P
+ 2\frac{ \left< \Dx \phi^P \cdot \Dx A^P \right> }{A^P}  - \frac{1}{c^2} \phi^{P''}_{tt} - \frac{1}{c^2} 2\frac{A^{P'}_t \phi^{P'}_t }{A^P} 
\right)
\right) 
A^P(\vx,t) \te^{\ti \phi^P(\vx,t)}  = 0.
\label{eq:HF_appr:ray_tracing_helmholtz_nonstat}
\end{multline}
This is obviously the generalization of the basic ray-tracing equation \eqref{eq:HF_appr:ray_tracing_helmholtz}, extended towards non-stationary sound fields with space-time variant amplitude and phase functions.
Similarly to the stationary case, the equation holds only if both the real and imaginary parts vanish, resulting in
\begin{eqnarray} \label{eq:HF_appr:eikonal_eq_non_stat}
\frac{\Lx A^P}{A^P}  - | \Dx \phi^P |^2 -\frac{1}{c^2} \frac{A^{P''}_{tt}}{A^P} +\frac{1}{c^2}|\phi^{P'}_{t}|^2 = 0, \\ 
\label{eq:HF_appr:transport_eq_non_stat}
\Lx \phi^P + 2\frac{ \left< \Dx \phi^P \cdot \Dx A^P \right> }{A^P} - \frac{1}{c^2} \phi^{P''}_{tt} - \frac{1}{c^2} 2\frac{A^{P'}_t \phi^{P'}_t }{A^P} = 0.
\end{eqnarray}

\subsection{Frequency domain description}
\subsection{Wavenumber domain description}
	
\section{WFS of moving sources}
	\subsection{3D WFS}
	\subsection{2.5D WFS}
	
\section{SDM of moving sources}

\section{Artifacts of synthesis}
	\subsection{Effects of SSD sampling}
	
\section{Application notes}