In the previous chapters the description and reproduction of stationary sound fields were discussed.
The presented sound field synthesis methods however, were not restricted for the synthesis of stationary sound fields.
In addition to the static case the synthesis of moving sources gained increasing interest.
This chapter deals with the synthesis of the sound fields generated by moving sources of sound, constituting a complex application example for the foregoing.

For this dynamic case the primary challenge is the proper reconstruction of the \emph{Doppler effect}, occurring due to the constant, finite wave propagation velocity in a homogeneous medium.
Since wavefronts, generated by a source under motion propagate away from the excitation position with a finite sound speed, therefore in front of the source---towards the direction of the source motion---the wavefronts are compressed, while behind the source a rarefaction of wavefronts occurs.
This phenomenon leads to a modified, time dependent attenuation factor and a clearly audible altered perceived frequency in case of a harmonic source excitation, termed as the \emph{Doppler shift}.

The proper reconstruction of the Doppler effect is however inherently solved when analytical source models are applied.
Thus, first the analytical description of a sound field, generated by a moving source is investigated.

\section{Description of moving sources}

This section extends the description and high-frequency/asymptotic properties of stationary sound fields for the particular case of a moving 3D point source.
The solution obtained in the followings can be applied in order to describe spatially extended moving sources, while an inclusion of source directivity can be found in \cite{Warren1976, Ahrens2011_moving_source_WFS}.

\subsection{Time domain description}
	
As a general case for a moving sound source the field, excited by a 3D point source under arbitrary motion is examined in details \cite{Dowling1983, deHoop2005}.
Assume a point source, moving along an arbitrary trajectory with an arbitrary velocity profile, with the source location time history given by $\vxs(t) = \posvec{3}{x(t)}{y(t)}{z(t)}$.
The spatio-temporal impulse response of such a moving source, satisfying the inhomogeneous wave equation
\begin{equation}
\left( \Dx^2 -\frac{1}{c^2}\frac{\partial^2}{\partial t^2} \right) g_{\mathrm{m}}(\vx-\vxs(\tE),t-\tE) = -\delta\left( \vx - \vxs(\tE) \right) \cdot \delta\left( t - \tE \right),
\label{Eq:Theory:Green_function_def}
\end{equation}
is given by the \emph{retarded Green's function} \cite{Jackson1999}
\begin{equation}
g_{\mathrm{m}}(\vx-\vxs(\tE),t-\tE) = \frac{1}{4\pi} \frac{\delta( t - \tE - \frac{|\vx-\vxs(\tE)|}{c} )}{|\vx-\vxs(\tE)|},
\label{Eq:Theory:retarded_greens}
\end{equation}
where $\tE$ is referred to as the \emph{emission time}: 
the time instant at which the impulse was emitted that arrives to the receiver position $\vx$ at the time instant $t$.
Formally, the field of a moving impulsive point source is obtained from the stationary Green's function, by letting the source position to be the function of time.
A moving point source therefore radiates spherical wavefronts with the center being the source position at the emission time.
This general case is illustrated in Figure \ref{Fig:Moving_source:source_geometry}.
	
The field generated by a moving source with a source excitation time history $s(t)$ is obtained by modeling the excitation signal as the sum of a continuous sequence of Dirac-pulses \cite{Ahrens2012, Girod2001}.
Each pulse is weighted by the retarded Green's function describing the wave propagation from the source position at the emission time to the receiver position.
The radiated field therefore can be written as 
\begin{equation}
\label{eq:moving_source:non_stat_convolution}
p_{\mathrm{m}}(\vx,t) = \int_{-\infty}^{\infty} s(\tE) g_{\mathrm{m}}(\vx-\vxs(\tE),t-\tE) \td \tE =  
\frac{1}{4\pi}\int_{-\infty}^{\infty} s(\tE)  \frac{\delta( t - \tE - \frac{|\vx-\vxs(\tE)|}{c} )}{|\vx-\vxs(\tE)|} \td \tE,
\end{equation}
describing a non-stationary convolution with the time-variant convolution kernel being the moving source impulse response \cite{Margrave1998}.
\begin{figure} 
	\small
    \begin{minipage}[c]{0.6\textwidth}
    \hspace{0cm}
	\begin{overpic}[width = 1.00\columnwidth ]{Figures/Moving_sources/moving_source_geometry.png}
	\small
	\put(95,19){$x$}
	\put(7,23.5){$z$}
	\put(7,66){$y$}
	\put(55,64){$\vx$}
	\put(58.5,32.5){$\vxs(t)$}
	\put(33.5,30){$\vxs(\tE)$}
	\put(69,38){$\vv(t)$}
	\put(45.5,38.5){$\vv(\tE)$}
	\put(40,36.5){$\theta$}
	\put(0, 8){$\begin{matrix}
		\text{source}\\
		\text{trajectory}
		\end{matrix}$}
	\end{overpic} 
	\end{minipage}
	\hspace{10mm}
	\begin{minipage}[c]{0.35\textwidth}
    \caption{
	 Geometry for the description of the sound field of a moving point source, moving at an arbitrary trajectory described by $\vxs(t)$.
The figure illustrates a moving source emitting impulses, with the position at the emission time instants denoted by grey dots on the trajectory.
%The impulses propagate with spherical wavefront, with the attenuation factor described by the retarded Green's function \eqref{Eq:Theory:retarded_greens}.
The first impulse, emitted at $t_e$ is received in the receiver position $\vx$ at the time instant $t$, when the ,,snapshot'' is taken.}
	\label{Fig:Moving_source:source_geometry}
	\end{minipage}
\end{figure}  

The convolution may be evaluated by the generalization of the Dirac delta's sifting property for arguments of general functions \cite{Dowling1983, Crighton1992, Jackson1999}, given as\footnote{
Equivalently, the same result is obtained by introducing a new variable for $t'(\tE) = \tE + |\vx-\vxs(\tE)|/c$.}
\begin{equation}
\int_{-\infty}^{\infty} f(t) \delta(g(t)) \td t = \sum_{i} \frac{f(t_i)}{\left| \frac{\partial}{\partial t} g(t) \right|_{t = t_i}}, \hspace{5mm} \text{where} \hspace{5mm} g(t_i) = 0.
\end{equation}

In the present case the derivative of the argument, i.e. the Jacobian is expressed by applying the chain rule, reading 
\begin{equation}
\label{eq:moving_source:jacobian}
\frac{\td }{\td \tE} g(\tE) = - 1 + \frac{1}{c} \frac{\left< \frac{\partial}{\partial \tE} \vxs(\tE) \cdot \vx-\vxs(\tE)\right> }{|\vx-\vxs(\tE)|}.
\end{equation}
The temporal derivative of the source position $\vvs(\tE) = \frac{\partial}{\partial \tE}\vxs(\tE)$ can be recognized as the source velocity vector at the emission time.
Convolution with the Dirac delta sifts out the zeros of its argument, given by the emission time for which
\begin{equation}
\label{eq:moving_source:emission_time}
\tE(t,\vx) = t - \frac{|\vx-\vxs(\tE(t,\vx))|}{c}
\end{equation}
holds.
Note that for a given receiver position $\vx$ and receiving time $t$, the emission time instant $\tE(t,\vx)$ is a dependent variable.
For subsonic velocities (i.e.\ $v<c$) only the positive real root for this quadratic equation is considered, while the Jacobian \eqref{eq:moving_source:jacobian} is negative.
With all these considerations the non-stationary convolution \eqref{eq:moving_source:non_stat_convolution} can be evaluated, yielding the sound field of a moving point source
\begin{equation}
p_{\mathrm{m}}(\vx,t) =
\frac{1}{4\pi} \frac{ s(t - \frac{|\vx-\vxs(\tE(\vx,t))|}{c} ) }{|\vx-\vxs(\tE(\vx,t))| - \frac{1}{c}\left< \vvs(\tE(\vx,t)) \cdot \vx-\vxs(\tE(\vx,t))\right> },
\end{equation}
with $\tE$ satisfying equation \eqref{eq:moving_source:emission_time}.

Conventionally the radiated field is expressed in terms of the propagation time-delay $\tau(\vx,t) = t - \tE(\vx,t)$ given by the non-linear quadratic equation
\begin{equation}
\tau(\vx,t) =  \frac{| \vx - \vxs( t - \tau(\vx,t)) |  }{c}.
\label{eq:tau}
\end{equation}
Again, for subsonic velocities only the positive root of the quadratic equation ($\tau(\vx,t)>0$) is taken into consideration \citep{deHoop2005}. 
In the present thesis exclusively subsonic velocities are discussed.
For a detailed treatment on sources moving at supersonic velocities refer to \cite{Ahrens2012, Ahrens2008moving_b}.
Introducing $\Delta(\vx,t)$ for the attenuation factor the radiated field is given as
\begin{equation}
p_{\mathrm{m}}(\vx,t) = \frac{1}{4\pi}\frac{s( t - \tau( \vx,t ) )}{\Delta(\vx,t-\tau( \vx, t ))},
\label{eq:moving_source_field}
\end{equation}
with
\begin{equation}
\Delta( \vx,t ) = |\vx - \vxs(t)| - \left<\, \frac{1}{c}\vvs(t) \cdot (\vx - \vxs(t)) \right> 
 =  |\vx - \vxs(t)|\left( 1 - M(t) \cos \vartheta(\vx,t) \right),
\label{eq:delta}
\end{equation}
where $M(t) = |\vvs(t)|/c$ is the \emph{Mach number}, $\vartheta(\vx,t)$ is the angle between the velocity vector and the source-receiver vector and the term $\left( 1 - M(t) \cos \vartheta(\vx,t) \right)^{-1}$ is referred to as the \emph{Doppler factor}.% describing whether the source moves towards to or away from the receiver position.
The geometry along with the notation used, is illustrated in Figure \ref{Fig:Moving_source:source_geometry}.
%
Equation \eqref{eq:delta} states that as a part of the Doppler effect, due to the compression of wavefronts towards the direction of the source motion the resulting spatial amplitude distribution of the wave field increases compared to that of a stationary source.
Similarly, behind the moving source due to the rarefaction of the wavefronts the amplitude of the source decreases.
This relative change of the attenuation factor is described by the Doppler factor.

\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/moving_source_field.png}
	\put(0,1){(a)}
	\put(48,1){(b)}
	\end{overpic}   
    \caption{Sound field, generated by a moving point source, oscillating at a source angular frequency $\omega_0 = 2\pi \cdot 1~\mathrm{krad/s}$ traveling along a straight source trajectory, described by $\vxs(t) = \posvec{3}{v \cdot t}{0}{0}$ with the velocity given by $v = \frac{c}{2} = 171.5~\mathrm{m/s}$.
    Figure (a) shows the real part of the radiated field and (b) shows the amplitude distribution in a logarithmic scale, demonstrating the result of the Doppler effect.
    In this special case of uniform motion the amplitude distribution is axially symmetric with the axis being perpendicular to the source trajectory.
    }
\label{fig:Moving_sources:moving_source_field}  
\end{figure}

Obviously, the evaluation of the radiated field emitted by a moving source is not straightforward: it requires the determination of the emission time or the propagation time-delay by solving \eqref{eq:moving_source:emission_time} or \eqref{eq:tau} respectively for each receiver position and time.
Analytical solutions for the general problem are barely available.
For the special case of a sound source under uniform motion, i.e. moving along a straight trajectory with a constant velocity the quadratic equations can be solved.
Assuming the source moving along the $x$-axis, i.e. the source position vector is given as $\vxs(t) = \posvec{3}{v \cdot t}{0}{0}$ the required quantities read as
\begin{equation}
\tau(\vx,t) = \frac{|\vx-\vxs(t_e(\vx,t))|}{c} = \frac{M (x-v t)+\Delta(\vx,t)}{c (1-M^2)},
\label{fig:Moving_sources:tau_uniform}  
\end{equation}
with $M = \frac{v}{c}$ being the time independent Mach number and
\begin{equation}
\Delta(\vx,t) = \sqrt{(x-vt)^2+(y^2+z^2)(1-M^2)}.
\label{fig:Moving_sources:delta_uniform}
\end{equation}
For sources moving inclined to the $x$-axis the corresponding quantities can be obtained by a rotation of the coordinate system as dsicussed in Appendix \ref{App:Moving_source_representations} \cite{firtha2015sound, firtha2016wave, Ahrens2015:web}.

\subsection{Time-frequency domain description}
In order to extend the asymptotic/local attributes---introduced for steady state sound fields---for the dynamic scenario next a mixed time-frequency representation of moving sources is investigated.
Assume a moving source with a harmonic excitation time dependence given by $s(t) = \te^{\ti \omega_0 t}$, oscillating at the angular frequency $\omega_0$.
The radiated field reads as
\begin{equation}
P_{\mathrm{m}}(\vx,t,\omega_0) = \frac{1}{4\pi}\frac{\te^{\ti \omega_0\left( t - \tau( \vx,t )\right)}}{\Delta(\vx,t-\tau( \vx, t ))}.
\label{eq:harmonic_moving_source_field}
\end{equation}

An arbitrary non-stationary sound field can be written in a general polar form $P_{\mathrm{m}}(\vx,t,\omega_0) = A^P(\vx,t,\omega_0) \te^{\ti \phi^P(\vx,t,\omega_0)}$, with $A^P(\vx,t,\omega_0),\phi^P(\vx,t,\omega_0) \in \mathbb{R}$.
For such a harmonic field the local wavenumber vector can be defined in the same manner as for a stationary sound field being the negative phase gradient
\begin{equation}
\label{eq:HF_appr:general_loc_wn}
\vk^P(\vx,t) = [k_x^P(\vx,t),\ k_y^P(\vx,t),\ k_z^P(\vx,t)]^{\mathrm{T}} = -\Dx \phi^P(\vx,t,\omega_0).
\end{equation}
This vector is perpendicular to the isophase surfaces, i.e. to the wavefront at an arbitrary position and time instant.
Since in the present thesis only isotropic medium are considered, the local wavenumber vector points into the local propagation direction of the wavefront.
For the case of a moving point source the local wavenumber vector is given by the phase gradient of \eqref{eq:harmonic_moving_source_field} reading
\begin{equation}
\label{eq:HF_appr:moving_s_loc_wn}
\vk^P(\vx,t) = -\Dx \phi^P(\vx,t,\omega_0) = \frac{\omega_0}{c} \frac{\vx -\vxs(t-\tau(\vx,t))}{\Delta(t-\tau(\vx,t))}.
\end{equation}

The local dispersion relation (or the eikonal equation) and the attenuation over the propagation path (or the transport equation) for a non-stationary sound field can be obtained by substituting the general polar form into the time domain wave equation \eqref{Eq:Theory:Scalar_wave_equation} and expanding the differential operators.
Setting the real and imaginary parts to zero results in the equations
\begin{eqnarray}
\frac{\Lx A^P}{A^P}  - | \Dx \phi^P |^2 -\frac{1}{c^2} \frac{A^{P''}_{tt}}{A^P} +\frac{1}{c^2}|\phi^{P'}_{t}|^2 = 0, \\ 
\label{eq:HF_appr:transport_eq_non_stat}
\Lx \phi^P + 2\frac{ \left< \Dx \phi^P \cdot \Dx A^P \right> }{A^P} - \frac{1}{c^2} \phi^{P''}_{tt} - \frac{1}{c^2} 2\frac{A^{P'}_t \phi^{P'}_t }{A^P} = 0.
\end{eqnarray}
Obviously, for a moving point source the above equations have to be singular at the source position, following \eqref{Eq:Theory:Green_function_def}.
Assuming high-frequency conditions the local dispersion relation results in
\begin{equation} \label{eq:HF_appr:eikonal_eq_non_stat}
| \Dx \phi^P |^2 = k_x^P(\vx,t)^2 + k_y^P(\vx,t)^2 + k_z^P(\vx,t)^2 \approx \frac{1}{c^2}|\phi^{P'}_{t}|^2,
\end{equation}
holding with equality for a point source under motion excluding the moving singularity.
Obviously, unlike for the stationary case, the length of the local wavenumber vector is not constant, but depends on both the receiver position and time, therefore the wavefront is not described by a normal form, as for the stationary case.
%Hence, the principal curvatures of the 

The temporal derivative of the phase function can be recognized as the generalization of the perceived angular frequency at a fixed receiver position \cite{Morse1968}.
For the case of a moving virtual point source the perceived frequency can be expressed as 
\begin{equation}
\label{eq:HF_appr:moving_s_per_freq}
\frac{\partial}{\partial t}\phi^P(\vx,t) =  \omega(\vx,t) = \omega_0  \frac{|\vx-\vxs(t-\tau(\vx,t))|}{\Delta(\vx,t-\tau(\vx,t))} = \frac{  \omega_0  }{1 - M(t) \cos \vartheta(\vx,t) }.
\end{equation}
This expression is the general Doppler formula, describing the relative frequency shift in case of a harmonic source signal \cite{Morse1968}. 
Thus both the perceived frequency and amplitude of the source is altered, with the alteration described by the Doppler factor.

The local dispersion relation \eqref{eq:HF_appr:eikonal_eq_non_stat} therefore states that the local wavenumber vector is perpendicular to the wavefront with the length being proportional to the local perceived angular frequency.
Hence, the normalized local wavenumber vector, defined as being a unit vector pointing to the local propagation direction can be generalized as
\begin{equation}
\label{eq:Moving_source:local_wn_general}
\hat{\vk}^P(\vx,t) = -\frac{\Dx \phi^P(\vx,t)}{\frac{1}{c}\frac{\partial}{\partial t} \phi^P(\vx,t)}  = \frac{\vk^P(\vx,t)}{ \omega(\vx,t)/c }.
\end{equation}
For the moving point source the normalized local wavenumber vector is given from \eqref{eq:HF_appr:moving_s_loc_wn} and \eqref{eq:HF_appr:moving_s_per_freq} as
\begin{equation}
\label{eq:Moving_source:norm_local_wn_moving_source}
\hat{\vk}^P(\vx,t) = \frac{\vx -\vxs(t-\tau(\vx,t))}{|\vx-\vxs(t-\tau(\vx,t))|},
\end{equation}
reflecting the fact that a moving point source radiates spherical wavefronts with the center being the source position at the emission time instant.
\begin{figure} 
	\small
    \begin{minipage}[c]{0.6\textwidth}
    \hspace{0cm}
	\begin{overpic}[width = 1.0\columnwidth ]{Figures/Moving_sources/moving_source_local_wave.png}
	\small
	\end{overpic} 
	\end{minipage}
	\hspace{10mm}
	\begin{minipage}[c]{0.35\textwidth}
    \caption{
	Illustration of the wavefronts and the local wavenumber vector of a moving sound source.
	The figure illustrates the local wavenumber vector on an isophase surface, with the source position at the corresponding emission time denoted by black dot.
	The generated wavefronts are spherical ones, with the local wavenumber vector being radial.
	The length of the local wavenumber vector is defined the instantaneous perceived angular frequency, described by the Doppler factor.}
	\label{Fig:Moving_source:moving_source_local_wn}
	\end{minipage}
\end{figure}  

Finally, in the non-stationary case the transport equation \eqref{eq:HF_appr:transport_eq_non_stat} describes, how the amplitude of a wavefront element changes over its propagation path:
\begin{equation}
\frac{ \left< \hat{\vk}^P \cdot \Dx A^P \right>+\frac{1}{c} A^{P'}_t }{A^P}  = \frac{1}{2} \frac{ \Lx \phi^P - \frac{1}{c^2} \phi^{P''}_{tt} }{\frac{1}{c}\phi^{P'}_t}
\end{equation}
The left handside of the equation describes the relative amplitude change of the radiated field, moving along the propagation path with the wavefront at the propagation speed of the sound, given by the rate of change of the amplitude factor with respect to a change $\td x$ in the receiver position into the direction of $\hat{\vk}$ and a change $\frac{\td x}{c}$ in the receiving time.
The right handside of the equation can be recognized as the general local mean curvature of the wavefront \cite[4.2]{Goldman2005}\footnote{As given in \cite{Goldman2005} the mean curvature of a general implicit surface $F$ is given by 
$\overline{\kappa}^F(\vx) = \frac{1}{2}\frac{\Dx F^{\mathrm{T}} H^F \Dx F - |\Dx F|^2 \Lx F }{|\Dx F|^3}$. In the present case also $\frac{1}{c^2} \phi^{P''}_{tt} = \frac{\Dx \phi^{\mathrm{T}} H(\phi) \Dx \phi}{|\Dx \phi|^2}$ holds.}, thus
\begin{multline}
\overline{\kappa}^P(\vx,t) = -\frac{1}{2}\Dx \cdot \hat{\vk}^P(\vx,t)= \\
-\frac{ \left< \hat{\vk}^P \cdot \Dx A^P \right>+\frac{1}{c} A^{P'}_t }{A^P} = -\frac{1}{2} \left( \frac{ \Lx \phi^P  }{ \omega(\vx,t)/c } - \frac{ \hat{\vk}^P(\vx,t)^{\mathrm{T}} H(\phi) \hat{\vk}^P(\vx,t) }{ \omega(\vx,t)/c } \right)
\label{Eq:Moving_source:attenuation}
\end{multline}
holds.
As a result therefore, similarly to the stationary case the relative attenuation of the wavefront during the propagation is given by the local mean curvature of the wavefront.
Obviously, for a moving point source the mean curvature is that of a spherical wavefront being also equal to the principal curvatures, given as
\begin{equation}
\overline{\kappa}^P(\vx,t) = \kappa^P_{1/2}(\vx,t) = \frac{1}{|\vx-\vxs(t-\tau(\vx,t))|}.
\label{Eq:Moving_source:attenuation_2}
\end{equation}
This result reflects that although the spatial distribution of the amplitude factor is altered according to the Doppler factor, the attenuation of the individual wavefronts over the propagation path is inversely proportional to the distance from the source position at the emission time instant.

\section{Wave Field Synthesis of moving sources}
\label{Sec:Moving_source_WFS}

So far only boundary integral formulations of steady state sound fields were discussed entirely in the frequency domain.
In order to synthesize the temporally varying sound field of a moving point source by using implicit SFS methodology an appropriate time domain boundary integral representation of arbitrary sound fields is required.
%It can be obtained by the temporal inverse Fourier transform of the corresponding spectral integrals:

Assume a source-free volume inside an enclosure $\Oi$, bounded by the surface $\dO$.
Any sound field obeying the homogeneous time domain wave equation inside the enclosure can be expressed by the \emph{time domain Kirchhoff-Helmholtz integral equation}.
The formulation is obtained by the direct inverse Fourier transform of the spectral KHIE \eqref{Eq:Theory:Kirchhoff-Helmholtz} by exploiting the Fourier convolution theorem, reading
\begin{equation}
\small
p(\vx,t) = \oint_{\dO} \int_{t_0} p(\vxo,t_0) \frac{\partial}{\partial \vni} g(\vx - \vxo, t - t_0) - \frac{\partial}{\partial \vni}  p(\vxo,t_0) g(\vx - \vxo, t - t_0) \td t_0 \td \dO(\vxo),
\end{equation}
with $\vx \in \Oi$.	

Assuming convex boundaries and high frequency conditions---i.e. source time histories with dominant high frequency content---the tangent plane approximation holds and the above integral can be approximated by the \emph{time domain Kirchhoff approximation}
\begin{equation}
\label{eq:theory:KA_td}
p(\vx,t) \approx -2 \oint_{\dO} \int_{t_0} w(\vxo,t_0) \frac{\partial}{\partial \vni}  p(\vxo,t_0) g(\vx - \vxo, t - t_0) \td t_0 \td \dO(\vxo),
\end{equation}
obtained by the direct inverse Fourier transform of equation \eqref{Eq:SFS_theory:Kirchhoff_appr}.
The time domain approximation describes an arbitrary sound field in terms of a spatio-temporal convolution over the boundary surface.
The convolution kernel/wave propagator is the time domain Green's function, describing the spatio-temporal impulse response of a point source on the boundary, emitting an impulse at $t_0$.
The time dependent windowing function can be defined by assuming a harmonic time dependency, for which the local wavenumber vector is defined as \eqref{eq:HF_appr:general_loc_wn}.
The windowing function is then given as
\begin{equation}
w(\vxo,t_0) = \begin{cases}
                        1, \hspace{3mm} \forall \hspace{3mm} \langle \vk^P(\vxo,t_0) \cdot \vni(\vxo) \rangle > 0 \\
                        0  \hspace{3mm} \text{elsewhere},
                    \end{cases}
\label{eq:theory:windowing_function}
\end{equation}
as a straightforward generalization of the stationary case.

Similarly for the stationary case, for the special geometry of the boundary being an infinite plane the Kirchhoff approximation degenerates to the time domain Rayleigh integral, describing the an arbitrary pressure field in front of the Rayleigh plane without an approximations involved.

\subsection{3D Wave Field Synthesis of a moving point source}

Assume the general sound field synthesis problem formulation in the time domain, taken as the inverse Fourier transform of the single layer potential \eqref{Eq:Theory:3D_SFS}
\begin{equation}
p(\vx,t) = \oint_{\dO} \int_{t_0} d(\vxo,t_0) g(\vx - \vxo , t-t_0 ) \td t_0 \, \td \dO ( \vxo ).
\label{eq:moving_source:SFS_problem_td}
\end{equation}

Comparison with \eqref{eq:theory:KA_td} reveals that similarly to the stationary, harmonic case the time domain Kirchhoff approximation implicitly contains the required time domain driving signals, reading
\begin{equation}
\label{eq:moving_source:3D_wfs_driv_fun_td}
d(\vxo,t_0) =  -2 w(\vxo,t_0) \frac{\partial}{\partial \vni}  p(\vxo,t_0).
\end{equation}
By assuming a harmonic source time dependency the high frequency gradient approximation can be applied for a non-stationary sound field, reading
\begin{equation}
\Dx P(\vx,t,\omega_0) \approx - \ti \vk^P(\vx,t) P(\vx,t,\omega_0),
\label{eq:moving_source:gradient_appr_nonstat}
\end{equation}
which is again, a local plane wave approximation.
The 3D WFS driving function can be approximated then by
\begin{equation}
\label{eq:moving_source:3D_wfs_driv_fun}
D(\vxo,t_0,\omega_0) =  2 w(\vxo,t_0) \ti k_{\mathrm{n}}^P(\vxo,t_0) P(\vxo,t_0,\omega_0).
\end{equation}
	
\begin{figure}  
\small
  \begin{minipage}[c]{0.64\textwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/3D_WFS2.png}
	\small
	\put(2,53){(a)}
	\put(2,1){(b)}
	\end{overpic}   \end{minipage}\hfill
	\begin{minipage}[c]{0.35\textwidth}
    \caption{3D synthesis of a moving 3D point source radiating at $\omega_0 = 2\pi \cdot 1.5 \mathrm{krad}/s$.
    The source is under uniform motion with the source trajectory given by $\vxs = \posvec{3}{1.85+v_x \cdot t}{3.2+v_y \cdot t}{0}$ with $|\mathbf{v}| = 150~\mathrm{m/s}$ and $\vx = 140~\mathrm{m/s}, v_y = 98~\mathrm{m/s}$.  
    The snapshot is taken at $t = 0~\mathrm{s}$. 
    The SSD surface is chosen to be independent of the $z$-coordinate as illustrated in \ref{fig:SFS_theory:WFS_geometry}.
    Figure (a) depicts the real part of the synthesized field and part (b) presents the absolute error of synthesis (the discrepancy between the synthesized and the target sound field) in a logarithmic scale measured in the horizontal plane, containing the virtual point source.
	The active arc of the SSD \emph{at the time instant $t = 0~\mathrm{s}$} is denoted by solid black line, and the inactive part with dotted by black line.
    }
\label{fig:SFS_theory:3D_WFS_moving_source}  \end{minipage}
\end{figure}
%
Since the sound field, generated by a moving point source satisfies the homogeneous wave equation inside the listening volume, therefore it can be described by the Kirchhoff integral, and its sound field can be reproduced by applying the driving functions above.
Assuming a point source, moving along an arbitrary trajectory $\vxs(t) = \posvec{3}{x(t)}{y(t)}{z(t)}$, with $\vxs(t) \notin \Oi$, where $\Oi$ is the listening volume, bounded by a convex surface of secondary point sources $\dO(\vxo)$.
Assuming a harmonic source excitation with the angular frequency being $\omega_0$ the driving functions for the synthesis of the virtual source inside the volume is obtained from \eqref{eq:moving_source:3D_wfs_driv_fun} by substituting the pressure field and the local wavenumber vector of a moving point source, given by \eqref{eq:harmonic_moving_source_field} and \eqref{eq:HF_appr:moving_s_loc_wn} respectively.
The resulting driving function reads as
\begin{equation}
D(\vxo,t_0,\omega_0) =  w(\vxo,t_0) 
\frac{\ti k_0}{2\pi} \frac{\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni(\vxo) \right>}{\Delta(t_0-\tau(\vxo,t_0))}
\frac{\te^{\ti \omega_0\left( t_0 - \tau( \vx,t_0 )\right)}}{\Delta(\vx,t_0-\tau( \vxo, t_0 ))},
\end{equation}
with $k_0 = \frac{\omega_0}{c}$, the amplitude factor given as
\begin{equation}
\Delta( \vxo,t_0 ) = |\vx - \vxs(t_0)| - \left<\, \frac{1}{c}\vvs(t_0) \cdot (\vx - \vxs(t_0)) \right> 
\end{equation}
and $\tau(\vxo,t_0)$ satisfying
\begin{equation}
\tau(\vxo,t_0) =  \frac{| \vx - \vxs( t_0 - \tau(\vxo,t_0)) |  }{c}.
\end{equation}
For moving sources with a wideband excitation signal with the frequency content $S(\omega) = \int_{-\infty}^{\infty} s(t) \te^{-\ti \omega t} \td t$, the driving functions are yielded by the weighted sum of the individual spectral components
\begin{equation}
d(\vxo,t_0) =  w(\vxo,t_0)  
\frac{\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni(\vxo) \right>}{\Delta(t_0-\tau(\vxo,t_0))^2}
\int_{-\infty}^{\infty} \frac{\ti \omega_0}{2\pi c} S(\omega_0 )\te^{\ti \omega_0\left( t_0 - \tau( \vx,t_0 )\right)} \td \omega_0,
\end{equation}
describing a temporal inverse Fourier transform, taken at $t_0 - \tau( \vx,t_0 )$.
By realizing that multiplication by $\ti \omega_0$ performs the temporal differentiation of the input signal the time domain driving function takes the form
\begin{equation}
d(\vxo,t_0) =   
\frac{\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni(\vxo) \right>}{\Delta(t_0-\tau(\vxo,t_0))}
\frac{w(\vxo,t_0)}{2\pi c} \frac{s'_t( t_0 - \tau( \vx,t_0 ) )}{\Delta(t_0-\tau(\vxo,t_0))}
\end{equation}.	
Comparison with \eqref{Eq:SFS_theory:3D_WFS_ps_driv_fun} and \eqref{Eq:SFS_theory:3D_WFS_ps_driv_fun_td} indicates that the moving sources driving functions coincide with that for a stationary point source with the static distances/attenuation factors replaced with the dynamic ones.
Obviously, the same result can be obtained by the direct substitution of a moving point source's pressure field into \eqref{eq:moving_source:3D_wfs_driv_fun_td} with taking only the dominant part into consideration.

As a simple example Figure \ref{fig:SFS_theory:3D_WFS_moving_source} shows the result of the synthesis of a point source under uniform motion.
For the sake of computational simplicity the SSD is chosen to be invariant along the $z$-dimension as it was illustrated in \ref{fig:SFS_theory:WFS_geometry}.
As presented in the previous section for sources under uniform motion the propagation time delay and the amplitude distribution can be expressed analytically, given by \eqref{fig:Moving_sources:tau_uniform} and \eqref{fig:Moving_sources:delta_uniform} respectively.
Similarly to the stationary case the driving functions ensure amplitude correct synthesis over most part of the listening are within the validity of the Kirchhoff approximation.
Apart from the errors discussed for the case of the synthesis of a stationary point source---illustrated in Figure \ref{fig:SFS_theory:3D_WFS_moving_source}---, here amplitude and slight phase errors arise as the source approaches the SSD surface and the high frequency/far field gradient approximation does not hold.

\subsection{The 2.5D Kirchhoff approximation for moving sources}

In order to reproduce the sound field of a moving source by applying a contour of secondary sources an appropriate 2.5D integral representation is required.
The dimensionality reduction is again done by the stationary phase approximation of the Kirchhoff integral, resulting in the \emph{2.5D Kirchhoff integral for moving sources}.

Assume a 3D volume, bounded by a surface for the sake of simplicity being invariant along the vertical dimension, illustrated in Figure \ref{fig:SFS_theory:3D_WFS_moving_source}.
An arbitrary non-stationary sound sound field inside the enclosure can be described by the time domain Kirchhoff integral---given by \eqref{eq:theory:KA_td}---which in this special geometry written with separated integral variables.
With a harmonic time dependency the radiated field inside the enclosure reads as
\begin{equation}
\small
P(\vx,t,\omega_0) = 
\oint_{C} \int_{z_0} \int_{t_0}
2 w(\vxo,t_0) \ti k_{\mathrm{n}}^P(\vxo,t_0) 	
P(\vxo,t_0,\omega_0) g(\vx-\vxo,t-t_0) \, \td t_0 \, \td z_0 \, \td s(x_0, y_0),
\label{Eq:SFS_theory:Kirchhoff_spec_geom_td}
\end{equation}
with the integral variable $\td s$ being the arc length along the contour.
%

Applying the explicit formula for the time domain 3D Green's function ($g(\vx-\vxo,t-t_0) = \frac{1}{4\pi} \frac{\delta(t-t_0-|\vx-\vxo|/c)}{|\vx-\vxo|}$) integration with respect to the emission time on the boundary $t_0$ can be evaluated by exploiting the Dirac delta sifting property, and the radiated field is given as
\begin{equation}
\small
P(\vx,t,\omega_0) = \frac{1}{2\pi}
\oint_{C} \int_{z_0}  
 w(\vxo,t-  \Tret ) \ti k_{\mathrm{n}}^P(\vxo,t-\Tret) 	
\frac{P(\vxo,t-\Tret,\omega_0) }{|\vx-\vxo|}\,\td z_0 \, \td s(x_0, y_0).
\label{Eq:SFS_theory:Kirchhoff_spec_geom_td_2}
\end{equation}
In order to arrive to a contour integral formulation this integral is approximated by the stationary phase method along the vertical dimension.
\begin{figure}  
\small
  \begin{minipage}[c]{0.60\textwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/25D_moving_source_b.png}
	\small
	\put(85,47.5){$x$}
	\put(93.5,32){$y$}
	\put(96,60){$z$}
	\put(63,33.5){$\vx$}
	\put(75,41.5){$\vxo$}
	\put(11.5,25){$\vxs(t)$}
	\put(26,27){$\vvs(t)$}
%	\put(7,22){plane of interest}
	\put(50,8){$\dO$: 3D surface}
	\put(51,24.5){$C$: 2.5D contour}
	\end{overpic}  \end{minipage}\hfill
	\begin{minipage}[c]{0.34\textwidth}
    \caption{
    Geometry for the derivation of 2.5D Kirchhoff integral.
The enclosing surface $\dO(x_0,y_0)$ is chosen to be independent of the $z$-coordinate in order to be able to evaluate the Kirchhoff integral with respect to $z_0$ using the SPA. 
If the sound field to be described is a 2D one propagating in the direction parallel to the listening plane, then the surface can be interpreted as a continuous set of infinite vertical line sources along $C$, capable of the perfect description of a 2D field inside the enclosure by a 2D countour integral.}
\label{fig:SFS_theory:3D_WFS_moving_source}  \end{minipage}
\end{figure}

Generally speaking, the stationary point of the integral is found, where the gradient of the integrand's phase function is vanishes, satisfying equation
\begin{equation}
\left. \Dxo \phi^P(\vxo,t-\Tret,\omega_0) \right|_{\vxo = \vxo^*(\vx,t)} = 0.
\end{equation} 
The gradient can be evaluated by taking the total derivative of the phase function, which after rearrangement yields
\begin{equation}
\frac{\Dxo \phi^P(\vxo^*(\vx,t),t-\TretS,\omega_0) }{\frac{1}{c}\frac{\partial }{\partial t}\phi^P(\vxo^*(\vx,t),t-\TretS,\omega_0) } = - \frac{\vx-\vxo^*(\vx,t)}{|\vx-\vxo^*(\vx,t)|}.
\end{equation}
The left handside describes the normalized local wavenumber vector of the general sound field $P$ \emph{taken at the time the instant $t-\Tret$} (c.f. \eqref{eq:Moving_source:local_wn_general}), while the right term is recognized as the normalized local wavenumber of the Green's function. 
The stationary position for the Kirchhoff integral is thus found where
\begin{equation}
\label{Eq:moving_sources:moving_point_stat_point_1}
\hat{\vk}^P(\vxo^*(\vx,t),t-\TretS) = \hat{\vk}^G(\vx-\vxo^*(\vx,t))
\end{equation}
is satisfied.
As a generalization of the results presented in Section \ref{Sec:HS_approx:SPA_for_Rayleigh}, the equation states the following:
Given the Kirchhoff integral, representing an arbitrary primary sound field at the receiver position $\vx$ as the sum of the individual spherical waves of a continuous distribution of point sources along the boundary.
For the integral the stationary/dominant secondary point source position $\vxo^*$ is found, that's spherical wavefront's propagation direction measured at $\vx,t$, generated at $\vxo^*, t-\TretS$ coincides with that of the primary wavefront measured on the boundary at $\vxo^*, t-\TretS$.
Obviously---since after the time instant $t-\TretS$ the secondary and primary wavefronts ,,propagate together'' along the common propagation direction---this requirement ensures, that the stationary boundary element's wavefront and the primary wavefront match at the receiver position $\vx$ at the receiving time instant $t$, thus 
\begin{equation}
\hat{\vk}^P(\vx,t) = \hat{\vk}^G(\vx-\vxo^*(\vx,t))
\end{equation}
also holds.
%
\begin{figure}
\small
  \begin{minipage}[c]{0.58\textwidth}
	\begin{overpic}[width = \textwidth ]{Figures/Moving_sources/KI_stat_point.png}
	\small
	\put(96,30){$x$}
	\put(15,80){$y$}
	\put(73,59){$\vx$}
    \put(45.5,30){$\vxo^*(\vx,t)$}
    \put(60,8.5){$\vxs(t)$}
    \put(41,8.5){$\vxs(t_0)$}
    \put(24.5,8.5){$\vxs(t_e)$}
	\put(58,41){$\vk^P(\vxo^*,t_0)$}
	\put(60,72){$\vk^G(\vx - \vxo^*)$}
	\end{overpic}  \end{minipage}\hfill
	\begin{minipage}[c]{0.4\textwidth} \hspace{2mm}
    \caption{
       Illustration of the stationary position for the boundary integral representation of the field of a moving source.
       The snapshot is taken at time instant $t$.
       The source position is indicated at three time instants: at the receiver time $t$, the boundary emission time $t_0 = t - \TretS$ and the source emission time $t_e = t - \TretS - \tau(\vxo^*,t_0)$.
       The stationary position for $\vx$ at time instant $t$ is found, so that the spherical wavefront generated by the moving source at $t_e$ coincides at $\vx,t$ with the spherical wavefront of the stationary point source generated at $t_0$.
       } 
       \label{Fig:Moving_sources:KI_stat_point}
  \end{minipage}
\end{figure}

This result is illustrated in Figure \ref{Fig:Moving_sources:KI_stat_point} via the example of the stationary point for the field of a moving point source.
For this case the normalized local wavenumber vector is given by \eqref{eq:Moving_source:norm_local_wn_moving_source} and the stationary position $\vxo^*$ is found by denoting $t_0 = t-\Tret$ where 
\begin{equation}
\label{Eq:Moving_sources:moving_source_stat_point}
\frac{\vxo^* -\vxs(t_0-\tau(\vxo^*,t_0))}{|\vxo^*-\vxs(t_0 - \tau(\vxo^*,t_0))|} =  \frac{\vx-\vxo^*}{|\vx-\vxo^*|}
\end{equation}
is satisfied.
This means that the stationary point is given, where the local propagation direction of the spherical wavefront generated by the moving source at $t_0-\tau(\vxo^*,t_0)$, measured on the boundary at $t_0$ coincides with that of the spherical wavefront of the stationary point source, measured at position $\vx$.
Geometrically this point lies at the intersection of the boundary and the vector pointing from the moving point source at the emission time to the receiver position.

Having found the general stationary point for the Kirchhoff integral for a moving source the vertical integration can be approximated by the SPA.
Obviously, a contour integral may describe a sound field at the plane of investigation again, chosen to be $\vx = \posvec{3}{x}{y}{0} \in \Omega$ implicitly fixing the vertical stationary position to lie independently from the receiver time at $z_0^*(\vx,t) \rightarrow z_0^* = 0$.
By the definition of the stationary point for moving sources \eqref{Eq:Moving_sources:moving_source_stat_point} this requirement is trivially satisfied by sound sources moving along trajectories fixed to the plane of investigation, therefore in the followings only in plane source trajectories are considered, described by $\vxs(t) = \posvec{3}{x_s(t)}{y_s(t)}{0}$.

In order to evaluate the vertical integral the second phase derivative of the integrand \eqref{Eq:SFS_theory:Kirchhoff_spec_geom_td_2} is required around the vertical stationary point.
With the source trajectory and the receiver position fixed to the plane of investigation $z = 0$ the second phase derivative around the stationary point simplifies to terms of the source-boundary and boundary-receiver point distances, reading
\begin{equation}
\label{Eq:Moving_sources:MS_second_phase_der}
\small
\left. \frac{\partial^2 }{\partial z_0^2 }\phi^P(\vxo,t-\Tret,\omega_0) \right|_{z_0 = z_0^* = 0} = 
- \frac{\omega(\vxo,t_0)}{c}\left( \frac{1}{|\vxo^* - \vxs(t_e)|} + \frac{1}{|\vx-\vxo^*|} \right),
\end{equation} 
with $t_0 = t - \Tret$ the boundary emission time, $t_e = t - \Tret - \tau(\vxo,t_0)$ is the source emission time and $\omega(\vxo,t_0)$ is the perceived angular frequency given by \eqref{eq:HF_appr:moving_s_per_freq} along the boundary surface, in the stationary point.
Similarly to the stationary case (c.f. \eqref{Eq:SFS_theory:Curvatures_Addition}), the second phase derivative is given by the sum of the vertical curvatures of the primary sound field and the Green's function measured on the boundary.

Finally---by taking the negative sign of \eqref{Eq:Moving_sources:MS_second_phase_der} into consideration---the stationary phase approximation of integral \eqref{Eq:SFS_theory:Kirchhoff_spec_geom_td_2} yields the \emph{2.5D Kirchhoff integral for a moving source} is yielded
\begin{multline}
P(\vx,t,\omega_0) =
\small
\oint_{C} 2 w(\vxo,t_0 ) 
\sqrt{\frac{2\pi}{\ti\frac{\omega(\vxo,t_0)}{c}}}
\sqrt{\frac{|\vx-\vxo||\vxo - \vxs(t_e)|}{|\vx-\vxo|+|\vxo - \vxs(t_e)|}} \cdot \\ \cdot
 \ti k_{\mathrm{n}}^P(\vxo,t_0)  	
\frac{1}{4\pi}
\frac{P(\vxo,t_0,\omega_0) }{|\vx-\vxo|}\, \td s(x_0, y_0),
\label{Eq:SFS_theory:25D_KI_moving_source}
\end{multline}
with both $\vx = \posvec{3}{x}{y}{0}$ and $\vxo = \posvec{3}{x_0}{y_0}{0}$ now denoting in-plane positions.

\subsection{2.5D Wave Field Synthesis of a moving point source}

In order to extract the implicit driving functions from the Kirchhoff integral it is exploited, that all the time variables are present in \eqref{Eq:SFS_theory:25D_KI_moving_source} with a constant temporal shift $t-\Tret$.
The integral therefore can be reformulated in terms of a temporal convolution with the 3D time domain Green's function as
\begin{multline}
P(\vx,t,\omega_0) =
\small
\oint_{C}  \int_{t_0} 2 
\sqrt{\frac{2\pi}{\ti\frac{\omega(\vxo,t_0)}{c}}}
\sqrt{\frac{|\vx-\vxo||\vxo - \vxs(t_0-\tau(\vxo,t_0))|}{|\vx-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}} \cdot \\ \cdot
 \ti k_{\mathrm{n}}^P(\vxo,t_0) P(\vxo,t_0,\omega_0)
\underbrace{\frac{1}{4\pi} \frac{ \delta(t-t_0- \Tret) }{|\vx-\vxo|}}_{g(\vx-\vxo,t-t_0)}
\, \td t_0 \, \td s(x_0, y_0).
\label{Eq:SFS_theory:25D_KI_moving_source_2}
\end{multline}
Comparison with the time domain SFS problem \eqref{eq:moving_source:SFS_problem_td} reveals that this formulation implicitly contains the time domain 2.5D Wave Field Synthesis driving functions for a harmonic moving source, being dependent on the receiver position.
The dependency may be resolved by exploiting, that the contour integral is dominated by its horizontal stationary point, defined by \eqref{Eq:Moving_sources:moving_source_stat_point}, therefore the amplitude correction factor can be substituted by its stationary value $\vxo \rightarrow \vxo^*(\vx)$.
Furthermore, the role of the stationary SSD position and the receiver position may be interchanged by letting the SSD position $\vxo$ the independent variable, resulting in SSD position dependent receiver points, termed as reference position $\vxo^*(\vx) \leftrightarrow \vxref(\vxo)$.
The extracted driving function the reads as
\begin{multline}
D(\vxo,t_0,\omega_0) =
\underbrace{ \sqrt{\frac{2\pi |\vxref(\vxo,t_0)-\vxo|}{\ti\frac{\omega(\vxo,t_0)}{c}}}}_{{\substack{\text{SSD}\\\text{compensation}}}}
\underbrace{\sqrt{\frac{|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}}_{{\substack{\text{virtual source}\\\text{compensation}}}} 
\cdot \\ \cdot
\underbrace{2 w(\vxo,t_0) \ti k_{\mathrm{n}}^P(\vxo,t_0) P(\vxo,t_0,\omega_0)}_{\substack{\text{2D}\\\text{driving function}}},
\label{Eq:SFS_theory:25D_KI_moving_source}
\end{multline}
with $\tau(\vxo,t_0)$ being the propagation time delay from the moving source position at the emission time to the actual SSD position, having to be evaluated for each SSD position at each time instant.
The reference position and the SSD position are connected by \eqref{Eq:moving_sources:moving_point_stat_point_1}, reading as
\begin{align}
\label{Eq:SFS_theory:25D_WFS_ref_point}
\hat{\vk}^P(\vxo,t_0) &= \hat{\vk}^G(\vxref(\vxo,t_0)-\vxo)
\\
\frac{\vxo -\vxs(t_0-\tau(\vxo,t_0))}{|\vxo-\vxs(t_0 - \tau(\vxo,t_0))|} &=  \frac{\vxref(\vxo,t_0)-\vxo}{|\vxref(\vxo,t_0)-\vxo|}.
\end{align}

The driving functions above is a straightforward generalization of the 2.5D WFS driving functions \eqref{Eq:SFS_theory:25D_WFS_driv_fun_ver_2} towards non-stationary sound fields, consisting of the ideal 2D WFS driving function along with two dimensionality correction factor:
\begin{itemize}
\item The secondary source correction factor compensates for the attenuation factor and the frequency response of the 2D SSD contour.
Again, the attenuation correction can be optimized to a predefined distance for each SSD element, allowing the referencing of the synthesis on a prescribed reference curve.
The frequency correction term compensates for the half-integrator nature of 2D SSD, which along with the differentiation in the driving function would result in enhanced high-pass characteristics.
As a local/asymptotic approximation the correction is performed by the instantaneous perceived angular frequency altered by the Doppler shift, as measured along the SSD.
\item The virtual source correction factor corrects the synthesized field amplitude at the receiver position from a 2D to a 3D one.
As it was expressed by \eqref{Eq:Moving_source:attenuation} and \eqref{Eq:Moving_source:attenuation_2}---regardless of the instantaneous spatial distribution---a 3D wavefront attenuates inversely proportional to its mean curvature along its propagation path.
For the case of a moving point source the corresponding mean radius is obviously, the distance from the source at the emission time and the point of investigation.
Hence, the virtual source compensation factor matches the amplitude factor of the \emph{synthesized wavefront} to the \emph{target wavefront} (rather than the amplitude distribution) by taking the wavefront propagation dynamics into consideration.
\end{itemize}
Similarly to the stationary case, referencing the synthesis can be done by prescribing an arbitrary reference curve $\vxref$ being independent of time and expressing the SSD and virtual source compensation factors, so that the reference/stationary points for each SSD element $\vxref(\vxo,t_0)$ lie along the reference curve, and satisfy \eqref{Eq:SFS_theory:25D_WFS_ref_point}.
Obviously, in a general case due to the source motion the reference position for an arbitrary SSD element varies with time, thus $\vxref(\vxo,t_0)$ has to be found for each SSD element at each time instant.
This require the a-priori calculation of the moving source position at the emission time.
In a further section it is discussed, how these computational expensive problems can be solved numerically.
\begin{figure}  
\small
  \begin{minipage}[c]{0.64\textwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/25D_WFS_ms.png}
	\small
	\put(2,53){(a)}
	\put(2,1){(b)}
	\end{overpic}   \end{minipage}\hfill
	\begin{minipage}[c]{0.35\textwidth}
    \caption{2.5D synthesis of a moving 3D point source radiating at $\omega_0 = 2\pi \cdot 1.5 \mathrm{krad}/s$ applying an arbitrary shaped SSD.
    The source is under uniform motion with the source trajectory given by $\vxs = \posvec{3}{1.85+v_x \cdot t}{3.2+v_y \cdot t}{0}$ with $|\mathbf{v}| = 150~\mathrm{m/s}$ and $v_x = 140~\mathrm{m/s}, v_y = 98~\mathrm{m/s}$. 
    The synthesis is referenced on a concentric reference contour, denoted by white dots.
    The snapshot is taken at $t = 0~\mathrm{s}$. 
    Figure (a) depicts the real part of the synthesized field and part (b) presents the absolute error of synthesis in a logarithmic scale.
	The active arc of the SSD \emph{at the time instant $t = 0~\mathrm{s}$} is denoted by solid black line, and the inactive part with dotted by black line.
	In order to ensure smooth driving functions, the referencing function is extrapolated.
    }
\label{fig:SFS_theory:25D_WFS_moving_source}  \end{minipage}
\end{figure}

Once the source position and reference position has been found for each SSD element at each time instant the driving function on a single source frequency component \eqref{Eq:SFS_theory:25D_KI_moving_source} can be evaluated.
For a wideband excitation with the frequency content $S(\omega) = \int_{-\infty}^{\infty} s(t) \te^{-\ti \omega t} \td t$, the driving functions are obtained by the summing the individual spectral components.
The perceived frequency is expressed in terms the source angular frequency according to \eqref{eq:HF_appr:moving_s_per_freq}, resulting in the inverse Fourier integral
\begin{multline}
\small
d(\vxo,t_0,\omega_0) =2 w(\vxo,t_0) 
\sqrt{\frac{\Delta(\vxo,t_0-\tau(\vxo,t_0))}{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}
\cdot \\ \cdot
 \int_{-\infty}^{\infty} S(\omega_0)
\sqrt{\frac{2\pi |\vxref(\vxo,t_0)-\vxo|}{\ti \frac{\omega_0}{c} }}
\ti k_{\mathrm{n}}^P(\vxo,t_0) P(\vxo,t_0,\omega_0) \td \omega_0,
\end{multline}
Expressing both the moving source's pressure field and its local wavenumber vector explicitly results in the expression
\begin{multline}
\small
d(\vxo,t_0,\omega_0) = w(\vxo,t_0) 
\sqrt{\frac{|\vxref(\vxo,t_0)-\vxo| }{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}
\cdot \\ \cdot
\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni \right>
\int_{-\infty}^{\infty} S(\omega_0)
\sqrt{\frac{\ti \frac{\omega_0}{c}}{2\pi}}
\frac{\te^{\ti \omega_0\left( t_0 - \tau( \vxo,t_0 )\right)}}{\Delta(\vxo,t_0-\tau( \vxo, t_0 ))^{\frac{3}{2}}}
 \td \omega_0
\end{multline}
The integral can be recognized as the inverse Fourier transform of the pre-filtered source time history, taken at $t_0 - \tau( \vxo,t_0 )$.
Similarly to the stationary case the source signal is pre-equalized with a half-differentiator filter with the transfer function described by $H(\omega) = \sqrt{\ti \omega}$, compensating for the 2D SSD contour frequency response.
The time domain driving function for the synthesis of a moving point source with a wideband excitation signal reads as
\begin{multline}
\small
d(\vxo,t_0,\omega_0) = w(\vxo,t_0) 
\sqrt{\frac{|\vxref(\vxo,t_0)-\vxo| }{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}
\cdot \\ \cdot
\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni \right>
\sqrt{\frac{1}{2\pi c}}
\frac{ s^{\nshortmid}_t(t_0 - \tau( \vxo,t_0 )) }{\Delta(\vxo,t_0-\tau( \vxo, t_0 ))^{\frac{3}{2}}},
\end{multline}
where the prefiltered input signal is given by $ s^{\nshortmid}_t(t) = h(t) \ast_{t} s(t)$, with the pre-equalization filter's impulse response given by $h(t) = \mathcal{F}^{-1}_t\left\{ \sqrt{\ti \omega} \right\}$.
Note that unlike for the stationary case, here the order of pre-filtering and delaying of the excitation signal is not interchangeable due to the time-dependent propagation time delay.

The driving functions are capable of the synthesis of a source under motion, with an arbitrary source trajectory and velocity profile applying an arbitrary SSD contour, with ensuring optimized synthesis on an arbitrary shaped reference contour.
The synthesis in such a general scenario is depicted in Figure \ref{fig:SFS_theory:25D_WFS_moving_source}, illustrating the reproduction of a source, moving along a straight trajectory.
%The calculation of the general driving functions are however of a great computational complexity.
%In the following sections it will be discussed, how evaluation may be approximated allowing real-time implementation.
In case the parametrization of the SSD contour and the reference contour is available, along with an analytically known source trajectory, closed form analytical driving functions may be expressed, as discussed in the following example.

\subsection*{Application example: Synthesis of a uniformly moving source applying a linear SSD}

As a simple example the reproduction of an uniformly moving point source is investigated, applying a linear SSD and optimizing the synthesis on a reference line.
The importance of the example lies in the fact that for this geometry the analytical explicit solution is also known---presented in the following section---allowing the direct comparison of the implicit and explicit methodologies for this non-stationary scenario.

\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/25D_WFS_linear_SSD.png}
	\small
	\put(0, 0){(a)}
	\put(47,0){(b)}	
	\end{overpic}   
    \caption{2.5D synthesis of a moving 3D point source located at $\vxs(t) = \posvec{3}{1.5 + v\cdot t}{-2}{0}$ with $v = \frac{3}{4}c$, radiating at $\omega_0 = 2\pi \cdot 1 \mathrm{krad}/s$ with the reference line set at $y_{\mathrm{ref}} = 1.5~\mathrm{m}$.
    Figure (a) depicts the real part of the synthesized field, (b) shows the error of synthesis.
    }
\label{fig:Moving_sources:25D_WFS_linear_ssd}  
\end{figure}
For the sake of simplicity the source is chosen to move uniformly along the $x$-axis with a trajectory given by $\vxs = \posvec{3}{x_s + v\cdot t}{y_s}{0}$, oscillating at the angular frequency $\omega_0$.
The infinity linear SSD is located at $\vxo = \posvec{3}{x_0}{0}{0}$ and the reference line is set to $\vxref = \posvec{3}{x}{\yref}{0}$.
For this geometry the windowing function is identically $w(\vx,t_0) \equiv 1$ and the driving function from \eqref{Eq:SFS_theory:25D_KI_moving_source} reads as
\begin{equation}
\small
D(\vxo,t_0,\omega_0) =
\sqrt{\frac{8\pi }{\ti\frac{\omega_0}{c}}}
\underbrace{\sqrt{\frac{|\vxref(\vxo,t_0)-\vxo| \Delta(t_0-\tau(\vxo,t_0))}{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}}_{\dref(\vxo,t_0)}
\ti k_y^P(\vxo,t_0) P(\vxo,t_0,\omega_0).
\end{equation}
The reference distance $|\vxref(\vxo,t_0)-\vxo|$ can be expressed by the definition of the stationary position \eqref{Eq:SFS_theory:25D_WFS_ref_point} written merely for the $y$-coordinates
\begin{align}
\hat{\vk}^P(\vxo,t_0) &= \hat{\vk}^G(\vxref(\vxo,t_0)-\vxo)
\\
|\vxref(\vxo,t_0)-\vxo| &=  -\frac{\yref}{y_s(t_0-\tau(\vxo,t_0))}|\vxo-\vxs(t_0 - \tau(\vxo,t_0))|,
\end{align}
and the referencing function reads as
\begin{equation}
\dref(\vxo,t_0) = \sqrt{ \Delta(t_0-\tau(\vxo,t_0))\frac{ \yref }{\yref-y_s(t_0-\tau(\vxo,t_0))}}.
\end{equation}
Finally expressing the radiated field and its local wavenumber vector explicitly and exploiting that $y_s$ is constant yields the driving function
\begin{equation}
D(\vxo,t_0,\omega_0) = -
\sqrt{\frac{ \ti k_0}{2\pi} }
\sqrt{\frac{ \yref }{\yref-y_s}}
y_s
\frac{\te^{\ti \omega_0\left( t_0 - \tau( \vxo,t_0 )\right)}}{\Delta(\vxo,t_0)^{\frac{3}{2}}},
\label{Eq:Moving_sources:25D_WFS_linear_ssd}
\end{equation}
with $k_0 = \frac{\omega_0}{c}$, and the propagation time delay given explicitly, reading as
\begin{equation}
\tau(\vxo,t_0) = \frac{M (x_0 - v t_0 - x_s )+\Delta(\vxo,t_0)}{c (1-M^2)}, 
\end{equation}
with the amplitude distribution
\begin{equation}
\Delta(\vxo,t_0) = \sqrt{(x_0 - v t_0 - x_s)^2 + y_s^2(1-M^2)}.
\end{equation}
Obviously, the time domain driving function for a source excitation time history $s(t)$ is given by the inverse Fourier transform of \eqref{Eq:Moving_sources:25D_WFS_linear_ssd} with respect to $\omega_0$, reading 
\begin{equation}
d(\vxo,t_0) = -
\sqrt{\frac{ 1 }{2\pi c} }
\sqrt{\frac{ \yref }{\yref-y_s}}
y_s
\frac{s^{\nshortmid}_t(t_0 - \tau( \vxo,t_0 ))}{\Delta(\vxo,t_0)^{\frac{3}{2}}},
\label{Eq:Moving_sources:25D_WFS_linear_ssd_td}
\end{equation}
where $s^{\nshortmid}_t(t) = h(t) \ast_{t} s(t)$, with $h(t) = \mathcal{F}^{-1}_t\left\{ \sqrt{\ti \omega} \right\}$.

The result of synthesis is illustrated in Figure \eqref{fig:Moving_sources:25D_WFS_linear_ssd}, verifying that the presented driving function optimize the synthesis along the reference line.
Comparison with \eqref{eq:SFS_theory:WFS_point_source} reveals that the moving source driving function formally coincide with the traditional WFS driving functions given for a stationary point source \cite[(2.27)]{Verheijen1997:phd}, \cite[(3.16)\&(3.17)]{Start1997:phd} with the stationary distances, delays and amplitude factor changed for the corresponding dynamical variables.

The above driving functions can be easily extded for sources moving inclined to the SSD the driving function with the substitution of a space-time dependent source position $y_s \rightarrow y_s(t_0 - \tau(\vxo,t_0))$ as discussed in details in \cite{firtha2016wave}.
In this case however the moving source crosses the theoretically infinite SSD resulting in singular driving functions at the time instant of the crossing, and converging virtual wavefronts afterwards.
The synthesis of this type of focused moving sources is not investigated in the present thesis.

\section{Explicit solution for the synthesis of moving sources}

So far only the time domain and a mixed time-frequency domain representation of moving sources were discussed, applied directly for the Wave Field Synthesis of sources under motion.
For the special case of sources under uniform motion the frequency domain and wavenumber domain representation of the radiated sound field can be expressed analytically, by applying the Fourier theorem for a non-stationary convolution.

\subsection{Spectral representation  of moving sources}

Assume a harmonic source moving along a straight trajectory parallel on the $x$-axis, with the source position time history $\vxs(t) = \posvec{3}{x_s + v \cdot t}{0}{0}$ with a wide-band excitation time history $s(t)$.
According to \eqref{eq:moving_source:non_stat_convolution} the radiated field can be written in the form of a convolution with the kernel being the moving source Green's function
\begin{equation}
P_{\mathrm{m}}(\vx,t) = \int_{\tE} g_{\mathrm{m}}(x - x_s-v\cdot\tE ,y,z,t-\tE) s(\tE) \td \tE,
\end{equation}
with $t_e$ being the emission time and $g_{\mathrm{m}}$ representing the retarded Green's function.
Comparison with \eqref{Eq:App:Non_stat_conv_td} reveals that the radiated field is written in terms of a non-stationary convolution, for which the spectral representation is known, given by \eqref{Eq:App:Non_stat_conv_fd}.
By applying the Fourier shift theorem (by a factor of $x-x_s$) and the scaling theorem (by $v$) to \eqref{Eq:App:Non_stat_conv_fd} the spectrum of the radiated field is given by
\begin{equation}
P_{\mathrm{m}}(\mathbf{x},\omega) = \frac{1}{v} 
\int_{-\infty}^{\infty} S(\omega_0)
\tilde{G}(\frac{\omega-\omega_0}{v}, y, z, \omega)
\te^{-\ti \frac{\omega-\omega_0}{v} \left(x-x_s\right)} \td \omega_0.
\label{Eq:Moving_sources:Freq_domain_representation_wb_excit}
\end{equation}
Hence, the radiated field in the spectral domain is obtained by a non-stationary convolution as well.
Since summation is done over the frequency content of the source input signal $S(\omega_0)$, the non-stationary convolution kernel can be recognized as the frequency content of a moving source pass-by, radiating at a single frequency component $\omega_0$, given as
\begin{equation}
P_{\mathrm{m}}(\mathbf{x},\omega,\omega_0) =
\frac{1}{v}
\tilde{G}(\frac{\omega-\omega_0}{v}, y, z, \omega)
\te^{-\ti \frac{\omega-\omega_0}{v} \left(x-x_s\right)},
\label{Eq:Moving_sources:Freq_domain_representation}
\end{equation}
with the Green's function wavenumber content given in \ref{tab:theory:Greens_fun_representations} as
\begin{equation}
\tilde{G}(\frac{\omega-\omega_0}{v}, y, z, \omega) = -\frac{\ti}{4} H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2} y \right).
\end{equation}
The equation states that the frequency domain representation of a moving point source pass-by at a given receiver point is completely described by it's 1D spatio temporal spectrum $\tilde{G}(k_x,y,z,\omega)$ with the substitution $k_x \rightarrow \frac{\omega-\omega_0}{v}$.
In the present geometry the time history of the measured pass-by is invariant along the $x$-axis up to a constant time delay depending on the source velocity.
This fact is represented by the fact that the above spectrum depends on the $x$-position only through an exponential term, representing a group delay of a factor $\frac{x-x_s}{v}$. 

\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/moving_source_spectrum.png}
	\put(0,1){(a)}
	\put(48,1){(b)}
	\end{overpic}   
    \caption{The time history and spectrum of a source pass-by, moving on a trajectory $\vxs(t) = \posvec{3}{v\cdot t}{-2}{0}$ with $v = \frac{c}{2}$, measured at the origin.
    The source is oscillating at $\omega_0 = 2\pi \cdot 500~\mathrm{krad/s}$.
    The spectrum is described by the Hankel function as given by \eqref{Eq:Moving_sources:Freq_domain_representation}.
    The poles/singularities of the spectrum are the \emph{dominant frequencies} of the approaching ($t \rightarrow -\infty$) and the diverging ($t \rightarrow \infty$), given by \eqref{eq:HF_appr:moving_s_per_freq} as $\omega_d = \omega_0 \frac{1}{1 \pm M}$, with $M = \frac{v}{c}$ being the Mach number.
    }
\label{fig:Moving_sources:moving_source_field}  
\end{figure}

\vspace{3mm}
Due to the spatio-temporal invariancy of the spectrum \eqref{Eq:Moving_sources:Freq_domain_representation} along the $x$-dimension the representation can be easily Fourier transformed along the $x$-dimension, yielding
\begin{equation}
\tilde{P}_{\mathrm{m}}(k_x,y,z,\omega,\omega_0) =
\frac{2\pi}{v}
\tilde{G}(\frac{\omega-\omega_0}{v}, y, z, \omega)
\te^{\ti \frac{\omega-\omega_0}{v} x_s}
 \delta(k_x - \frac{\omega-\omega_0}{v}),
\label{Eq:Moving_sources:MS_field_kx_z}
\end{equation}
and obviously the angular spectrum representation (i.e. $k_x-y-k_z$ representation) is given as
\begin{equation}
\tilde{P}_{\mathrm{m}}(k_x,y,k_z,\omega,\omega_0) =
\frac{2\pi}{v}
\tilde{G}(\frac{\omega-\omega_0}{v}, y, k_z, \omega)
\te^{\ti \frac{\omega-\omega_0}{v} x_s}
 \delta(k_x - \frac{\omega-\omega_0}{v}),
\label{Eq:Moving_sources:MS_field_kx_kz}
\end{equation}
Note that the representation does not pose any constraint on the actual form of the Green's function, the above equations theoretically describes the field of an arbitrary source under uniform motion.	

The above spectral formulations can be extended for sources, moving inclined to the $x$-axis, given in Appendix \ref{App:Moving_source_representations}.
These formulations may be applied for deriving implicit and explicit driving functions for virtual sources moving uniformly along arbitrary directed straight trajectories, as it is discussed in details in \cite{firtha2015sound}.
Since however the previous section presented a more general methodology for the reproduction of sources under arbitrary motion, it is sufficient to restrict the investigation of the explicit SFS methodology for sources moving parallel with the $x$-axis, resulting in closed form analytic formulations.

\subsection{3D Spectral Division Method for moving sources}
The spectral representations presented in the foregoing allows the derivation of explicit SFS driving functions for the synthesis of moving sources.
The following driving functions are specialized to the case of sources under uniform motion, reproduced by planar and linear SSDs in contrary to WFS, allowin the reproduction of sources with arbitrary trajectory applying arbitrary SSDs, which can be extended for arbitrary secondary source contours within the validity of the Kirchhoff approximation.
Still, the importance of the explicit solution is given by that they constitute a reference solution for the synthesis problem, and allows the spectral investigation of the artifacts, stemming from the non ideal nature of practical SFS implementations.

Assuming an infinite planar distribution of secondary sources along the plane $\vxo = \posvec{3}{x_0}{0}{z_0}$, the explicit driving function in the $k_x-k_z$ domain is given by the of the angular spectrum representation of the field, generated by a moving source \eqref{Eq:Moving_sources:MS_field_kx_kz} substituted into the general 3D explicit driving function \eqref{Eq:Theory:Planar_explicit_driv_fun}
\begin{equation}
D(k_x,k_z,\omega) = \frac{2 \pi }{v} \frac{
\tilde{G}(\frac{\omega-\omega_0}{v}, y-y_s, k_z, \omega)
}{ \tilde{G}(k_x, y, k_z, \omega) } 
\te^{\ti \frac{\omega-\omega_0}{v} x_s}
 \delta(k_x - \frac{\omega-\omega_0}{v}),
\end{equation}
with $k_y = \sqrt{\left( \frac{\omega}{c} \right)^2 - k_x^2 - k_z^2}$.
The spatial driving function is obtained from the double inverse Fourier transform of the wavenumber domain driving function, given by \eqref{Eq:Theory:Planar_explicit_driv_fun_spatial}.
Integration along $k_x$ can be evaluated analytically, with the Dirac delta sifting out $k_x = \frac{\omega-\omega_0}{v}$.
Hence, the spatial driving function takes the form
\begin{equation}
D(x_0,z_0,\omega) = 
\frac{1}{2\pi}
\int_{-\infty}^{\infty}
\frac{1}{v} \frac{
\tilde{G}(\frac{\omega-\omega_0}{v}, y-y_s, k_z, \omega)
}{ \tilde{G}(\frac{\omega-\omega_0}{v}, y, k_z, \omega) } 
\te^{-\ti \frac{\omega-\omega_0}{v} (x_0-x_s)} 
\te^{-\ti k_z z_0}
\td k_z,
\end{equation}
Substituting the explicit formula for the 3D Green's function angular spectrum representation allows simplification by $\sqrt{\left( \frac{\omega}{c} \right)^2 - \left( \frac{\omega-\omega_0}{v}\right)^2 - k_z^2}$ and division of the exponentials, making the driving functions independent from the $y$-coordinate:
\begin{equation}
D(x_0,z_0,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \frac{1}{v}
\underbrace{\te^{-\ti \sqrt{\left( \frac{\omega}{c} \right)^2 -  \left(\frac{\omega-\omega_0}{v}\right)^2 - k_z^2} |y_s|} }_{
{\scriptscriptstyle
-\left. \frac{\partial}{\partial y} \frac{\te^{-\ti \sqrt{\left( \frac{\omega}{c} \right)^2 -  \left(\frac{\omega-\omega_0}{v}\right)^2 - k_z^2} |y-y_s|}}{ \ti
\sqrt{\left( \frac{\omega}{c} \right)^2 -  \left(\frac{\omega-\omega_0}{v}\right)^2 - k_z^2}} \right|_{y=0}}
}
\te^{-\ti k_z z_0} \td k_z
 \te^{-\ti \frac{\omega-\omega_0}{v} (x_0-x_s) } .
\end{equation}
The integrand can be recognized as the $y$-derivative of the Green's function, taken on the SSD.

\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/Planar_SDM.png}
	\small
	\put(0, 0){(a)}
	\put(47,0){(b)}
	\end{overpic}
\caption{
Synthesis of a moving virtual point source using a planar SSD applying the SDM driving functions.
The SSD is located at $\vxo = [x_0,\ 0,\ z_0]^{\mathrm{T}}$ denoted by solid black line. 
The virtual source is located at $\vxs(t) = [1.5 + v\cdot t,\ -2,\ 0]^{\mathrm{T}}$ with $v = \frac{3}{4} c$, oscillating at $\omega_0 = 2\pi \cdot 1 ~\mathrm{krad/sec}$.
The figures depict the real part of the synthesized field (a) and the deviation from the target sound field (b) measured at $z=0$.}
	\label{Fig:Moving_sources:moving_synthesis_by_planar_SDM}
\end{figure}
Hence, evaluating the integration with respect to $k_z$ results in the frequency domain explicit driving function
\begin{equation}
D(x_0,z_0,\omega,\omega_0) = -\frac{2}{v}
\left. \frac{\partial}{\partial y}  \tilde{G}(\frac{\omega-\omega_0}{v}, y-y_s, z_0, \omega) \right|_{y=0}
 \te^{-\ti \frac{\omega-\omega_0}{v} (x_0-x_s) }.
\end{equation}
This formulation describes the $y$-derivative of the field of a moving point source.
From the mixed time-frequency formulation this can be expressed as
\begin{equation}
D(x_0,z_0,t,\omega_0) = 
- \frac{1}{2\pi}
\frac{y_s}{\Delta(\vxo,t_0)}\left( \frac{1-M^2}{\Delta(\vxo,t_0)} + \ti k_0 \right)
\frac{\te^{\ti \omega_0\left( t_0 - \tau( \vxo,t_0 )\right)}}{\Delta(\vxo,t_0)},
\end{equation}
with $\tau(\vxo,t_0)$ and $\Delta(\vxo,t_0)$ given by \eqref{fig:Moving_sources:tau_uniform} and \eqref{fig:Moving_sources:delta_uniform} respectively.
%

The result of synthesis applying the above driving functions is depicted in Figure \ref{Fig:Moving_sources:moving_synthesis_by_planar_SDM}, verifying, that applying an infinite planar SSD perfect synthesis can be achieved in front of the SSD.
Obviously, the explicit driving functions coincide with the implicit solution for the same SSD geometry, without applying the high frequency gradient approximation.

\subsection{2.5D Spectral Division Method for moving sources}

Applying the wavenumber domain formulation of the field generated by a uniformly moving source the explicit driving function for an infinite linear SSD may be obtained.
As discussed in the foregoing, the application of a linear SSD allows the synthesis of a source distribution located at the plane of the SSD and the reference line, hence in the followings 
the investigation is fixed to the plane of synthesis, chosen to be $z=0$.

As the simplest case the virtual source moves parallel to the SSD, with the source position given as $\vxs(t) = \posvec{3}{v\cdot t}{y_s}{0}$, with $y_s<0$, oscillating at $\omega_0$. 
The SSD is an linear linear set of 3D point sources, located along $\vxo = \posvec{3}{x_0}{0}{0}$.
The general 2.5D explicit driving function for a linear SSD allowing the synthesis of a sound field satisfying the homogeneous wave equation at $y>0$ is given by \eqref{Eq:SFS_Theory:LinearSDM_spectral}. 
The required wavenumber content of the virtual field is given by \eqref{Eq:Moving_sources:MS_field_kx_z}.
By applying this formulation the wavenumber domain driving functions are expressed as
\begin{equation}
\tilde{D}(k_x,\omega,\omega_0) = 
\frac{2\pi}{v}
\frac{ 
\tilde{G}(\frac{\omega-\omega_0}{v}, \yref, 0, \omega)
}{\tilde{G}(k_x,\yref,0, \omega)}
 \delta(k_x - \frac{\omega-\omega_0}{v}) 
\te^{\ti \frac{\omega-\omega_0}{v} x_s},
\end{equation}
with $\yref$ being the reference line $y$-position.
The spatial representation of the driving function is obtained by a spatial inverse Fourier transform of the above expression,
Unlike in the stationary case, due to the spatial invariancy of the virtual source field (up to a phase shift) the inverse transform may be evaluated analytically by exploiting the Dirac delta sifting property, resulting in 
\begin{equation}
D(x_0,\omega,\omega_0) = 
\frac{1}{v}
\frac{ 
\tilde{G}(\frac{\omega-\omega_0}{v}, \yref, 0, \omega)
}{\tilde{G}(\frac{\omega-\omega_0}{v},\yref,0, \omega)}
\te^{-\ti \frac{\omega-\omega_0}{v} (x_0 - x_s)},
\end{equation}
or expressing $\tilde{G}(k_x,y,z,\omega)$ explicitly yields the final 2.5D SDM driving functions
\begin{equation}
D(x_0,\omega,\omega_0) = 
\frac{1}{v}
\frac{ 
H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2} |\yref - y_s| \right)
}{
H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2} |\yref| \right)
}
\te^{-\ti \frac{\omega-\omega_0}{v} (x_0 - x_s)}.
\end{equation}

\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/Linear_SDM.png}
	\footnotesize
	\put(0, 0){(a)}
	\put(45,0){(b)}
	\end{overpic}
\caption{Synthesis of a uniformly moving virtual point source employing a linear SSD applying the 2.5D SDM driving functions.
The SSD is located at $\vxo = [x_0,\ 0,\ 0]^{\mathrm{T}}$, denoted by a solid black line. 
The virtual source is located at $\vxs(t) = [v\cdot t + 1.5,\ -2,\ 0]^{\mathrm{T}}$ with $v = \frac{3}{4}c$ oscillating at $\omega_0 = 2\pi \cdot 1 ~\mathrm{krad/sec}$. 
The reference line was set to $\yref = 1.5~\mathrm{m}$.
The figure depicts the synthesized field at the synthesis plane ($z = 0$) with (a) depicting the real part of the synthesized field, (b) depicting the error of synthesis.}
	\label{Fig:Moving_sources:moving_synthesis_by_linear_SDM}
\end{figure}

The result of synthesis applying the explicit driving function is depicted in \eqref{Fig:Moving_sources:moving_synthesis_by_linear_SDM}.
It is verified, that the explicit method theoretically ensures perfect synthesis along the reference line, therefore may serve as a reference solution.

Assuming high frequency conditions the Hankel function can be approximated by its asymptotic expansion as given by \eqref{Eq:HF_approx:Hankel_asymptotic_form}.
Applying the formulation the spectral division can be carried out analytically, resulting in the approximate driving function
\begin{equation}
D(x_0,\omega,\omega_0) = 
\frac{1}{v}
\sqrt{\frac{\yref}{\yref- y_s}}
\te^{-\ti \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2}|y_s|}
\te^{-\ti \frac{\omega-\omega_0}{v} (x_0 - x_s)}.
\end{equation}
This formulation coincides with the implicit Wave Field Synthesis driving functions for a moving source, derived entirely in the spectral domain: 
the frequency domain representation of a moving source \eqref{Eq:Moving_sources:Freq_domain_representation} allows an alternative derivation of 2.5D WFS driving functions by applying the stationary phase approximation entirely in the frequency domain.
The approach---described in details in \cite{Firtha2015sound}---is not discussed here further, since it is superseded by the time domain WFS formulation introduced in the foregoing in \ref{Sec:Moving_source_WFS}.
The coincidence of the driving functions, however indicates that Wave Field Synthesis is a high-frequency/wavefront matching approximation of the explicit solution, proven for a general stationary sound field in the previous chapter.

\section{Practical aspects of the synthesis of moving sources}

The present thesis so far discussed the theoretical foundations of sound field synthesis (in particular of WFS) assuming an idealized secondary source distribution, resulting in analytical driving functions.
Obviously, the practical implementation of the foregoing raises numerous questions.
As an example the effects of applying directive SSD elements---instead of the ideal monopole secondary sources---were already discussed in section \ref{Sec:Dir_SSD}, compensated analytically within the validity of the stationary phase approximation.

The following final section presents several practical considerations for the implementation of the presented Wave Field Synthesis framework including difficulties, arising for the special case of synthesizing a moving point source.

\subsection{Effects of the SSD shape and discretization}

Throughout the present thesis the secondary source distribution has been assumed to be a continuous distribution of point sources.



\subsection{Calculation of source trajectory}

\subsection{Calculation of propagation time delay}