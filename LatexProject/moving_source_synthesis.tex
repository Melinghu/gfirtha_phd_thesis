In the previous chapters the description and reproduction of stationary sound fields were discussed.
The presented sound field synthesis methods, however, were not restricted to the synthesis of stationary sound fields.
In addition to the static case the synthesis of moving sources gained increasing interest.
This chapter deals with the synthesis of the sound fields generated by moving sources of sound, constituting a complex application example for the foregoing.

For this dynamic case the primary challenge is the proper reconstruction of the \emph{Doppler effect}, occurring due to the constant, finite wave propagation velocity in a homogeneous medium.
Since wavefronts generated by a source under motion propagate away from the excitation position with a finite sound speed, therefore in front of the source---towards the direction of the source motion---the wavefronts are compressed, while behind the source a rarefaction of wavefronts occurs.
This phenomenon leads to a modified, time dependent attenuation factor and a clearly audible altered perceived frequency in case of a harmonic source excitation, termed as the \emph{Doppler shift}.

The proper reconstruction of the Doppler effect is, however, inherently solved when analytical source models are applied.
Thus, first the analytical description of a sound field generated by a moving source is investigated.

\section{Description of moving sources}

This section extends the description and high frequency/asymptotic properties of stationary sound fields to the particular case of a moving 3D point source.
The solution obtained in the following can be applied in order to describe spatially extended moving sources, while an inclusion of source directivity can be found in \cite{Warren1976, Ahrens2011_moving_source_WFS}.

\subsection{Time domain description}
	
As a general case for a moving sound source, the field excited by a 3D point source under arbitrary motion is examined in details \cite{Dowling1983, deHoop2005}.
Assume a point source moving along an arbitrary trajectory with an arbitrary velocity profile, with the source location time history given by $\vxs(t) = \posvec{3}{x(t)}{y(t)}{z(t)}$.
The spatio-temporal impulse response of such a moving source, satisfying the inhomogeneous wave equation
\begin{equation}
\left( \Dx^2 -\frac{1}{c^2}\frac{\partial^2}{\partial t^2} \right) g_{\mathrm{m}}(\vx-\vxs(\tE),t-\tE) = -\delta\left( \vx - \vxs(\tE) \right) \cdot \delta\left( t - \tE \right),
\label{Eq:moving_source:Green_function_def}
\end{equation}
is given by the \emph{retarded Green's function} \cite{Jackson1999}
\begin{equation}
g_{\mathrm{m}}(\vx-\vxs(\tE),t-\tE) = \frac{1}{4\pi} \frac{\delta( t - \tE - \frac{|\vx-\vxs(\tE)|}{c} )}{|\vx-\vxs(\tE)|}.
\label{Eq:moving_source:retarded_greens}
\end{equation}
Time instant $\tE$ is referred to as the \emph{emission time}: 
the time instant at which the impulse was emitted that arrives to the receiver position $\vx$ at the time instant $t$.
Formally, the field of a moving impulsive point source is obtained from the stationary Green's function, by letting the source position to be the function of time.
A moving point source therefore radiates spherical wavefronts with the center being the source position at the emission time.
This general case is illustrated in Figure \ref{Fig:Moving_source:source_geometry}.
	
The field generated by a moving source with a source excitation time history $s(t)$ is obtained by modeling the excitation signal as the sum of a continuous sequence of Dirac pulses \cite{Girod2001, Ahrens2012}.
Each pulse is weighted by the retarded Green's function describing the wave propagation from the source position at the emission time to the receiver position.
The radiated field therefore can be written as 
\begin{equation}
\label{eq:moving_source:non_stat_convolution}
p_{\mathrm{m}}(\vx,t) = \int_{-\infty}^{\infty} s(\tE) g_{\mathrm{m}}(\vx-\vxs(\tE),t-\tE) \td \tE =  
\frac{1}{4\pi}\int_{-\infty}^{\infty} s(\tE)  \frac{\delta( t - \tE - \frac{|\vx-\vxs(\tE)|}{c} )}{|\vx-\vxs(\tE)|} \td \tE,
\end{equation}
describing a non-stationary convolution with the time-variant convolution kernel being the moving source impulse response \cite{Margrave1998}.
\begin{figure} 
	\small
    \begin{minipage}[c]{0.6\textwidth}
    \hspace{0cm}
	\begin{overpic}[width = 1.00\columnwidth ]{Figures/Moving_sources/moving_source_geometry.png}
	\small
	\put(95,19){$x$}
	\put(7,23.5){$z$}
	\put(7,66){$y$}
	\put(55,64){$\vx$}
	\put(58.5,32.5){$\vxs(t)$}
	\put(33.5,30){$\vxs(\tE)$}
	\put(69,38){$\vv(t)$}
	\put(45.5,38.5){$\vv(\tE)$}
	\put(40,36.5){$\theta$}
	\put(0, 8){$\begin{matrix}
		\text{source}\\
		\text{trajectory}
		\end{matrix}$}
	\end{overpic} 
	\end{minipage}
	\hspace{10mm}
	\begin{minipage}[c]{0.35\textwidth}
    \caption{
	 Geometry for the description of the sound field of a moving point source, moving at an arbitrary trajectory described by $\vxs(t)$.
The figure illustrates a moving source emitting impulses, with the position at the emission time instants denoted by grey dots on the trajectory.
%The impulses propagate with spherical wavefront, with the attenuation factor described by the retarded Green's function \eqref{Eq:Theory:retarded_greens}.
The first impulse, emitted at $t_e$ is received in the receiver position $\vx$ at the time instant $t$, when the ,,snapshot'' is taken.}
	\label{Fig:Moving_source:source_geometry}
	\end{minipage}
\end{figure}  

The convolution may be evaluated by the generalization of the Dirac delta's sifting property for arguments of general functions \cite{Dowling1983, Crighton1992, Jackson1999}, given as\footnote{Equivalently, the same result is obtained by introducing a new variable for $t'(\tE) = \tE + |\vx-\vxs(\tE)|/c$.}
\begin{equation}
\int_{-\infty}^{\infty} f(t) \delta(g(t)) \td t = \sum_{i} \frac{f(t_i)}{\left| \frac{\partial}{\partial t} g(t) \right|_{t = t_i}}, \hspace{5mm} \text{where} \hspace{5mm} g(t_i) = 0.
\end{equation}

In the present case the derivative of the argument, i.e. the Jacobian is expressed by applying the chain rule, reading 
\begin{equation}
\label{eq:moving_source:jacobian}
\frac{\td }{\td \tE} g(\tE) = - 1 + \frac{1}{c} \frac{\left< \frac{\partial}{\partial \tE} \vxs(\tE) \cdot (\vx-\vxs(\tE))\right> }{|\vx-\vxs(\tE)|}.
\end{equation}
The temporal derivative of the source trajectory $\vvs(\tE) = \frac{\partial}{\partial \tE}\vxs(\tE)$ can be recognized as the source velocity vector at the emission time.
Convolution with the Dirac delta sifts out the zeros of its argument, given by the emission time for which
\begin{equation}
\label{eq:moving_source:emission_time}
\tE(t,\vx) = t - \frac{|\vx-\vxs(\tE(t,\vx))|}{c}
\end{equation}
holds.
Note that for a given receiver position $\vx$ and receiving time $t$, the emission time instant $\tE(t,\vx)$ is a dependent variable.
For subsonic velocities (i.e.\ $v<c$) only the positive real root for this quadratic equation is considered, while the Jacobian \eqref{eq:moving_source:jacobian} is negative.
With all these considerations the non-stationary convolution \eqref{eq:moving_source:non_stat_convolution} can be evaluated, yielding the sound field of a moving point source
\begin{equation}
p_{\mathrm{m}}(\vx,t) =
\frac{1}{4\pi} \frac{ s(t - \frac{|\vx-\vxs(\tE(\vx,t))|}{c} ) }{|\vx-\vxs(\tE(\vx,t))| - \frac{1}{c}\left< \vvs(\tE(\vx,t)) \cdot (\vx-\vxs(\tE(\vx,t)))\right> },
\end{equation}
with $\tE$ satisfying equation \eqref{eq:moving_source:emission_time}.

Conventionally the radiated field is expressed in terms of the propagation time-delay $\tau(\vx,t) = t - \tE(\vx,t)$ given by the non-linear quadratic equation
\importanteq{Propagation time delay}{
\tau(\vx,t) =  \frac{| \vx - \vxs( t - \tau(\vx,t)) |  }{c}.
\label{eq:tau}
}
%\fscom{in \eqref{eq:tau} rather $\tE$ instead of $\tau(\vx,t)$?}
Again, for subsonic velocities only the positive root of the quadratic equation ($\tau(\vx,t)>0$) is taken into consideration \citep{deHoop2005}. 
In the present thesis exclusively subsonic velocities are discussed.
For a detailed treatment on sources moving at supersonic velocities refer to \cite{Ahrens2008moving_b, Ahrens2012}.
Introducing $\Delta(\vx,t)$ for the attenuation factor the radiated field is given as
\importanteq{Field of a moving source}{
p_{\mathrm{m}}(\vx,t) = \frac{1}{4\pi}\frac{s( t - \tau( \vx,t ) )}{\Delta(\vx,t-\tau( \vx, t ))},
\label{eq:moving_source_field}
}
with
\begin{equation}
\Delta( \vx,t ) = |\vx - \vxs(t)| - \left<\, \frac{1}{c}\vvs(t) \cdot (\vx - \vxs(t)) \right> 
 =  |\vx - \vxs(t)|\left( 1 - M(t) \cos \vartheta(\vx,t) \right),
\label{eq:delta}
\end{equation}
where $M(t) = |\vvs(t)|/c$ is the \emph{Mach number}, $\vartheta(\vx,t)$ is the angle between the velocity vector and the source-receiver vector and the term $\left( 1 - M(t) \cos \vartheta(\vx,t) \right)^{-1}$ is referred to as the \emph{Doppler factor}. % describing whether the source moves towards to or away from the receiver position.
The geometry along with the notation used, is illustrated in Figure \ref{Fig:Moving_source:source_geometry}.
%
Equation \eqref{eq:delta} states that as a part of the Doppler effect, due to the compression of wavefronts towards the direction of the source motion the resulting spatial amplitude distribution of the wavefield increases compared to that of a stationary source.
Similarly, behind the moving source due to the rarefaction of the wavefronts the amplitude of the source decreases.
This relative change of the attenuation factor is described by the Doppler factor.

\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/moving_source_field.png}
	\put(30,26){$\vvs$}
	\put(0,1){(a)}
	\put(48,1){(b)}
	\end{overpic}   
    \caption{Sound field, generated by a moving point source, oscillating at a source angular frequency $f_0 = 1~\mathrm{kHz}$ traveling along a straight source trajectory, described by $\vxs(t) = \posvec{3}{v \cdot t}{0}{0}$ with the velocity given by $v = \frac{c}{2} = 171.5~\mathrm{m/s}$.
    Figure (a) shows the real part of the radiated field and (b) shows the amplitude distribution in a logarithmic scale, demonstrating the result of the Doppler effect.
    In this special case of uniform motion the amplitude distribution is axially symmetric with the axis being perpendicular to the source trajectory.
    }
\label{fig:Moving_sources:moving_source_field}  
\end{figure}

Obviously, the evaluation of the radiated field emitted by a moving source is not straightforward: it requires the determination of the emission time or the propagation time-delay by solving \eqref{eq:moving_source:emission_time} or \eqref{eq:tau}, respectively, for each receiver position and time.
Analytical solutions for the general problem are barely available.
For the special case of a sound source under uniform motion, i.e. moving along a straight trajectory with a constant velocity the quadratic equations can be solved.
Assuming the source moving along the $x$-axis, i.e. the source position vector is given as $\vxs(t) = \posvec{3}{v \cdot t}{0}{0}$ the required quantities read as
\begin{equation}
\tau(\vx,t) = \frac{|\vx-\vxs(t_e(\vx,t))|}{c} = \frac{M (x-v t)+\Delta(\vx,t)}{c (1-M^2)},
\label{fig:Moving_sources:tau_uniform}  
\end{equation}
with $M = \frac{v}{c}$ being the time independent Mach number and
\begin{equation}
\Delta(\vx,t) = \sqrt{(x-vt)^2+(y^2+z^2)(1-M^2)}.
\label{fig:Moving_sources:delta_uniform}
\end{equation}
For sources moving inclined to the $x$-axis the corresponding quantities can be obtained by a rotation of the coordinate system as discussed in Appendix \ref{App:Moving_source_representations} \cite{firtha2015sound, Ahrens2015:web, firtha2016wave}.

\subsection{Time-frequency domain description}
In order to extend the asymptotic/local attributes---introduced for steady-state sound fields in Chapter \ref{sec:high_freq_approx}---for the dynamic scenario, a mixed time-frequency representation of moving sources is investigated next.
Assume a moving source with a harmonic excitation time dependence given by $s(t) = \te^{\ti \omega_0 t}$, oscillating at the angular frequency $\omega_0$.
The radiated field reads as
\begin{equation}
P_{\mathrm{m}}(\vx,t,\omega_0) = \frac{1}{4\pi}\frac{\te^{\ti \omega_0\left( t - \tau( \vx,t )\right)}}{\Delta(\vx,t-\tau( \vx, t ))}.
\label{eq:harmonic_moving_source_field}
\end{equation}

An arbitrary non-stationary sound field can be written in a general polar form $P_{\mathrm{m}}(\vx,t,\omega_0) = A^P(\vx,t,\omega_0) \te^{\ti \phi^P(\vx,t,\omega_0)}$, with $A^P(\vx,t,\omega_0),\phi^P(\vx,t,\omega_0) \in \mathbb{R}$.
For such a harmonic field the local wavenumber vector can be defined in the same manner as for a stationary sound field being the negative phase gradient
\begin{equation}
\label{eq:HF_appr:general_loc_wn}
\vk^P(\vx,t) = [k_x^P(\vx,t),\ k_y^P(\vx,t),\ k_z^P(\vx,t)]^{\mathrm{T}} = -\Dx \phi^P(\vx,t,\omega_0).
\end{equation}
This vector is perpendicular to the isophase surfaces, i.e. to the wavefront at an arbitrary position and time instant.
Since in the present thesis only isotropic medium is considered, the local wavenumber vector points into the local propagation direction of the wavefront.
For the case of a moving point source the local wavenumber vector is given by the phase gradient of \eqref{eq:harmonic_moving_source_field} reading
\importanteq{Moving source local wavenumber}{
\label{eq:HF_appr:moving_s_loc_wn}
\vk^P(\vx,t) = -\Dx \phi^P(\vx,t,\omega_0) = \frac{\omega_0}{c} \frac{\vx -\vxs(t-\tau(\vx,t))}{\Delta(\vx, t-\tau(\vx,t))}.
}

The local dispersion relation (or the eikonal equation) and the attenuation over the propagation path (or the transport equation) for a non-stationary sound field can be obtained by substituting the general polar form into the time domain wave equation \eqref{Eq:Theory:Scalar_wave_equation} and expanding the differential operators.
Setting the real and imaginary parts to zero results in the equations
\begin{eqnarray}
\frac{\Lx A^P}{A^P}  - | \Dx \phi^P |^2 -\frac{1}{c^2} \frac{A^{P''}_{tt}}{A^P} +\frac{1}{c^2}|\phi^{P'}_{t}|^2 = 0, \\ 
\label{eq:HF_appr:transport_eq_non_stat}
\Lx \phi^P + 2\frac{ \left< \Dx \phi^P \cdot \Dx A^P \right> }{A^P} - \frac{1}{c^2} \phi^{P''}_{tt} - \frac{1}{c^2} 2\frac{A^{P'}_t \phi^{P'}_t }{A^P} = 0.
\end{eqnarray}
Obviously, for a moving point source the above equations have to be singular at the source position, following \eqref{Eq:Theory:Green_function_def}.
Assuming high frequency conditions the local dispersion relation results in
\begin{equation} \label{eq:HF_appr:eikonal_eq_non_stat}
| \Dx \phi^P |^2 = k_x^P(\vx,t)^2 + k_y^P(\vx,t)^2 + k_z^P(\vx,t)^2 \approx \frac{1}{c^2}|\phi^{P'}_{t}|^2,
\end{equation}
holding with equality for a point source under motion excluding the moving singularity.
Obviously, unlike for the stationary case, the length of the local wavenumber vector is not constant, but depends on both the receiver position and time.
As a result the wavefront is not described by a normal form, as for the stationary case.

The temporal derivative of the phase function can be recognized as the generalization of the perceived angular frequency at a fixed receiver position \cite{Morse1968}.
For the case of a moving virtual point source the perceived frequency can be expressed as 
\importanteq{Perceived angular frequency}{
\label{eq:HF_appr:moving_s_per_freq}
\frac{\partial}{\partial t}\phi^P(\vx,t) =  \omega(\vx,t) = \omega_0  \frac{|\vx-\vxs(t-\tau(\vx,t))|}{\Delta(\vx,t-\tau(\vx,t))} = \frac{  \omega_0  }{1 - M(t) \cos \vartheta(\vx,t) }.
}
This expression is the general Doppler formula, describing the relative frequency shift in case of a harmonic source signal \cite{Morse1968}. 
Thus both the perceived frequency and amplitude of the source is altered, and the alteration is described by the Doppler factor.

The local dispersion relation \eqref{eq:HF_appr:eikonal_eq_non_stat} therefore states that the local wavenumber vector is perpendicular to the wavefront with the length being proportional to the local perceived angular frequency.
Hence, the normalized local wavenumber vector, defined as being a unit vector pointing to the local propagation direction, can be generalized as
\begin{equation}
\label{eq:Moving_source:local_wn_general}
\hat{\vk}^P(\vx,t) = -\frac{\Dx \phi^P(\vx,t)}{\frac{1}{c}\frac{\partial}{\partial t} \phi^P(\vx,t)}  = \frac{\vk^P(\vx,t)}{ \omega(\vx,t)/c }.
\end{equation}
For the moving point source the normalized local wavenumber vector is given from \eqref{eq:HF_appr:moving_s_loc_wn} and \eqref{eq:HF_appr:moving_s_per_freq} as
\importanteq{Normalized local wavenumber}{
\label{eq:Moving_source:norm_local_wn_moving_source}
\hat{\vk}^P(\vx,t) = \frac{\vx -\vxs(t-\tau(\vx,t))}{|\vx-\vxs(t-\tau(\vx,t))|},
}
reflecting the fact that a moving point source radiates spherical wavefronts with the center being the source position at the emission time instant.
\begin{figure} 
	\small
    \begin{minipage}[c]{0.6\textwidth}
    \hspace{0cm}
	\begin{overpic}[width = 1.0\columnwidth ]{Figures/Moving_sources/moving_source_local_wave.png}
	\small
	\end{overpic} 
	\end{minipage}
	\hspace{10mm}
	\begin{minipage}[c]{0.35\textwidth}
    \caption{
	Illustration of the wavefronts and the local wavenumber vector of a moving sound source.
	The figure illustrates the local wavenumber vector on an isophase surface, with the source position at the corresponding emission time denoted by black dot.
	The generated wavefronts are spherical ones, with the local wavenumber vector being radial.
	The length of the local wavenumber vector is defined by the instantaneous perceived angular frequency, described by the Doppler factor.}
	\label{Fig:Moving_source:moving_source_local_wn}
	\end{minipage}
\end{figure}  

Finally, in the non-stationary case, the transport equation \eqref{eq:HF_appr:transport_eq_non_stat} describes, how the amplitude of a wavefront element changes over its propagation path:
\begin{equation}
\label{Eq:Moving_source:transport_eq}
\frac{ \left< \hat{\vk}^P \cdot \Dx A^P \right>+\frac{1}{c} A^{P'}_t }{A^P}  = \frac{1}{2} \frac{ \Lx \phi^P - \frac{1}{c^2} \phi^{P''}_{tt} }{\frac{1}{c}\phi^{P'}_t}
\end{equation}
The left hand side of the equation can be interpreted as the relative amplitude change of the radiated wavefront over its propagation path. 
Mathematically, it is given by the rate of change of the amplitude factor with respect to a change $\td x$ in the receiver position into the direction of $\hat{\vk}$ and a change $\frac{\td x}{c}$ in the receiving time.
The right hand side of the equation can be recognized as the general local mean curvature of the wavefront \cite[4.2]{Goldman2005},\footnote{As given in \cite{Goldman2005} the mean curvature of a general implicit surface $F$ is given by 
$\overline{\kappa}^F(\vx) = \frac{1}{2}\frac{\Dx F^{\mathrm{T}} H^F \Dx F - |\Dx F|^2 \Lx F }{|\Dx F|^3}$. In the present case also $\frac{1}{c^2} \phi^{P''}_{tt} = \frac{\Dx \phi^{\mathrm{T}} \mH^P \Dx \phi}{|\Dx \phi|^2}$ holds.} thus \eqref{Eq:Moving_source:transport_eq} can be rewritten as
\begin{multline}
\overline{\kappa}^P(\vx,t) = -\frac{1}{2}\Dx \cdot \hat{\vk}^P(\vx,t)= \\
-\frac{ \left< \hat{\vk}^P \cdot \Dx A^P \right>+\frac{1}{c} A^{P'}_t }{A^P} = -\frac{1}{2} \left( \frac{ \Lx \phi^P  }{ \omega(\vx,t)/c } - \frac{ \hat{\vk}^P(\vx,t)^{\mathrm{T}} \mH^P \hat{\vk}^P(\vx,t) }{ \omega(\vx,t)/c } \right).
\label{Eq:Moving_source:attenuation}
\end{multline}
As a result, similarly to the stationary case, the relative attenuation of the wavefront over the propagation is given by the local mean curvature of the wavefront.
Obviously, for a moving point source the mean curvature is that of a spherical wavefront being also equal to the principal curvatures, given as
\begin{equation}
\overline{\kappa}^P(\vx,t) = \kappa^P_{1/2}(\vx,t) = \frac{1}{|\vx-\vxs(t-\tau(\vx,t))|}.
\label{Eq:Moving_source:attenuation_2}
\end{equation}
This result reflects that although the spatial distribution of the amplitude factor is altered according to the Doppler factor, the attenuation of the individual wavefronts over the propagation path is inversely proportional to the distance from the source position at the emission time instant.
This fact trivially follows the definition of the retarded Green's function \eqref{Eq:moving_source:retarded_greens}.

\section{Wave Field Synthesis of moving sources}
\label{Sec:Moving_source_WFS}

So far only boundary integral formulations of steady-state sound fields were discussed merely in the frequency domain.
In order to synthesize the temporally varying sound field of a moving point source by using implicit SFS methodology, an appropriate time domain boundary integral representation of arbitrary sound fields is required.
%It can be obtained by the temporal inverse Fourier transform of the corresponding spectral integrals:

Assume a source-free volume inside an enclosure $\Oi$, bounded by the surface $\dO$.
Any sound field obeying the homogeneous time domain wave equation inside the enclosure can be expressed by the \emph{time domain Kirchhoff-Helmholtz integral equation}.
The formulation is obtained by the direct inverse Fourier transform of the spectral KHIE \eqref{Eq:Theory:Kirchhoff-Helmholtz} by exploiting the Fourier convolution theorem, reading
\importanteq{Time domain KHIE}{
\small
p(\vx,t) = \oint_{\dO} \int_{t_0} p(\vxo,t_0) \frac{\partial}{\partial \vni} g(\vx - \vxo, t - t_0) - \frac{\partial}{\partial \vni}  p(\vxo,t_0) g(\vx - \vxo, t - t_0) \td t_0 \td \dO(\vxo),
}
with $\vx \in \Oi$.	

Assuming convex boundaries and high frequency conditions---i.e. source time histories with dominant high frequency content---the tangent plane approximation \eqref{Eq:SFS_theory:tangent_plane} holds and the above integral can be approximated by the \emph{time domain Kirchhoff approximation}
\importanteq{Time domain Kirchhoff approx.}{
\label{eq:theory:KA_td}
p(\vx,t) \approx -2 \oint_{\dO} \int_{t_0} w(\vxo,t_0) \frac{\partial}{\partial \vni}  p(\vxo,t_0) g(\vx - \vxo, t - t_0) \td t_0 \td \dO(\vxo),
}
obtained by the direct inverse Fourier transform of equation \eqref{Eq:SFS_theory:Kirchhoff_appr}.
The time domain approximation describes an arbitrary sound field in terms of a spatio-temporal convolution over the boundary surface.
The convolution kernel/wave propagator is the time domain Green's function, describing the spatio-temporal impulse response of a point source on the boundary, emitting an impulse at $t_0$.
The time dependent windowing function can be defined by assuming a harmonic time dependency, for which the local wavenumber vector is defined as \eqref{eq:HF_appr:general_loc_wn}.
The windowing function is then given as
\begin{equation}
w(\vxo,t_0) = \begin{cases}
                        1, \hspace{3mm} \forall \hspace{3mm} \langle \vk^P(\vxo,t_0) \cdot \vni(\vxo) \rangle > 0 \\
                        0  \hspace{3mm} \text{elsewhere},
                    \end{cases}
\end{equation}
as a straightforward generalization of the stationary case.

Similarly to the stationary case, for the special geometry of the boundary being an infinite plane the Kirchhoff approximation degenerates to the time domain Rayleigh integral, describing an arbitrary pressure field in front of the Rayleigh plane without any approximations involved.

\subsection{3D Wave Field Synthesis of a moving point source}

Assume the general sound field synthesis problem formulation in the time domain, taken as the inverse Fourier transform of the single layer potential \eqref{Eq:Theory:3D_SFS}
\begin{equation}
p(\vx,t) = \oint_{\dO} \int_{t_0} d(\vxo,t_0) g(\vx - \vxo , t-t_0 ) \td t_0 \, \td \dO ( \vxo ).
\label{eq:moving_source:SFS_problem_td}
\end{equation}

Comparison with \eqref{eq:theory:KA_td} reveals that similarly to the stationary, harmonic case the time domain Kirchhoff approximation implicitly contains the required time domain driving signals, reading
\begin{equation}
\label{eq:moving_source:3D_wfs_driv_fun_td}
d(\vxo,t_0) =  -2 w(\vxo,t_0) \frac{\partial}{\partial \vni}  p(\vxo,t_0).
\end{equation}
By assuming a harmonic source time dependency the high frequency gradient approximation can be applied for a non-stationary sound field, reading
\begin{equation}
\Dx P(\vx,t,\omega_0) \approx - \ti \vk^P(\vx,t) P(\vx,t,\omega_0),
\label{eq:moving_source:gradient_appr_nonstat}
\end{equation}
which is again, a local plane wave approximation.
The 3D WFS driving function can be approximated then by
\begin{equation}
\label{eq:moving_source:3D_wfs_driv_fun}
D(\vxo,t_0,\omega_0) =  2 w(\vxo,t_0) \ti k_{\mathrm{n}}^P(\vxo,t_0) P(\vxo,t_0,\omega_0),
\end{equation}
with $k_{\mathrm{n}}^P$ being the normal component of the local wavenumber vector.
	
\begin{figure}  
\small
  \begin{minipage}[c]{0.64\textwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/3D_WFS2.png}
	\small
	\put(2,53){(a)}
	\put(2,1){(b)}
	\end{overpic}   \end{minipage}\hfill
	\begin{minipage}[c]{0.35\textwidth}
    \caption{3D synthesis of a moving 3D point source radiating at $f_0 = 1.5~\mathrm{kHz}$.
    The source is under uniform motion with the source trajectory given by $\vxs = \posvec{3}{1.85+v_x \cdot t}{3.2+v_y \cdot t}{0}$ with $|\vvs| = 150~\mathrm{m/s}$ and $v_x = 140~\mathrm{m/s}, v_y = 98~\mathrm{m/s}$.  
    The snapshot is taken at $t = 0~\mathrm{s}$. 
    The SSD surface is chosen to be independent of the $z$-coordinate as illustrated in Figure \ref{fig:SFS_theory:WFS_geometry}.
    Figure (a) depicts the real part of the synthesized field and part (b) presents the absolute error of synthesis (the discrepancy between the synthesized and the target sound field) in a logarithmic scale measured in the horizontal plane, containing the virtual point source.
	The active arc of the SSD \emph{at the time instant $t = 0~\mathrm{s}$} is denoted by solid black line, and the inactive part with dotted by black line.
    }
\label{fig:SFS_theory:3D_WFS_moving_source}  \end{minipage}
\end{figure}
%
Since the sound field generated by a moving point source satisfies the homogeneous wave equation inside the listening volume, therefore it can be described by the Kirchhoff integral, and its sound field can be reproduced by applying the driving function above.
Suppose that a point source is moving along an arbitrary trajectory $\vxs(t) = \posvec{3}{x(t)}{y(t)}{z(t)}$ outside the listening volume, bounded by a convex SSD.
Assuming a harmonic source excitation with the angular frequency being $\omega_0$ the driving function for the synthesis of the virtual source is obtained from \eqref{eq:moving_source:3D_wfs_driv_fun} by substituting the pressure field and the local wavenumber vector of a moving point source, given by \eqref{eq:harmonic_moving_source_field} and \eqref{eq:HF_appr:moving_s_loc_wn}, respectively.
The resulting driving function reads as
\importanteq{3D WFS driving function}{
\small
D(\vxo,t_0,\omega_0) =  w(\vxo,t_0) 
\frac{\ti k_0}{2\pi} \frac{\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni(\vxo) \right>}{\Delta(\vxo,t_0-\tau(\vxo,t_0))}
\frac{\te^{\ti \omega_0\left( t_0 - \tau( \vxo,t_0 )\right)}}{\Delta(\vxo,t_0-\tau( \vxo, t_0 ))},
}
with $k_0 = \frac{\omega_0}{c}$, the amplitude factor given as
\begin{equation}
\Delta( \vxo,t_0 ) = |\vx - \vxs(t_0)| - \left<\, \frac{1}{c}\vvs(t_0) \cdot (\vx - \vxs(t_0)) \right> 
\end{equation}
and the propagation time delay satisfíing $\tau(\vxo,t_0) = | \vxo - \vxs( t_0 - \tau(\vxo,t_0)) | / c$.
For moving sources with a wideband excitation signal with the frequency content $S(\omega) = \int_{-\infty}^{\infty} s(t) \te^{-\ti \omega t} \td t$, the driving function is yielded by the weighted sum of the individual spectral components
\begin{equation}
d(\vxo,t_0) =  w(\vxo,t_0)  
\frac{\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni(\vxo) \right>}{\Delta(\vxo,t_0-\tau(\vxo,t_0))^2}
\int_{-\infty}^{\infty} \frac{\ti \omega_0}{2\pi c} S(\omega_0 )\te^{\ti \omega_0\left( t_0 - \tau( \vxo,t_0 )\right)} \td \omega_0,
\end{equation}
describing a temporal inverse Fourier transform, taken at $t_0 - \tau( \vxo,t_0 )$.
By realizing that multiplication by $\ti \omega_0$ performs the temporal differentiation of the input signal the time domain driving function takes the form
\importanteq{3D time domain driving function}{
d(\vxo,t_0) =   
\frac{\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni(\vxo) \right>}{\Delta(t_0-\tau(\vxo,t_0))}
\frac{w(\vxo,t_0)}{2\pi c} \frac{s'_t( t_0 - \tau( \vx,t_0 ) )}{\Delta(t_0-\tau(\vxo,t_0))}.
}	
Comparison with \eqref{Eq:SFS_theory:3D_WFS_ps_driv_fun} and \eqref{Eq:SFS_theory:3D_WFS_ps_driv_fun_td} indicates that the moving source driving function coincides with that for a stationary point source with the static distances/attenuation factors replaced with the dynamic ones.
The same result can be obtained by the direct substitution of a moving point source's pressure field into \eqref{eq:moving_source:3D_wfs_driv_fun_td} with taking only the dominant part into consideration.

As a simple example Figure \ref{fig:SFS_theory:3D_WFS_moving_source} shows the result of the synthesis of a point source under uniform motion.
For the sake of computational simplicity the SSD is chosen to be invariant along the $z$-dimension as it was illustrated in Figure \ref{fig:SFS_theory:WFS_geometry}.
As presented in the previous section for sources under uniform motion the propagation time delay and the amplitude distribution can be expressed analytically, given by \eqref{fig:Moving_sources:tau_uniform} and \eqref{fig:Moving_sources:delta_uniform}, respectively.
Similarly to the stationary case the above driving function ensures amplitude correct synthesis over most parts of the listening are within the validity of the Kirchhoff approximation.
Apart from the errors discussed for the case of the synthesis of a stationary point source---illustrated in Figure \ref{fig:SFS_theory:3D_WFS_moving_source}---amplitude errors and slight phase errors arise here as the source approaches the SSD surface and the high frequency/farfield gradient approximation does not hold.

\subsection{The time domain 2.5D Kirchhoff approximation}

In order to reproduce the sound field of a moving source by applying a contour of secondary sources an appropriate 2.5D integral representation is required.
The dimensionality reduction is again done by the stationary phase approximation of the Kirchhoff integral, resulting in the \emph{time domain 2.5D Kirchhoff approximation}.

Assume a 3D volume, bounded by a surface, for the sake of simplicity being invariant along the vertical dimension, as illustrated in Figure \ref{fig:SFS_theory:TD_Kirchoff_geometry}.
An arbitrary non-stationary sound sound field inside the enclosure can be described by the time domain Kirchhoff integral \eqref{eq:theory:KA_td}, which in this special geometry, is written with separated integral variables.
With a harmonic time dependency the radiated field inside the enclosure reads as
\begin{multline}
\displaystyle
P(\vx,t,\omega_0) = 
\oint_{C} \int_{z_0} \int_{t_0} \\
2 w(\vxo,t_0) \ti k_{\mathrm{n}}^P(\vxo,t_0) 	
P(\vxo,t_0,\omega_0) g(\vx-\vxo,t-t_0) \, \td t_0 \, \td z_0 \, \td s(x_0, y_0),
\label{Eq:SFS_theory:Kirchhoff_spec_geom_td}
\end{multline}
with the integral variable $\td s$ being the arc length along the contour.
%

Applying the explicit formula for the time domain 3D Green's function ($g(\vx-\vxo,t-t_0) = \frac{1}{4\pi} \frac{\delta(t-t_0-|\vx-\vxo|/c)}{|\vx-\vxo|}$) integration with respect to the emission time measured on the boundary (i.e. with respect to $t_0$) can be evaluated by exploiting the Dirac delta sifting property, and the radiated field is given as
\begin{equation}
\small
P(\vx,t,\omega_0) = \frac{1}{2\pi}
\oint_{C} \int_{z_0}  
 w(\vxo,t-  \Tret ) \ti k_{\mathrm{n}}^P(\vxo,t-\Tret) 	
\frac{P(\vxo,t-\Tret,\omega_0) }{|\vx-\vxo|}\,\td z_0 \, \td s(x_0, y_0).
\label{Eq:SFS_theory:Kirchhoff_spec_geom_td_2}
\end{equation}
In order to recast to a contour integral formulation this integral is approximated by the stationary phase method along the vertical dimension.
\begin{figure}  
\small
  \begin{minipage}[c]{0.60\textwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/25D_moving_source_b.png}
	\small
	\put(85,48.5){$x$}
	\put(93.5,32){$y$}
	\put(96,60){$z$}
	\put(63.5,34.5){$\vx$}
	\put(74.5,39){$\vxo$}
	\put(11.5,25){$\vxs(t)$}
	\put(26,27){$\vvs(t)$}
%	\put(7,22){plane of interest}
	\put(50,8){$\dO$: 3D surface}
	\put(51,24.5){$C$: 2.5D contour}
	\end{overpic}  \end{minipage}\hfill
	\begin{minipage}[c]{0.34\textwidth}
    \caption{
    Geometry for the derivation of 2.5D Kirchhoff integral.
The enclosing surface $\dO(x_0,y_0)$ is chosen to be independent of the $z$-coordinate in order to be able to evaluate the Kirchhoff integral with respect to $z_0$ using the SPA. 
If the sound field to be described is a 2D one propagating in the direction parallel to the listening plane, then the surface can be interpreted as a continuous set of infinite vertical line sources along $C$, capable of the perfect description of a 2D field inside the enclosure by a 2D countour integral.}
\label{fig:SFS_theory:TD_Kirchoff_geometry}  \end{minipage}
\end{figure}

Generally speaking, the stationary point of the integral is found, where the gradient of the integrand's phase function vanishes:
\begin{equation}
\left. \Dxo \phi^P(\vxo,t-\Tret,\omega_0) \right|_{\vxo = \vxo^*(\vx,t)} = 0.
\end{equation} 
The gradient can be evaluated by taking the total derivative of the phase function, which after rearrangement yields
\begin{equation}
-\frac{\Dxo \phi^P(\vxo^*(\vx,t),t-\TretS,\omega_0) }{\frac{1}{c}\frac{\partial }{\partial t}\phi^P(\vxo^*(\vx,t),t-\TretS,\omega_0) } = \frac{\vx-\vxo^*(\vx,t)}{|\vx-\vxo^*(\vx,t)|}
\end{equation}
being satisfied in the stationary position.
The left hand side describes the normalized local wavenumber vector of the general sound field $P$ \emph{taken at the time instant $t-\Tret$} (c.f. \eqref{eq:Moving_source:local_wn_general}), while the right term is recognized as the normalized local wavenumber of the Green's function. 
The stationary position for the Kirchhoff integral is thus found where
\begin{equation}
\label{Eq:moving_sources:moving_point_stat_point_1}
\hat{\vk}^P(\vxo^*(\vx,t),t-\TretS) = \hat{\vk}^G(\vx-\vxo^*(\vx,t))
\end{equation}
is satisfied.
As a generalization of the results presented in Section \ref{Sec:HS_approx:SPA_for_Rayleigh}, the equation states the following:
The Kirchhoff integral represents an arbitrary primary sound field at the receiver position $\vx$ as the sum of the individual spherical waves of a continuous distribution of point sources along the boundary.
For the integral the stationary/dominant secondary point source position $\vxo^*$ is found, where its spherical wavefront's propagation direction measured at $\vx,t$, generated at $\vxo^*, t-\TretS$ coincides with that of the primary wavefront measured on the boundary at $\vxo^*, t-\TretS$.
Obviously---since after the time instant $t-\TretS$ the secondary and primary wavefronts ,,propagate together'' along the common propagation direction---this requirement ensures, that the stationary boundary element's wavefront and the primary wavefront match at the receiver position $\vx$ at the receiving time instant $t$, thus 
\begin{equation}
\hat{\vk}^P(\vx,t) = \hat{\vk}^G(\vx-\vxo^*(\vx,t))
\end{equation}
also holds.
%
\begin{figure}
\small
  \begin{minipage}[c]{0.58\textwidth}
	\begin{overpic}[width = \textwidth ]{Figures/Moving_sources/KI_stat_point.png}
	\small
	\put(96,30){$x$}
	\put(15,80){$y$}
	\put(73,59){$\vx$}
    \put(45.5,30){$\vxo^*(\vx,t)$}
    \put(60,8.5){$\vxs(t)$}
    \put(41,8.5){$\vxs(t_0)$}
    \put(24.5,8.5){$\vxs(t_e)$}
	\put(58,41){$\vk^P(\vxo^*,t_0)$}
	\put(60,72){$\vk^G(\vx - \vxo^*)$}
	\end{overpic}  \end{minipage}\hfill
	\begin{minipage}[c]{0.4\textwidth} \hspace{2mm}
    \caption{
       Illustration of the stationary position for the boundary integral representation of the field of a moving source.
       The snapshot is taken at time instant $t$.
       The source position is indicated at three time instants: at the receiver time $t$, the boundary emission time $t_0 = t - \TretS$ and the source emission time $t_e = t - \TretS - \tau(\vxo^*,t_0)$.
       The stationary position for $\vx$ at time instant $t$ is found, so that the spherical wavefront generated by the moving source at $t_e$ coincides at $\vx,t$ with the spherical wavefront of the stationary point source generated at $t_0$.
       } 
       \label{Fig:Moving_sources:KI_stat_point}
  \end{minipage}
\end{figure}

This result is illustrated in Figure \ref{Fig:Moving_sources:KI_stat_point} via the example of the stationary point for the field of a moving point source.
For this case the normalized local wavenumber vector is given by \eqref{eq:Moving_source:norm_local_wn_moving_source} and the stationary position $\vxo^*(\vx,t)$ is found by denoting $t_0 = t-\Tret$ where 
\importanteq{Time domain KI stat. point}{
\label{Eq:Moving_sources:moving_source_stat_point}
\frac{\vxo^*(\vx,t) -\vxs(t_0-\tau(\vxo^*,t_0))}{|\vxo^*(\vx,t)-\vxs(t_0 - \tau(\vxo^*,t_0))|} =  \frac{\vx-\vxo^*(\vx,t)}{|\vx-\vxo^*(\vx,t)|}
}
is satisfied.
This means that the stationary point is given, where the local propagation direction of the spherical wavefront generated by the moving source at $t_0-\tau(\vxo^*,t_0)$, measured on the boundary at $t_0$ coincides with that of the spherical wavefront of the stationary point source, measured at position $\vx$.
Geometrically this point lies at the intersection of the boundary and the vector pointing from the moving point source at the emission time to the receiver position.

Having found the general stationary point for the Kirchhoff integral for a moving source the vertical integration can be approximated by the SPA.
Similarly to the stationary case, choosing the plane of investigation to $\vx = \posvec{3}{x}{y}{0}$ implicitly fixes the vertical stationary position to lie independently from the receiver time at $z_0^*(\vx,t) \rightarrow z_0^* = 0$.
Due to the definition of the stationary point for moving sources \eqref{Eq:Moving_sources:moving_source_stat_point} this requirement is trivially satisfied by sound sources moving along trajectories fixed to the plane of investigation, therefore in the following only in-plane source trajectories are considered, described by $\vxs(t) = \posvec{3}{x_s(t)}{y_s(t)}{0}$.

%In order to evaluate the vertical integral, the second phase derivative of the integrand \eqref{Eq:SFS_theory:Kirchhoff_spec_geom_td_2} is required around the vertical stationary point.
With the source trajectory fixed to $z_0=0$ and the receiver position fixed to the plane of investigation $z = 0$ the second phase derivative around the stationary point simplifies to terms of the source-boundary and boundary-receiver point distances, reading
\begin{equation}
\label{Eq:Moving_sources:MS_second_phase_der}
\left. \frac{\partial^2 }{\partial z_0^2 }\phi^P(\vxo,t-\Tret,\omega_0) \right|_{z_0 = z_0^* = 0} = 
- \frac{\omega(\vxo,t_0)}{c}\left( \frac{1}{|\vxo - \vxs(t_e)|} + \frac{1}{|\vx-\vxo|} \right),
\end{equation} 
with $t_0 = t - \Tret$ being the boundary emission time, $t_e = t - \Tret - \tau(\vxo,t_0)$ the source emission time and $\omega(\vxo,t_0)$ the perceived angular frequency given by \eqref{eq:HF_appr:moving_s_per_freq} along the boundary surface.
Similarly to the stationary case (c.f. \eqref{Eq:SFS_theory:Curvatures_Addition}), the second phase derivative is given by the sum of the vertical curvatures of the primary sound field and the Green's function measured on the boundary.

Finally---by taking the negative sign of \eqref{Eq:Moving_sources:MS_second_phase_der} into consideration---the stationary phase approximation of integral \eqref{Eq:SFS_theory:Kirchhoff_spec_geom_td_2} yields the \emph{2.5D Kirchhoff integral for a moving source}:
\importantmline{Moving source 2.5D Kirchhoff approx.}{
P(\vx,t,\omega_0) =
\oint_{C} 2 w(\vxo,t_0 ) 
\sqrt{\frac{2\pi}{\ti\frac{\omega(\vxo,t_0)}{c}}}
\sqrt{\frac{|\vx-\vxo|\cdot|\vxo - \vxs(t_e)|}{|\vx-\vxo|+|\vxo - \vxs(t_e)|}} \cdot \\ \cdot
 \ti k_{\mathrm{n}}^P(\vxo,t_0)  	
\frac{1}{4\pi}
\frac{P(\vxo,t_0,\omega_0) }{|\vx-\vxo|}\, \td s(x_0, y_0),
\label{Eq:SFS_theory:25D_KI_moving_source_a}
}
now $\vx = \posvec{3}{x}{y}{0}$ and $\vxo = \posvec{3}{x_0}{y_0}{0}$ denoting in-plane positions.

\subsection{2.5D Wave Field Synthesis of a moving point source}

In order to extract the implicit driving function from the Kirchhoff integral it is exploited, that all the time variables in \eqref{Eq:SFS_theory:25D_KI_moving_source_a} are present with a constant temporal shift $t-\Tret$.
The integral therefore can be reformulated in terms of a temporal convolution with the 3D time domain Green's function as
\begin{multline}
P(\vx,t,\omega_0) =
\oint_{C}  \int_{t_0} 2 w(\vxo,t_0 ) 
\sqrt{\frac{2\pi}{\ti\frac{\omega(\vxo,t_0)}{c}}}
\sqrt{\frac{|\vx-\vxo|\cdot|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}{|\vx-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}} \cdot \\ %\cdot
 \ti k_{\mathrm{n}}^P(\vxo,t_0) P(\vxo,t_0,\omega_0)
\underbrace{\frac{1}{4\pi} \frac{ \delta(t-t_0- \Tret) }{|\vx-\vxo|}}_{g(\vx-\vxo,t-t_0)}
\, \td t_0 \, \td s(x_0, y_0).
\label{Eq:SFS_theory:25D_KI_moving_source_2}
\end{multline}
Comparison with the time domain SFS problem \eqref{eq:moving_source:SFS_problem_td} reveals that this formulation implicitly contains the time domain 2.5D WFS driving function for a harmonic moving source, being dependent on the receiver position.
The dependency may be resolved by exploiting that the contour integral is dominated by its horizontal stationary point, defined by \eqref{Eq:Moving_sources:moving_source_stat_point}, therefore the amplitude correction factor can be substituted by its stationary value $\vxo \rightarrow \vxo^*(\vx)$.
Furthermore, the role of the stationary SSD position and the receiver position may be interchanged by letting the SSD position $\vxo$ to be the independent variable.
This results in SSD position dependent receiver points, termed as reference position $\vxo^*(\vx) \leftrightarrow \vxref(\vxo)$.
The extracted driving function then reads as
\importantmline{2.5D WFS moving source harmonic driv. fun.}{
D(\vxo,t_0,\omega_0) =
\underbrace{ \sqrt{\frac{2\pi |\vxref(\vxo,t_0)-\vxo|}{\ti\frac{\omega(\vxo,t_0)}{c}}}}_{{\substack{\text{SSD}\\\text{compensation}}}}
\underbrace{\sqrt{\frac{|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}}_{{\substack{\text{virtual source}\\\text{compensation}}}} 
\cdot \\ %\cdot
\underbrace{2 w(\vxo,t_0) \ti k_{\mathrm{n}}^P(\vxo,t_0) P(\vxo,t_0,\omega_0)}_{\substack{\text{2D}\\\text{driving function}}},
\label{Eq:SFS_theory:25D_KI_moving_source}
}
with $\tau(\vxo,t_0)$ being the propagation time delay from the moving source position at the emission time to the actual SSD position, having to be evaluated for each SSD position at each time instant.
The reference position and the SSD position are connected by \eqref{Eq:moving_sources:moving_point_stat_point_1}, reading as
\begin{align}
\label{Eq:SFS_theory:25D_WFS_ref_point}
\hat{\vk}^P(\vxo,t_0) &= \hat{\vk}^G(\vxref(\vxo,t_0)-\vxo),
\\
\frac{\vxo -\vxs(t_0-\tau(\vxo,t_0))}{|\vxo-\vxs(t_0 - \tau(\vxo,t_0))|} &=  \frac{\vxref(\vxo,t_0)-\vxo}{|\vxref(\vxo,t_0)-\vxo|}.
\end{align}

The driving function above is a straightforward generalization of the 2.5D WFS driving function \eqref{Eq:SFS_theory:25D_WFS_driv_fun_ver_2} towards non-stationary sound fields, consisting of the ideal 2D WFS driving function along with two dimensionality correction factors:
\begin{itemize}
\item The secondary source correction factor compensates for the attenuation factor and the frequency response of the 2D SSD contour.
Again, the attenuation correction can be optimized to a predefined distance for each SSD element, allowing the referencing of the synthesis on a prescribed reference curve.
The frequency correction term compensates for the half-integrator nature of 2D SSD, which, along with the differentiation in the driving function, would result in enhanced high-pass characteristics.
As a local/asymptotic approximation the correction is performed by the instantaneous perceived angular frequency altered by the Doppler shift, as measured along the SSD.
\item The virtual source correction factor corrects the synthesized field amplitude at the receiver position from a 2D to a 3D one.
As it was expressed by \eqref{Eq:Moving_source:attenuation} and \eqref{Eq:Moving_source:attenuation_2}---regardless of the instantaneous spatial distribution---a 3D wavefront attenuates inversely proportional to its mean curvature along its propagation path.
For the case of a moving point source the corresponding mean radius is obviously the distance from the source at the emission time and the point of investigation.
Hence, the virtual source compensation factor matches the amplitude factor of the \emph{synthesized wavefront} to the \emph{target wavefront} (rather than the amplitude distribution) by taking the wavefront propagation dynamics into consideration.
\end{itemize}
Similarly to the stationary case, referencing the synthesis can be done by prescribing an arbitrary reference curve $\vxref$ being independent of time and expressing the SSD and virtual source compensation factors, so that the reference/stationary points for each SSD element $\vxref(\vxo,t_0)$ lie along the reference curve, and satisfy \eqref{Eq:SFS_theory:25D_WFS_ref_point}.
Obviously, in a general case due to the source motion the reference position for an arbitrary SSD element varies with time, thus $\vxref(\vxo,t_0)$ has to be found for each SSD element at each time instant.
This requires the a-priori calculation of the moving source position at the emission time.
In a Section \ref{Sec:Trajectory_calc} it is discussed, how these computational expensive problems can be solved numerically.
\begin{figure}  
\small
  \begin{minipage}[c]{0.64\textwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/25D_WFS_ms.png}
	\small
	\put(2,53){(a)}
	\put(2,1){(b)}
	\end{overpic}   \end{minipage}\hfill
	\begin{minipage}[c]{0.35\textwidth}
    \caption{2.5D synthesis of a moving 3D point source radiating at $f_0 = 1.5~\mathrm{kHz}$ applying an arbitrary shaped SSD.
    The source is under uniform motion with the source trajectory given by $\vxs = \posvec{3}{1.85+v_x \cdot t}{3.2+v_y \cdot t}{0}$ with $|\mathbf{v}| = 150~\mathrm{m/s}$ and $v_x = 140~\mathrm{m/s}, v_y = 98~\mathrm{m/s}$. 
    The synthesis is referenced on a concentric reference contour, denoted by white dots.
    The snapshot is taken at $t = 0~\mathrm{s}$. 
    Figure (a) depicts the real part of the synthesized field and part (b) presents the absolute error of synthesis in a logarithmic scale.
	The active arc of the SSD \emph{at the time instant $t = 0~\mathrm{s}$} is denoted by solid black line, and the inactive part with dotted by black line.
	In order to ensure a smooth driving function, the referencing function is extrapolated.
    }
\label{fig:SFS_theory:25D_WFS_moving_source}  \end{minipage}
\end{figure}

Once the source position and reference position has been found for each SSD element at each time instant, the driving function on a single source frequency component \eqref{Eq:SFS_theory:25D_KI_moving_source} can be evaluated.
For a wideband excitation with the frequency content $S(\omega) = \int_{-\infty}^{\infty} s(t) \te^{-\ti \omega t} \td t$, the driving function is obtained by summing the individual spectral components.
The perceived frequency is expressed in terms of the source's angular frequency according to \eqref{eq:HF_appr:moving_s_per_freq}, resulting in the inverse Fourier integral
\begin{multline}
\small
d(\vxo,t_0,\omega_0) =2 w(\vxo,t_0) 
\sqrt{\frac{\Delta(\vxo,t_0-\tau(\vxo,t_0))}{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}
\cdot \\ %\cdot
 \int_{-\infty}^{\infty} S(\omega_0)
\sqrt{\frac{2\pi |\vxref(\vxo,t_0)-\vxo|}{\ti \frac{\omega_0}{c} }}
\ti k_{\mathrm{n}}^P(\vxo,t_0) P(\vxo,t_0,\omega_0) \td \omega_0.
\end{multline}
Expressing both the moving source's pressure field and its local wavenumber vector explicitly results in the expression
\begin{multline}
\small
d(\vxo,t_0,\omega_0) = w(\vxo,t_0) 
\sqrt{\frac{|\vxref(\vxo,t_0)-\vxo| }{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}
\cdot \\ %\cdot
\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni \right>
\int_{-\infty}^{\infty} S(\omega_0)
\sqrt{\frac{\ti \frac{\omega_0}{c}}{2\pi}}
\frac{\te^{\ti \omega_0\left( t_0 - \tau( \vxo,t_0 )\right)}}{\Delta(\vxo,t_0-\tau( \vxo, t_0 ))^{\frac{3}{2}}}
 \td \omega_0
\end{multline}
The integral can be recognized as the inverse Fourier transform of the pre-filtered source time history, taken at $t_0 - \tau( \vxo,t_0 )$.
Similarly to the stationary case the source signal is pre-equalized with a half-differentiator filter with the transfer function described by $H(\omega) = \sqrt{\ti \omega}$, compensating for the 2D SSD contour frequency response.
The time domain driving function for the synthesis of a moving point source with a wideband excitation signal reads as
\importantmline{2.5D WFS moving source driv. fun.}{
\small
d(\vxo,t_0,\omega_0) = w(\vxo,t_0) 
\sqrt{\frac{|\vxref(\vxo,t_0)-\vxo| }{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}
\cdot \\ %\cdot
\left< \vxo -\vxs(t_0-\tau(\vxo,t_0)) \cdot \vni \right>
\sqrt{\frac{1}{2\pi c}}
\frac{ s^{\nshortmid}_t(t_0 - \tau( \vxo,t_0 )) }{\Delta(\vxo,t_0-\tau( \vxo, t_0 ))^{\frac{3}{2}}},
\label{Eq:Moving_source:25D_WFS}
}
where the prefiltered input signal is given by $ s^{\nshortmid}_t(t) = h(t) \ast_{t} s(t)$, with the pre-equalization filter's impulse response given by $h(t) = \mathcal{F}^{-1}_{\omega}\left\{ \sqrt{\ti \omega} \right\}$.
Note that unlike for the stationary case, here the order of pre-filtering and delaying of the excitation signal is not interchangeable due to the time-dependent propagation time delay.

The driving function is capable of the synthesis of a source under motion, with an arbitrary source trajectory and velocity profile applying an arbitrary SSD contour, with ensuring optimized synthesis on an arbitrary shaped reference contour.
The synthesis in such a general scenario is depicted in Figure \ref{fig:SFS_theory:25D_WFS_moving_source}, illustrating the reproduction of a source, moving along a straight trajectory.
%The calculation of the general driving functions are however of a great computational complexity.
%In the following sections it will be discussed, how evaluation may be approximated allowing real-time implementation.
In this case the parametrization of the SSD contour and the reference contour is available, along with an analytically known source trajectory, closed form analytical driving function may be expressed, as discussed in the following example.

\subsection*{Application example: Synthesis of a uniformly moving source applying a linear SSD}

As a simple example the reproduction of a point source under uniform motion is investigated, applying a linear SSD and optimizing the synthesis on a reference line.
The importance of the example lies in the fact that for this geometry the analytical explicit solution is also known---presented in the following section---allowing the direct comparison of the implicit and explicit methodologies for this non-stationary scenario.

\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/25D_WFS_linear_SSD.png}
	\small
	\put(0, 0){(a)}
	\put(47,0){(b)}	
	\end{overpic}   
    \caption{2.5D synthesis of a moving 3D point source located at $\vxs(t) = \posvec{3}{1.5 + v\cdot t}{-2}{0}$ with $v = \frac{3}{4}c$, radiating at $f_0 = 1~\mathrm{kHz}$ with the reference line set at $y_{\mathrm{ref}} = 1.5~\mathrm{m}$.
    Figure (a) depicts the real part of the synthesized field, (b) shows the error of synthesis.
    }
\label{fig:Moving_sources:25D_WFS_linear_ssd}  
\end{figure}
For the sake of simplicity the source is chosen to move uniformly along the $x$-axis with a trajectory given by $\vxs = \posvec{3}{x_s + v\cdot t}{y_s}{0}$, oscillating at the angular frequency $\omega_0$.
The infinite linear SSD is located at $\vxo = \posvec{3}{x_0}{0}{0}$ and the reference line is set to $\vxref = \posvec{3}{x}{\yref}{0}$.
For this geometry the windowing function is identically $w(\vx,t_0) \equiv 1$ and the driving function from \eqref{Eq:SFS_theory:25D_KI_moving_source} reads as
\begin{multline}
\displaystyle
D(\vxo,t_0,\omega_0) =
\sqrt{\frac{8\pi }{\ti\frac{\omega_0}{c}}} \cdot \\
\sqrt{\frac{|\vxref(\vxo,t_0)-\vxo| \cdot \Delta(t_0-\tau(\vxo,t_0))}{|\vxref(\vxo,t_0)-\vxo|+|\vxo - \vxs(t_0-\tau(\vxo,t_0))|}}
\ti k_y^P(\vxo,t_0) P(\vxo,t_0,\omega_0).
\end{multline}
The reference distance $|\vxref(\vxo,t_0)-\vxo|$ can be expressed by the definition of the stationary position \eqref{Eq:SFS_theory:25D_WFS_ref_point} written merely for the $y$-coordinates
\begin{equation}
%\hat{\vk}^P(\vxo,t_0) &= \hat{\vk}^G(\vxref(\vxo,t_0)-\vxo)
%\\
|\vxref(\vxo,t_0)-\vxo| =  -\frac{\yref}{y_s(t_0-\tau(\vxo,t_0))}|\vxo-\vxs(t_0 - \tau(\vxo,t_0))|.
%\end{align}
\end{equation}
%and the referencing function reads as
%\begin{equation}
%\dref(\vxo,t_0) = \sqrt{ \Delta(t_0-\tau(\vxo,t_0))\frac{ \yref }{\yref-y_s(t_0-\tau(\vxo,t_0))}}.
%\end{equation}
Finally expressing the radiated field and its local wavenumber vector explicitly and exploiting that $y_s$ is constant yields the driving function
\begin{equation}
D(\vxo,t_0,\omega_0) = -
\sqrt{\frac{ \ti k_0}{2\pi} }
\sqrt{\frac{ \yref }{\yref-y_s}}
y_s
\frac{\te^{\ti \omega_0\left( t_0 - \tau( \vxo,t_0 )\right)}}{\Delta(\vxo,t_0)^{\frac{3}{2}}},
\label{Eq:Moving_sources:25D_WFS_linear_ssd}
\end{equation}
with the propagation time delay and the attenuation factor given by \eqref{fig:Moving_sources:tau_uniform} and \eqref{fig:Moving_sources:delta_uniform} respectively.
%\begin{equation}
%\tau(\vxo,t_0) = \frac{M (x_0 - v t_0 - x_s )+\Delta(\vxo,t_0)}{c (1-M^2)} 
%\end{equation}
%and the amplitude distribution
%\begin{equation}
%\Delta(\vxo,t_0) = \sqrt{(x_0 - v t_0 - x_s)^2 + y_s^2(1-M^2)}.
%\end{equation}
The time domain driving function for a source excitation time history $s(t)$ is given by the inverse Fourier transform of \eqref{Eq:Moving_sources:25D_WFS_linear_ssd} with respect to $\omega_0$, reading 
\begin{equation}
d(\vxo,t_0) = -
\sqrt{\frac{ 1 }{2\pi c} }
\sqrt{\frac{ \yref }{\yref-y_s}}
y_s
\frac{s^{\nshortmid}_t(t_0 - \tau( \vxo,t_0 ))}{\Delta(\vxo,t_0)^{\frac{3}{2}}},
\label{Eq:Moving_sources:25D_WFS_linear_ssd_td}
\end{equation}
where $s^{\nshortmid}_t(t) = h(t) \ast_{t} s(t)$, with $h(t) = \mathcal{F}^{-1}_{\omega}\left\{ \sqrt{\ti \omega} \right\}$.

The result of synthesis is illustrated in Figure \ref{fig:Moving_sources:25D_WFS_linear_ssd}, verifying that the presented driving function optimizes the synthesis along the reference line.
Comparison with \eqref{eq:SFS_theory:WFS_point_source} reveals that the moving source driving function formally coincides with the traditional WFS driving function given for a stationary point source \cite[(2.27)]{Verheijen1997:phd}, \cite[(3.16)\&(3.17)]{Start1997:phd} with the stationary distances, delays and amplitude factor changed for the corresponding dynamic variables.

The above driving function can be easily extended for sources moving inclined to the SSD the driving function with the substitution of a space-time dependent source position $y_s \rightarrow y_s(t_0 - \tau(\vxo,t_0))$ as discussed in details in \cite{firtha2016wave}.
In this case, however, the moving source crosses the theoretically infinite SSD resulting in singular driving function at the time instant of the crossing, and converging virtual wavefronts afterwards.
The synthesis of this type of focused moving sources is not investigated in the present thesis.

\section{Explicit solution for the synthesis of moving sources}

So far only the time domain and a mixed time-frequency domain representations of moving sources were discussed, applied directly for WFS of sources under motion.
For the special case of sources under uniform motion the frequency domain and wavenumber domain representations of the radiated sound field can be expressed analytically, by applying the Fourier theorem for a non-stationary convolution.

\subsection{Spectral representation  of moving sources}

Assume a harmonic source moving along a straight trajectory parallel with the $x$-axis (i.e. the source position time history is given by $\vxs(t) = \posvec{3}{x_s + v \cdot t}{0}{0}$), radiating with a wide-band excitation time history $s(t)$.
According to \eqref{eq:moving_source:non_stat_convolution} the radiated field can be written in the form of a convolution with the kernel being the moving source Green's function
\begin{equation}
p_{\mathrm{m}}(\vx,t) = \int_{\tE} g_{\mathrm{m}}(x - x_s-v\cdot\tE ,y,z,t-\tE) s(\tE) \td \tE,
\end{equation}
with $t_e$ being the emission time and $g_{\mathrm{m}}$ representing the retarded Green's function.
Comparison with \eqref{Eq:App:Non_stat_conv_td} reveals that the radiated field is written in terms of a non-stationary convolution, for which the spectral representation is known, given by \eqref{Eq:App:Non_stat_conv_fd}.
By applying the Fourier shift theorem (by a factor of $x-x_s$) and the scaling theorem (by $v$) to \eqref{Eq:App:Non_stat_conv_fd} the spectrum of the radiated field is given by
\begin{equation}
P_{\mathrm{m}}(\mathbf{x},\omega) = \frac{1}{v} 
\int_{-\infty}^{\infty} S(\omega_0)
\tilde{G}(\frac{\omega-\omega_0}{v}, y, z, \omega)
\te^{-\ti \frac{\omega-\omega_0}{v} \left(x-x_s\right)} \td \omega_0.
\label{Eq:Moving_sources:Freq_domain_representation_wb_excit}
\end{equation}
%
\begin{figure}[b!]
\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/moving_source_spectrum.png}
	\put(0,1){(a)}
	\put(48,1){(b)}
	\end{overpic}   
    \caption{The time history and spectrum of a moving source pass-by, moving on a trajectory $\vxs(t) = \posvec{3}{v\cdot t}{-2}{0}$ with $v = \frac{c}{2}$, measured at the origin.
    Both, the time history and spectrum are normalized by the source frequency.
    The spectrum is described by the Hankel function as given by \eqref{Eq:Moving_sources:Freq_domain_representation}.
    The poles/singularities of the spectrum are the \emph{dominant frequencies} of the approaching ($t \rightarrow -\infty$) and the diverging ($t \rightarrow \infty$), given by \eqref{eq:HF_appr:moving_s_per_freq} as $\omega_d = \omega_0 \frac{1}{1 \pm M}$, with $M = \frac{v}{c}$ being the Mach number.
    }
\label{fig:Moving_sources:moving_source_field_spectrum}  
\end{figure}
%
Hence, the radiated field in the spectral domain is obtained by a non-stationary convolution as well.
Since integration is performed over the frequency content of the source input signal $S(\omega_0)$, the weighting kernel can be recognized as the frequency content of a moving source pass-by, radiating at a single frequency component $\omega_0$.
The field of a harmonic moving source is therefore given by
\importanteq{Moving source in $\vx-\omega$ domain}{
P_{\mathrm{m}}(\mathbf{x},\omega,\omega_0) =
\frac{1}{v}
\tilde{G}(\frac{\omega-\omega_0}{v}, y, z, \omega)
\te^{-\ti \frac{\omega-\omega_0}{v} \left(x-x_s\right)},
\label{Eq:Moving_sources:Freq_domain_representation}
}
with the Green's function's wavenumber content given in Table \ref{tab:theory:Greens_fun_representations} as
\begin{equation}
\tilde{G}(\frac{\omega-\omega_0}{v}, y, z, \omega) = -\frac{\ti}{4} H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2} y \right).
\end{equation}
The equation states that the frequency domain representation of a moving point source pass-by at a given receiver point is completely described by its 1D spatio temporal spectrum $\tilde{G}(k_x,y,z,\omega)$ with the substitution $k_x \rightarrow \frac{\omega-\omega_0}{v}$.
This is the immediate consequence of the fact that in the present geometry the time history of the measured pass-by is invariant along the $x$-axis up to a constant time delay. 
%
The time history of a uniformly moving source pass-by and the corresponding angular spectrum is illustrated in Figure \ref{fig:Moving_sources:moving_source_field_spectrum}.
\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/Moving_source_kxw.png}
	\put(0,1){(a)}
	\put(48,1){(b)}
	\end{overpic}   
    \caption{Spectrum of a stationary (a) and moving (b) harmonic source in the $k_x-\omega$ domain.
    In the dynamic case the source is moving with a constant velocity, $v = \frac{c}{2}$.}
\label{fig:Moving_sources:moving_source_kxw}  
\end{figure}

\vspace{3mm}
Due to the spatio-temporal invariance of the spectrum \eqref{Eq:Moving_sources:Freq_domain_representation} along the $x$-dimension, the spatial Fourier transform is straightforward, yielding
\importanteq{Moving source in $k_x-z$ domain}{
\tilde{P}_{\mathrm{m}}(k_x,y,z,\omega,\omega_0) =
\frac{2\pi}{v}
\tilde{G}(\frac{\omega-\omega_0}{v}, y, z, \omega)
\te^{\ti \frac{\omega-\omega_0}{v} x_s}
 \delta(k_x - \frac{\omega-\omega_0}{v}).
\label{Eq:Moving_sources:MS_field_kx_z}
}
The angular spectrum representation (i.e. $k_x-y-k_z$ representation) is given as
\importanteq{Moving source in $k_x-k_z$ domain}{
\tilde{P}_{\mathrm{m}}(k_x,y,k_z,\omega,\omega_0) =
\frac{2\pi}{v}
\tilde{G}(\frac{\omega-\omega_0}{v}, y, k_z, \omega)
\te^{\ti \frac{\omega-\omega_0}{v} x_s}
 \delta(k_x - \frac{\omega-\omega_0}{v}).
\label{Eq:Moving_sources:MS_field_kx_kz}
}
Note that the representation does not pose any constraint on the actual form of the Green's function, the above equations theoretically describe the field of an arbitrary source under uniform motion.	

The spectral $k_x-\omega$ domain representation of a moving source field is depicted in Figure \ref{fig:Moving_sources:moving_source_kxw} (b), allowing the comparison with  a stationary source.
In both cases the amplitude distribution of the spectra are described by the wavenumber content of the Green's function, $\tilde{G}(k_x,y,z,\omega)$.
It is illustrated that bringing a sound source into uniform motion will result in the rotation of its spectrum around $k_x = 0$ and rescaling in order to fill the propagation region.
The amount of rotation is given directly by the source velocity (the angle of rotation is $\frac{\pi}{2} \cdot \frac{v}{c}$).

The above spectral formulations can be extended for sources moving inclined to the $x$-axis, as given in Appendix \ref{App:Moving_source_representations}.
These formulations may be applied for deriving implicit and explicit driving functions for virtual sources moving uniformly along arbitrary directed straight trajectories, as it is discussed in details in \cite{firtha2015sound}.
Since, however, the previous section presented a more general methodology for the reproduction of sources under arbitrary motion, it is sufficient to restrict the investigation of the explicit SFS methodology for sources moving parallel with the $x$-axis, resulting in closed form analytic formulations.

\subsection{3D Spectral Division Method for moving sources}

The spectral representations given in the foregoing allows the derivation of explicit SFS driving function for the synthesis of moving sources.
The following driving functions are specialized to the case of sources under uniform motion, reproduced by planar and linear SSDs in contrary to WFS, allowing the reproduction of moving sources in a general geometry.
Still, the importance of the explicit solution is that it constitutes a reference solution for the synthesis problem, and allows the investigation of aliasing artifacts in the following.

Assuming an infinite planar distribution of secondary sources along the plane $\vxo = \posvec{3}{x_0}{0}{z_0}$, the explicit driving function in the $k_x-k_z$ domain is given by the angular spectrum representation of the field generated by a moving source \eqref{Eq:Moving_sources:MS_field_kx_kz} substituted into the general 3D explicit driving function \eqref{Eq:Theory:Planar_explicit_driv_fun}
\begin{equation}
D(k_x,k_z,\omega) = \frac{2 \pi }{v} \frac{
\tilde{G}(\frac{\omega-\omega_0}{v}, y-y_s, k_z, \omega)
}{ \tilde{G}(k_x, y, k_z, \omega) } 
\te^{\ti \frac{\omega-\omega_0}{v} x_s}
 \delta(k_x - \frac{\omega-\omega_0}{v}),
\end{equation}
with $k_y = \sqrt{\left( \frac{\omega}{c} \right)^2 - k_x^2 - k_z^2}$.
The spatial driving function is obtained from the double inverse Fourier transform of the wavenumber domain driving function.
Integration along $k_x$ can be evaluated analytically, with the Dirac delta sifting out $k_x = \frac{\omega-\omega_0}{v}$.
Hence, in the spatial domain the driving function takes the form
\begin{equation}
D(x_0,z_0,\omega) = 
\frac{1}{2\pi}
\int_{-\infty}^{\infty}
\frac{1}{v} \frac{
\tilde{G}(\frac{\omega-\omega_0}{v}, y-y_s, k_z, \omega)
}{ \tilde{G}(\frac{\omega-\omega_0}{v}, y, k_z, \omega) } 
\te^{-\ti \frac{\omega-\omega_0}{v} (x_0-x_s)} 
\te^{-\ti k_z z_0}
\td k_z.
\end{equation}
Substituting the explicit formula for the 3D Green's function's angular spectrum representation, as given in Table \ref{tab:theory:Greens_fun_representations} allows simplification by $\sqrt{\left( \frac{\omega}{c} \right)^2 - \left( \frac{\omega-\omega_0}{v}\right)^2 - k_z^2}$ and division of the exponentials, making the driving function independent from the $y$-coordinate.
\begin{equation}
D(x_0,z_0,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \frac{1}{v}
\underbrace{\te^{-\ti \sqrt{\left( \frac{\omega}{c} \right)^2 -  \left(\frac{\omega-\omega_0}{v}\right)^2 - k_z^2} |y_s|}}_
{-2 \frac{\partial}{\partial y} \left. \frac{\te^{-\ti \sqrt{\left( \frac{\omega}{c} \right)^2 -  \left(\frac{\omega-\omega_0}{v}\right)^2 - k_z^2} |y-y_s|}}{-\ti \sqrt{\left( \frac{\omega}{c} \right)^2 -  \left(\frac{\omega-\omega_0}{v}\right)^2 - k_z^2}} \right|_{y=0} }
\te^{-\ti k_z z_0} \td k_z
 \te^{-\ti \frac{\omega-\omega_0}{v} (x_0-x_s) }.
\end{equation}
The integrand can be recognized as a multiple of the $y$-derivative of the Green's function, taken on the SSD (cf. Table \ref{tab:theory:Greens_fun_representations}).

\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/Planar_SDM.png}
	\small
	\put(0, 0){(a)}
	\put(47,0){(b)}
	\end{overpic}
\caption{
Synthesis of a moving virtual point source using a planar SSD applying the SDM driving function.
The SSD is located at $\vxo = [x_0,\ 0,\ z_0]^{\mathrm{T}}$ denoted by solid black line. 
The virtual source is located at $\vxs(t) = [1.5 + v\cdot t,\ -2,\ 0]^{\mathrm{T}}$ with $v = \frac{3}{4} c$, oscillating at $f_0 = 1 ~\mathrm{khz}$.
The figures depict the real part of the synthesized field (a) and the deviation from the target sound field (b) measured at $z=0$.}
	\label{Fig:Moving_sources:moving_synthesis_by_planar_SDM}
\end{figure}
Hence, evaluating the integration with respect to $k_z$ results in the frequency domain explicit driving function
\begin{equation}
D(x_0,z_0,\omega,\omega_0) = -\frac{2}{v}
\left. \frac{\partial}{\partial y}  \tilde{G}(\frac{\omega-\omega_0}{v}, y-y_s, z_0, \omega) \right|_{y=0}
 \te^{-\ti \frac{\omega-\omega_0}{v} (x_0-x_s) }.
\end{equation}
This formulation describes the $y$-derivative of the field of a moving point source.
From the mixed time-frequency formulation this can be expressed as
\importanteq{3D SDM driv. fun.}{
D(x_0,z_0,t,\omega_0) = 
- \frac{1}{2\pi}
\frac{y_s}{\Delta(\vxo,t_0)}\left( \frac{1-M^2}{\Delta(\vxo,t_0)} + \ti k_0 \right)
\frac{\te^{\ti \omega_0\left( t_0 - \tau( \vxo,t_0 )\right)}}{\Delta(\vxo,t_0)},
}
with $\tau(\vxo,t_0)$ and $\Delta(\vxo,t_0)$ given by \eqref{fig:Moving_sources:tau_uniform} and \eqref{fig:Moving_sources:delta_uniform}, respectively.
%

The result of synthesis applying the above driving function is depicted in Figure \ref{Fig:Moving_sources:moving_synthesis_by_planar_SDM}, verifying that applying an infinite planar SSD perfect synthesis can be achieved in front of the SSD.
Obviously, the explicit driving function coincides with the implicit solution for the same SSD geometry, without applying the high frequency gradient approximation.

\subsection{2.5D Spectral Division Method for moving sources}

Applying the wavenumber domain formulation of the field generated by a uniformly moving source the explicit driving function for an infinite linear SSD may be obtained.
As discussed in the foregoing, the application of a linear SSD allows the synthesis of a source distribution located at the plane of the SSD and the reference line, hence in the following 
the investigation is fixed to the plane of synthesis at $z=0$.

As the simplest case the virtual source moves parallel to the SSD, with the source position given as $\vxs(t) = \posvec{3}{v\cdot t}{y_s}{0}$, with $y_s<0$, oscillating at $\omega_0$. 
The SSD is a linear set of 3D point sources, located along $\vxo = \posvec{3}{x_0}{0}{0}$.
The general 2.5D explicit driving function for a linear SSD is given by \eqref{Eq:SFS_Theory:LinearSDM_spectral}, with in the present case the required wavenumber content of the virtual field is given by \eqref{Eq:Moving_sources:MS_field_kx_z}.
By applying this formulation the wavenumber domain driving function, optimizing the synthesis on a line, parallel with the SSD is expressed as
\begin{equation}
\tilde{D}(k_x,\omega,\omega_0) = 
\frac{2\pi}{v}
\frac{ 
\tilde{G}(\frac{\omega-\omega_0}{v}, \yref-y_s, 0, \omega)
}{\tilde{G}(k_x,\yref,0, \omega)} \,
 \delta(k_x - \frac{\omega-\omega_0}{v}) \, 
\te^{\ti \frac{\omega-\omega_0}{v} x_s},
\label{Eq:Moving_source:kx_driv_fun}
\end{equation}
with $\yref$ being the $y$-position of the reference line.
The spatial representation of the driving function is obtained by a spatial inverse Fourier transform of the above expression.
Unlike in the stationary case, due to the spatial invariancy of the virtual source field (up to a phase shift) the inverse transform may be evaluated analytically by exploiting the Dirac delta sifting property, resulting in 
\begin{equation}
D(x_0,\omega,\omega_0) = 
\frac{1}{v}
\frac{ 
\tilde{G}(\frac{\omega-\omega_0}{v}, \yref-y_s, 0, \omega)
}{\tilde{G}(\frac{\omega-\omega_0}{v},\yref,0, \omega)}
\te^{-\ti \frac{\omega-\omega_0}{v} (x_0 - x_s)}.
\end{equation}
Expressing $\tilde{G}(k_x,y,z=0,\omega)$ explicitly yields the final 2.5D SDM driving function
\importanteq{2.5D SDM driving function}{
D(x_0,\omega,\omega_0) = 
\frac{1}{v}
\frac{ 
H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2} |\yref - y_s| \right)
}{
H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2} |\yref| \right)
}
\te^{-\ti \frac{\omega-\omega_0}{v} (x_0 - x_s)}.
}
For a moving source with wide-band excitation signal $s(t)$ the explicit driving function reads as
\begin{equation}
D(x_0,\omega) = 
\frac{1}{2 \pi v}
\int_{\infty}^{\infty} S(\omega_0)
\frac{ 
H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2} |\yref - y_s| \right)
}{
H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2} |\yref| \right)
}
\te^{-\ti \frac{\omega-\omega_0}{v} (x_0 - x_s)} \td \omega_0,
\end{equation}
where $S(\omega) = \int_{-\infty}^{\infty} s(t)\te^{-\ti \omega t} \td t$ is the temporal spectrum of the source excitation.


\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/Linear_SDM.png}
	\footnotesize
	\put(0, 0){(a)}
	\put(45,0){(b)}
	\end{overpic}
\caption{Synthesis of a uniformly moving virtual point source employing a linear SSD applying the 2.5D SDM driving function.
The SSD is located at $\vxo = [x_0,\ 0,\ 0]^{\mathrm{T}}$, denoted by a solid black line. 
The virtual source is located at $\vxs(t) = [v\cdot t + 1.5,\ -2,\ 0]^{\mathrm{T}}$ with $v = \frac{3}{4}c$ oscillating at $f_0 = 1 ~\mathrm{kHz}$. 
The reference line was set to $\yref = 1.5~\mathrm{m}$.
The figure depicts the synthesized field at the synthesis plane ($z = 0$) with (a) depicting the real part of the synthesized field, (b) depicting the error of synthesis.}
	\label{Fig:Moving_sources:moving_synthesis_by_linear_SDM}
\end{figure}

The result of synthesis applying the explicit driving function in case of a harmonic moving source is depicted in \eqref{Fig:Moving_sources:moving_synthesis_by_linear_SDM}.
It is verified that the explicit method theoretically ensures perfect synthesis along the reference line, therefore it may serve as a reference solution.

Assuming high frequency conditions the Hankel function can be approximated by its asymptotic expansion as given by \eqref{Eq:HF_approx:Hankel_asymptotic_form}.
Applying the formulation the spectral division can be carried out analytically, resulting in the approximate driving function
\importanteq{Approximate 2.5D SDM driv. fun.}{
D(x_0,\omega,\omega_0) = 
\frac{1}{v}
\sqrt{\frac{\yref}{\yref- y_s}}
\te^{-\ti \sqrt{ \left(\frac{\omega}{c}\right)^2 - \left( \frac{\omega-\omega_0}{v} \right)^2}|y_s|}
\te^{-\ti \frac{\omega-\omega_0}{v} (x_0 - x_s)}.
}
This formulation coincides with the implicit Wave Field Synthesis driving function for a moving source, derived entirely in the spectral domain: 
the frequency domain representation of a moving source \eqref{Eq:Moving_sources:Freq_domain_representation} allows an alternative derivation of the 2.5D WFS driving function by applying the stationary phase approximation entirely in the frequency domain.
The approach---described in details in \cite{firtha2015sound}---is not discussed here further, since it is superseded by the time domain WFS formulation introduced in the foregoing in Section \ref{Sec:Moving_source_WFS}.
The coincidence of the driving functions, however indicates that Wave Field Synthesis is a high frequency/wavefront matching approximation of the explicit solution, proven for a general stationary sound field in the previous chapter.

\section{Practical aspects of the synthesis of moving sources}

So far the theoretical foundations of physically correct synthesis of source movements were discussed.
The practical implementation of the foregoing raises numerous questions.
The definition of several quantities, present in the driving function and assumed to be a-priori known is not straightforward.
Furthermore, the choice of the SSD shape, the applied referencing scheme and the applied anti-aliasing strategy is crucial in the aspect of synthesizing dynamic sound scenes.
The following final subsection presents several practical considerations and solutions for the challenges, arising for the special case of synthesizing a moving point source, following \cite{Firtha2018_daga_moving_source}.

\subsection{Calculation of source trajectory}
\label{Sec:Trajectory_calc}

Direct implementation of the moving source driving function \eqref{Eq:SFS_theory:25D_KI_moving_source} assumes that the time dependence of the source position $\vxs(t)$ is known a-priori. 
This is an optimistic assumption in the aspect of practical applicability. 
Instead, more often a parametric curve $\mathbf{y}(u)$ is given, which the virtual source follows with a pre-defined velocity profile.
This requirement can be formulated as finding a reparameterization, so that 
\begin{equation}
\mathbf{y}(u(t)) = \vxs(t), \hspace{6mm} \left| \frac{\td \vxs(t)}{\td t} \right| = |\vvs(t)| 
\label{Eq:parametric_curves}
\end{equation}
holds. 
The goal is to find the explicit parametrization $u(t)$ so that substitution into \eqref{Eq:parametric_curves} yields the desired source position vector.

Differentiation of \eqref{Eq:parametric_curves} with respect to time and application of the chain rule, for $\td u / \td t$ results in
%
% referred to as \emph{reparameterization by arc-length}.
% Analytically their relation can be established by differentiating \eqref{Eq:parametric_curves} with applying the chain rule, and taking the absolute value of the involved quantities
% \begin{equation}
% \left| \frac{\td \mathbf{y}(p(t))}{\td p} \right| \cdot \frac{\td p(t) }{\td t} = \left| \frac{\td \vxs(t) }{\td t}  \right| = |\vvs(t)|,
% \end{equation}
% after rearrangement leading to
\begin{equation}
 \frac{\td u(t) }{\td t} = \frac{|\vvs(t)|}{\left| \td \mathbf{y}(u(t)) / \td u \right|}.
\end{equation}
%The parametrization $u(t)$ is then obtained by integration:
In order to express $u(t)$ both sides are multiplied by $\td t$, and according the first fundamental theorem of calculus taking the definite integral leads to
\begin{equation}
u(t) = \int_{t_0}^{t} \frac{|\vvs(s)|}{\left| \td \mathbf{y}(u(s)) / \td u \right|} \td s,
\label{Eq:pt}
\end{equation}
with $t_0$ being a user-defined initial time.
Note that for sources moving with constant velocity ($|\vvs(s)| = v$) the parametrization is referred to as reparametrization to arc-length.

For an arbitrary trajectory and velocity profile the parametrization \eqref{Eq:pt} can be evaluated only numerically.
A detailed discussion on the frequently used numerical methods can be found in \cite{Parent2012}.
As a simplest approach, the integral may be approximated numerically with the forward-Euler method, approximating the integral with the iteration scheme
\importanteq{Approximate source trajectory}{
u_{i+1} = u_i + \td t \frac{|\vvs(u_i)|}{ | \td \mathbf{y}(u_i)/\td u | }, \hspace{10mm} i \geq 0,
}
where $\td t = \frac{1}{fs}$ is the sampling period of the source trajectory.
Once the parametrization $u_i$ is found, the required source trajectory vector at the time instant $t_i$ can be obtained from $\vxs(t_i) = \mathbf{y}(u_i)$. 

\subsection{Calculation of propagation time delay}
	
Having found the source trajectory the implementation of the driving function would still require the knowledge of the propagation time delay, i.e. the time it takes for the wavefront to travel from the source position at the emission time to the receiver position at the receiving time.
This requires the solution of the quadratic equation \eqref{eq:tau} for each SSD element at each time instant, which makes real-time implementation infeasible.

The computational complexity may be considerably decreased by implementing a further Euler iteration scheme, i.e. by approximating $\tau(\vx,t)$ by its first order Taylor series
\begin{equation}
\tau(\vx,t+\td t) \approx \tau(\vx,t) + \td t \frac{\td \tau(\vx,t)}{\td t}.
\end{equation}
The temporal derivative of $\tau$ can be obtained from the implicit derivation of its definition \eqref{eq:tau}, reading as
\importanteq{$\tau$ derivative}{
\frac{\td \tau(\vx,t)}{\td t} = \tau'(\vx,t) = \frac{-\frac{1}{c} \left< \vvs(t-\tau) \cdot ( \vx-\vxs(t-\tau) ) \right>}{| \vx - \vxs(t) |}.
}
Hence the iteration scheme at the time instant $t_i$ becomes
\importanteq{$\tau$ iteration scheme}{
\tau(\vx,t_i) = \tau(\vx,t_{i-1}) + \td t \cdot \tau'(\vx,t_{i-1}),
}
with $\td t = \frac{1}{f_s}$ being the sampling period of the driving function \cite{doi:10.1121/1.4996126}.
Obviously, when only numerically available, $\vxs(t-\tau)$ may be interpolated from the trajectory vector, from which the source velocity $\vvs(t-\tau)$ may be calculated by differentiating it numerically with respect to time.

It is important to note that the sampling frequency for the calculation of the source trajectory and propagation time delay may be chosen significantly lower than the actual source driving signal's sampling frequency.
As a result computational cost can be decreased, besides still ensuring numerical stability. 

\subsection{Effects of the SSD discretization}

\subsubsection{Description of spatial aliasing}

In the following the effects of the SSD discretization is discussed in case of synthesizing a moving source, extending the anti-aliasing strategy presented in Section \ref{Sec:Aliasing} to non-stationary sound fields.

The effects of the SSD discretization is illustrated in Figure \ref{fig:Moving_source:MS_spatial_alising} in case of a moving source with a harmonic (a) and wideband (b) excitation signal.
Similarly to the stationary case, above a certain frequency the resultant field of the secondary sources does not form a smooth wavefront, but the individual wavefronts of the secondary sources will be present in the synthesized field creating an interference pattern.
In the time domain spatial aliasing manifests in spherical wavefronts of the individual secondary sources, following the intended virtual wavefront.
These secondary waveefronts are high-pass filtered to the spatial aliasing frequency.

In case of a moving point source the local perceived frequency is altered by the Doppler effect, having a strong influence on spatial aliasing artifacts.
Those SSD positions, where the perceived frequency is locally increased (i.e. in front of the moving source) contribute dominantly to aliasing, while behind the virtual source aliasing waves are less emphasized.
This can be examined in Figure \ref{fig:Moving_source:MS_spatial_alising} (a), where in case of a moving harmonic source aliasing waves originate from in front of the moving source, radiating laterally backwards at the angular frequency of the local perceived frequency measured at the aliasing SSD element.
This, however, means that aliasing waves arrive to a given receiver point with a frequency, differing from the virtual source's local perceived frequency.
In the time domain this means that aliasing wavefronts arriving to a given receiver position following the virtual wavefront suffer a different Doppler shift than the intended wavefront.
This is illustrated in Figure \ref{fig:Moving_source:MS_spatial_alising} (b).
As a result spatial aliasing artifacts are extremely enhanced, compared to the stationary case: while for the stationary case aliasing results only in the coloration of the synthesized field, for the dynamic case undesired frequency components will be also present in the synthesized sound, that can be clearly audible in case of high virtual source velocities.

\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth ]{Figures/Moving_sources/Spatial_aliasing.png}
	\put(0, 0){(a)}
	\put(50,0){(b)}
	\end{overpic}   
    \caption{2.5D synthesis of a moving 3D point source located at $\vxs = \posvec{3}{v \cdot t + 1.5}{-2}{0}$ with $v = \frac{c}{2}$, radiating at $f_0 =~1~\mathrm{kHz}$ (a), or emitting an impulse, bandlimited to $15~\mathrm{kHz}$ (b).
    The screenshot is taken at $t=0$.
    The synthesis is referenced on a reference line with $\yref = 1.5~\mathrm{m}$.
	Synthesis is performed using a linear SSD with the secondary source spacing set to $\Delta x = 10~\mathrm{cm}$.}
\label{fig:Moving_source:MS_spatial_alising}  
\end{figure}
\vspace{3mm}
The following section discusses the analysis and mitigation of spatial aliasing artifacts are discussed.
Again, it is exploited that WFS constitutes a high frequency approximation for the explicit solution, the latter allowing the analytical description of spatial aliasing.
Hence, the effects of discretization is introduced via the example of synthesis applying a linear SSD with a known explicit solution, which is generalized towards arbitrary SSDs in the following.

Assume the synthesis of a moving source applying a discrete, linear SSD, located at $\vxo = \posvec{3}{x_0}{0}{0}$ with the loudspeaker spacing being $\Delta x$.
The source moves uniformly along a straight trajectory, parallel to the SSD.
Again, the effect of the SSD discretization can be described as the sampling of the ideal, continuous driving function, resulting in the repetition of the driving function spectra on the multiples of the sampling wavenumber. 
According to \eqref{Eq:SFS_theory:Aliased_field_sp} the synthesized field reads as
\begin{equation}
\tilde{P}(k_x,y,z,\omega) = \frac{1}{\Delta x}
\sum_{\eta = -\infty}^{\infty} \tilde{D}\left(k_x - \eta \frac{2\pi}{\Delta x},\omega \right)  \cdot \tilde{G}(k_x,y,z, \omega),
\label{Eq:Moving_source:Synth_field}
\end{equation}
where the driving function spectrum is given by \eqref{Eq:Moving_source:kx_driv_fun} for the special case of a harmonic source signal.
For a wideband excitation the driving function is obtained as the spectral integral of the harmonic driving function, weighted by  the source excitation frequency content.
\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/Aliased_spectrum.png}	
	\put(1,38){(a)}	
	\put(51.5,38){(b)}
	\put(27.5,0){(c)}
	\end{overpic}   
    \caption{Illustration of the aliased synthesis of a moving virtual point source, located at $\vxs(t) = \posvec{3}{v\cdot t + 1.5}{-2}{0}$, emitting an impulse, bandlimited to $2~\mathrm{kHz}$.
    Figure (a) shows the spectrum of the discretized moving source driving function with overlapping spectral repetition.
    Figure (b) shows the spectrum of the 3D Green's function and Figure (c) shows the spectrum of the synthesized field, both measured along the reference line.}
\label{fig:Moving_sources:Aliased_spectrum}
\end{figure}
The process of the synthesis of a moving source with wide-band excitation applying a discrete SSD is illustrated in the wavenumber domain in Figure \ref{fig:Moving_sources:Aliased_spectrum}.

Again, the spectrum of the driving function is obtained by the rotation and rescaling of the stationary driving function spectrum.
It is illustrated by \ref{fig:Moving_sources:Aliased_spectrum} (a) that due to the local increase of perceived angular frequency in front of the moving source
the mirror spectra are more likely to alias: in the current example in front of the moving source even a second order aliasing component is present ($\eta = 2$ component is present in the baseband propagation region), while behind the source due to the local decrease of the perceived frequency, no aliasing component is present at all (i.e. from these parts of the SSD no aliasing echoes originate).

\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/Aliased_spectogram.png}	
	\put(1,38){(a)}	
	\end{overpic}   
    \caption{Wavenumber-frequency representation of the synthesized field of a harmonic moving source, applying a linear SSD (a) and the corresponding spectogram (b).
    The source is located at $\vxs = \posvec{3}{v \cdot t}{-2}{0}$ with $v= \frac{c}{2}$, radiating at $f_0 =~ 1 \mathrm{kHz}$.
    The spectrum of the synthesized field is measured along the reference line, set to $\yref = 1.5~\mathrm{m}$, while the spectogram of the pass-by is measured at $x = 0~\mathrm{m}$, on the reference line.}
\label{fig:Moving_sources:Aliased_spectogram}  
\end{figure}

Also it is clear from the spectral representation that aliasing components are present in the radiated wavefield with a reversed $k_x$ sign, thus aliasing waves emerging from secondary sources in front of the moving virtual source will propagate backwards, opposed to the source motion direction.
As a direct consequence in a fixed receiver position strong frequency distortion may occur, that has been reported and investigated in numerous previous studies \cite{Franck2007, Ahrens2012}.
The phenomenon is illustrated via the example of a harmonic source excitation in Figure \ref{fig:Moving_sources:Aliased_spectogram}, depicting the spectral representation of the synthesis scenario, presented in Figure \ref{fig:Moving_sources:Aliased_spectrum} (a).
As a result of the SSD discretization after the virtual source pass-by aliasing waves are present in a given receiver position, propagating laterally backwards, with the frequency determined by the measured frequency at the aliasing SSD positions.
Hence, besides the ideal perceived frequency, after the virtual source pass-by an undesired frequency component is also present in the synthesized field.
With increasing source frequency (or at larger SSD sampling distance) also higher order aliasing components are present in the radiated field, resulting in multiple undesired frequency components. 
Furthermore, in the case when the perceived frequency behind the virtual source gets above the aliasing frequency, undesired frequency components are present before the virtual source pass-by.

For the special case of a harmonic moving source the frequency content of the synthesized field can be expressed analytically.
Substituting the 2.5D SDM driving function \eqref{Eq:Moving_source:kx_driv_fun} into \eqref{Eq:Moving_source:Synth_field}, taking its spatial inverse Fourier transform and exploiting the sifting property of the Dirac delta in order to evaluate the Fourier integral results in
\begin{equation}
P(x,y,z,\omega) = 
D(x,\omega,\omega_0)
\sum_{\eta = -\infty}^{\infty}
\tilde{G}( \frac{\omega-\omega_0}{v} +  \eta \frac{2\pi}{\Delta x},y,z, \omega )
 \te^{-\ti  \eta \frac{2\pi}{\Delta x}  x}.
\end{equation}
Obviously, $\eta = 0$ yields the unaltered, ideal synthesized field without aliasing.
This formulation allows the analytical description of the undesired frequency components, stemming from the poles of the translated Green's function $\tilde{G}( \frac{\omega-\omega_0}{v} +  \eta \frac{2\pi}{\Delta x},y,z, \omega )$.
As the poles are found where $|\frac{\omega-\omega_0}{v} +  \eta \frac{2\pi}{\Delta x}| = |\frac{v}{c}| = |M|$ holds, therefore the actual frequency of the aliasing waves before and after the virtual source pass-by is given by
\begin{equation}
\omega = \frac{1}{1 \pm M} \left( \omega_0 + \eta \frac{2\pi v}{\Delta x} \right),
\end{equation}
with for $\eta > 0$ taking the lower, for $\eta < 0$ taking the higher frequency into consideration.
A more detailed treatise on these undesired frequency components can be found in \cite{firtha2016:daga}.

\subsubsection{Avoiding spectral overlapping}
The above description highlighted that spatial aliasing may result in clearly audible, serious artifacts due the different Doppler-shifts between the intended and the aliasing wavefronts.
Hence, proper anti-aliasing strategy is crucial in the aspect of synthesizing moving sources.
As a first step, the proper choice of the SSD shape is an important question: the strong contribution of undesired frequency components is the result of the theoretically infinite, linear SSD, with high contribution of lateral waves.
In the aspect of avoiding aliasing a smooth, enclosing SSD shape should be chosen, at which the virtual wavefront arrives dominantly with a normal local propagation direction.
The optimal choice, fulfilling this requirement (and due to further reasons, explained in the following) for an arbitrary source trajectory, is applying a circular SSD.

In order to avoid further aliasing artifacts the same anti-aliasing filtering strategy may be applied, as given for a stationary virtual field in Section \ref{Sec:Aliasing}.
From investigating Figure \ref{fig:Moving_sources:Aliased_spectrum} it is clear that by spatial bandlimiting the linear driving function to the Nyquist wavenumber $k_{x,\mathrm{Nyq}} = \frac{\pi}{\Delta x}$ i.e. as long as 
\begin{equation}
\tilde{D}(k_x,\omega) = 0, \hspace{3mm} \text{for} \hspace{3mm}  |k_x| > \frac{\pi}{\Delta x}
\end{equation}
holds, the spectral overlapping after discretization could be entirely avoided.
Similarly to the stationary case---as a generalization towards time variant sound field---the spectrum of the linear driving function at a given wavenumber component $k_x$ and at a given frequency $\omega$ is dominated by that part of the SSD, where $k_x^P(\vxo,t) = k_x$ and $\omega(\vxo,t) = \omega$ is satisfied, with $\omega(\vxo,t)$ being the perceived, Doppler shifted angular frequency.
Since the two quantities are connected through \eqref{eq:Moving_source:local_wn_general}, in the spatial domain the anti-aliasing condition can be formulated as
\begin{equation}
D(x_0,\omega) = 0, \hspace{3mm} \text{for} \hspace{3mm}  k_x^P(\vxo,t_0) = \frac{\omega(\vxo,t_0)}{c} \cdot |\hat{k}_x^P(\vxo,t_0)|  > \frac{\pi}{\Delta x},
\end{equation}
where $\hat{k}_x^P(\vxo,t_0)$ is the $x$-component of the normalized local wavenumber vector.
Finally, within the validity of the Kirchhoff approximation an arbitrary smooth SSD can be considered locally linear.
In this case the above anti-aliasing criterion holds, with the role of $k_x^P$ interchanged to the tangential wavenumber component $k_t^P$, resulting in 
\begin{equation}
D(\vxo,\omega) = 0, \hspace{3mm} \text{for} \hspace{3mm} \omega(\vxo,t_0) > \frac{\pi}{\Delta x} \frac{c}{|\hat{k}_t^P(\vxo,t_0)|}.
\end{equation}
According to \eqref{eq:Moving_source:norm_local_wn_moving_source}, for a moving source the normalized local wavenumber vector is a unit vector pointing into the receiver position from the source position at the emission time.
Denoting the tangent vector of the secondary sources by $\mathbf{t}(\vxo)$ this leads to the final anti-aliasing condition for a moving point source:
\importanteq{Moving source anti-aliasing condition}{
D(\vxo,\omega) = 0, \hspace{3mm} \text{for} \hspace{3mm} \omega(\vxo,t_0) > \frac{\pi c}{\Delta x} \frac{|\vxo-\vxs(t_0-\tau(\vxo,t_0))|}
{|\left< \vxo-\vxs(t_0-\tau(\vxo,t_0)) \cdot \mathbf{t}(\vxo) \right>|}.
\label{Eq:Moving_source:anti-aliasing_cutoff_freq}
}
This means that anti-aliasing requires the implementation of a time variant low-pass filter with the cut-off frequency given above.

\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/Moving_sources/antialiased_synth_moving_source.png}
	\footnotesize
	\put(0, 0){(a)}
	\put(45,0){(b)}
	\end{overpic}
\caption{Synthesis of a moving source on an arbitrary trajectory, applying a circular SSD, with the radius of $R_{\mathrm{SSD}} = 2~\mathrm{m}$, sampled at $\Delta x = 10~\mathrm{cm}$.
	The source, traveling with a constant velocity of $|\mathbf{v}| = \frac{3}{4}c$.
    Figure (a) shows the effects of source discretization with clearly visible aliasing echoes with the strongest contribution emerging from front of the virtual source, where the local perceived frequency is increased by the Doppler effect.
    Figure (b) shows the effect of ideal anti-aliasing filtering. 
    Time variant low-pass filtering of the driving function below the instantaneous cut-off frequency \eqref{Eq:Moving_source:anti-aliasing_cutoff_freq} is performed in the short-time Fourier transform domain with properly chosen window and hop sizes.
    The white dots on the trajectory denote the source position at the time instant, when the impulses were emitted.}
	\label{Fig:Moving_sources:anti-aliased_synth_moving_source}
\end{figure}

As in the stationary case, full-band synthesis is achieved only on those parts of the synthesized field, for which the stationary SSD element's normal vector coincides with the local propagation direction of the virtual field.
At that position the denominator in \ref{Eq:Moving_source:anti-aliasing_cutoff_freq} is zero, and the cut-off frequency $\omega(\vxo,t_0) = \infty$.

For the special case of a circular SSD the normal vector is always pointing towards the center of the array.
Hence, due to the geometry at the center of the SSD the existence of a nearly full-band stationary SSD element is inherently ensured.
This is again an important advantage of applying circular loudspeaker arrays.
Terminology nearly full-band synthesis refers to the fact that due to the discretization of the SSD, full-band synthesis is only possible when at the stationary SSD position an actual SSD element is located.
In practice when the moving source is located between two actual secondary sources even at the center of the array the synthesized field is slightly bandlimited (depending on the distance of the virtual source from the SSD), which may cause audible artifacts if the source is close to the SSD.

The result of the proposed anti-aliasing approach with applying a circular SSD is illustrated in Figure \ref{Fig:Moving_sources:anti-aliased_synth_moving_source}.
In the simulation the source is traveling along an arbitrary trajectory defined by a discrete set of points, with the trajectory and the propagation time delay calculated iteratively, as it was discussed in the previous subsections.
The simulation results verify the nearly full-band synthesis in the center of the secondary array.

\subsection{Choosing the referencing scheme}
%A further advantage of circular SSDs is that analytical formulation is available for the referencing function in case of referencing the synthesis to a concentric reference circle inside the listening region.
In practical applications the evaluation of the 2.5D WFS driving function, given by \eqref{Eq:Moving_source:25D_WFS} requires the definition of a reference position $\vxref(\vxo,t_0)$ for each SSD element at each time instant.
In case of a moving source, for general referencing curves with arbitrary shaped SSDs this point is found at the intersection of a straight line---connecting the actual SSD element $\vxo$ with the corresponding source position at the emission time $\vxs(t_0-\tau(\vxo,t_0))$---and a polyline, defining the reference curve. 
Obviously, the direct solution for the reference position is of great computational cost, making real-time applications infeasible, therefore geometries with analytical solutions are preferred.
As a possible solution specific reference curve shapes may be used for which the analytical solution for the reference position is available.
As an example, in case of circular SSDs the choice of a concentric circle for the reference curve may be feasible, for which geometry the intersection of a parametric line and a circle is well-known \cite[Ch.7.3.2]{Schneider2003:ComputerGraphics}.
However, as a result amplitude correct synthesis at a given time instant is ensured only over an arc, for which part of the reference curve a stationary SSD element exist.

Alternatively, as the simplest solution, synthesis may be optimized to a given reference point $\vxref$ independently from the actual SSD position, e.g. to the center of the SSD in case of a circular secondary ensemble.
%In this case for a given virtual source position amplitude correct synthesis is ensured rather over a curve than merely at the reference position, as it is discussed in details in \cite{Firtha2016}. 
%Due to the motion of the virtual point source the shape of this curve varies with time, however containing the reference position at an arbitrary time instant.
%Therefore this solution ensures optimal synthesis at the reference point during the entire virtual source pass-by.
Since ideal anti-aliasing can also be achieved only at a given listening position, this simple choice may be feasible in the aspect of practical implementation.

Furthermore, amplitude correct synthesis may be achieved over those parts of the reference curve, for which a stationary SSD element can be found, depending on the virtual source position.
As the simplest referencing strategy in case of a circular geometry, amplitude correct synthesis may be achieved at the center of the secondary array independently on the virtual source trajectory.


