Traditional WFS theory applying a linear SSD, termed as 2.5D WFS---as first proposed by Berkhout et al.---applied the stationary phase approximation to the 3D Rayleigh integral formulation in order to derive the driving functions for a secondary dipole array, modeling electrostatic transducers \cite{Berkhout1988, Berkhout93}.
The theory focused on the reproduction of virtual 3D point sources, optimizing the synthesis on a reference line.
The concept was soon unified for secondary arrays consisting of 3D point sources \cite{Start1997:phd,Vogel1993:phd, Verheijen1997:phd, Bruijn2004, Hulsebos2004}, considering also curved SSDs \cite{start1996application}, directive SSD elements \cite{devries1996sound} or the variation of the reference curve by the manual adjustment of the driving function amplitude factor \cite{Sonke1998, Sonke2000:Phd}.

A recent 2.5D WFS generalization by Spors included arbitrary virtual source models applying arbitrary shaped SSDs, with a target field independent referencing factor aiming at the optimization of synthesis to a reference point \cite{Spors2008:WFSrevisited}.
The referencing scheme was further simplified by Ahrens \cite{Ahrens2012} using a constant reference factor.
The approaches account for the SSD dimension correction factors, but neglect the \emph{virtual source dimensionality} mismatch \cite{Voelk2012} in the case of reproducing a 3D point source, resulting in amplitude errors.

Instead of introducing 2.5D WFS theory via the existing approaches, this chapter presents a novel unified 2.5D WFS formulation that adapts the target wave field characteristics to the referencing function, and ensures optimized synthesis on an arbitrary reference curve applying arbitrary shaped SSDs.
The presented approach inherently includes former methods as special cases of the applied referencing schemes.

2.5D WFS theory relies heavily on the \emph{stationary phase approximation} (SPA) in order to approximate the 2D and 3D Neumann Rayleigh integrals.
The section starts with the introduction of the stationary phase method.
In the previous chapter, dealing with the Kirchhoff approximation the wavenumber vector was already introduced.
In the followings a formal definition is given, and by applying the wavenumber vector concept, an expressive physical interpretation is given for the SPA in the context of WFS.

%
\section{The stationary phase approximation}
\label{Section:25D_WFS:SPA}
%
\subsection{The integral approximation}
%
The SPA is a basic tool of asymptotic analysis, applied to approximate integrals around critical points in the integral path.
The method yields approximate solutions of integrals of the form
\begin{equation}
\label{Eq:SPAintegral_1d}
I_{1\mathrm{D}} = \int\limits_{-\infty}^{\infty} F(z) \, \te^{\ti \phi(z)} \, \td z
\end{equation}
in one dimension and with $\vxo \in \mathbb{R}^{n}$
\begin{equation}
\label{Eq:SPAintegral_nd}
I_{n\mathrm{D}} = \int\limits_{\dO} F(\vxo) \, \te^{\ti \phi(\vxo)} \, \td \dO(\vxo)
\end{equation}
in higher dimensions, when $\te^{\ti \phi(\vxo)}$ is highly oscillating and $F(\vxo)$ is comparably slowly varying.


For the 1D case a rigorous derivation of the SPA based on integration by parts is given in \cite{Bleistein1984, Blenstein1975, Williams1999}.
More informally the method relies on the second order truncated Taylor series of the exponent around $z^*$, where $\phi'(z^*) = 0$ and $\phi''(z^*) \neq 0$, with $\phi'(z)$ denoting the derivative with respect to $z$:
\begin{equation}
\phi(z) \approx \phi(z^*) + \frac{1}{2}\phi''(z^*)(z-z^*)^2.
\end{equation}
Point $z^*$ is termed the \emph{stationary point}.

Supposing that $F(z)$ is a slowly varying smooth function compared to $\phi(z)$, it is assumed, that where the phase varies, i.e.\ $\phi'(z) \neq 0$, the integral of rapid oscillation cancels out, thus the greatest contribution to the total integral comes from the immediate surroundings of the stationary point.
Moreover in the proximity of the stationary point $F(z)$ can be regarded as constant with the value $F(z^*)$.

With these considerations the integral becomes
\begin{align}
I_{1D} \approx F(z^*)\,\te^{+\ti\phi(z^*)} 
\int\limits_{-\infty}^{\infty} \te^{+\ti \frac{1}{2}\phi''(z^*)(z-z^*)^2} \, \td z.
\end{align}
The remaining integral can be evaluated and the SPA of \eqref{Eq:SPAintegral_1d} becomes \cite[Ch.\ 2.8]{Blenstein1975}
\begin{equation}
\label{Eq:SPAResult}
I_{1D} \approx \sqrt{\frac{2\pi}{| \phi''(z^*) |}} F(z^*) \, \te^{+\ti \phi(z^*) + \ti \frac{\pi}{4}\,\mathrm{sgn}\left(  \phi''(z^*) \right)}.
\end{equation}
\vspace{3mm}
Similarly, in higher dimensions the stationary point (or more precisely a \emph{simple stationary point}) is defined as
\begin{align}
\label{Eq:ndim_stat_point}
\begin{split}
\left.
\nabla \phi(\vxo)\right|_{\vxo = \vx^*} &= 0,
\\ \vspace{3mm} \\
\det A \neq 0,
\hspace{5mm} 
A &= \left[
\frac{\partial^2 \phi(\vx^*)}{\partial x_i \partial x_j} 
\right],
\hspace{5mm}
i,j = 1,2,...,n,
\end{split}
\end{align}
with $A$ being the Hessian matrix of the phase function.
The multidimensional formula for the integral value reads
\begin{equation}
\label{Eq:SPAResult_nd}
I_{nD} \approx \sqrt{\frac{(2\pi)^n}{|\det A|}} F(\vx^*) \te^{\ti \phi(\vx^*) + \ti \frac{\pi}{4}\,\mathrm{sgn}\left( A \right)},
\end{equation}
where $\mathrm{sgn}\left( A \right)$ is the signature of the Hessian (the number of positive eigenvalues minus the number of negative eigenvalues) \cite{Bleistein2000}.

\subsection{The local wavenumber vector}
Consider an arbitrary steady state harmonic sound field in $\vx \in \mathbb{R}^2 / \mathbb{R}^3$ written in a general polar form with $A(\vx,\omega)$, $\phi(\vx,\omega) \in \mathbb{R}$
\begin{equation}
P(\vx,\omega) = A(\vx,\omega)\te^{\ti \phi(\vx,\omega)},
\label{eq:25D_WFS:general_sf}
\end{equation}
%
with a suppressed temporal dependency $\te^{\ti \omega t}$.
The dynamics of wave propagation is described by the phase of the sound field.
Borrowed from ray-tracing/geometrical optics theory we introduce the following quantities \cite{Romer2005,Carozzi2004}:
%
\begin{equation}
\vk(\vx) = [k_x(\vx),\ k_y(\vx),\ k_z(\vx)]^{\mathrm{T}} = -\nabla \phi(\vx,\omega),
\end{equation}
%
\begin{equation}
k(\vx) =  \frac{1}{c} \frac{\partial}{\partial t} \phase{P(\vx,\omega)}  = \frac{1}{c} \left( \omega + \frac{\partial}{\partial t} \phi(\vx,\omega) \right),
\end{equation}
%
termed as the \emph{local wavenumber vector} and the \emph{instantaneous local wavenumber}, respectively, with $ \frac{\partial}{\partial t} \phase{P(\vx,\omega)} $ being the \emph{instantaneous local angular frequency}, where $\phase{f}$ denotes the phase of $f$.
The wavenumber vector, defined as the negative gradient of the phase function points in the direction of maximal phase advance, i.e.\ it is perpendicular to the wave front in an arbitrary position.
For an isotropic media, where the propagation speed is constant, the phase velocity the and group velocity coincide, and the wavenumber vector points in the direction of the wave's energy flow, i.e.\ in the local wave propagation direction \footnote{This statement holds exclusively for isotropic media.
Although the wavenumber vector is always perpendicular to the wavefront, in anisotropic media the energy of a wave not necessarily travels along the path as the wavefront normals\cite{Pollard1977}.}.
For stationary steady state sound fields the wavenumber vector does not depend on time and the instantaneous wavenumber is constant, given by 
\begin{equation}
k^2 = \left( \frac{\omega}{c} \right)^2 = |\vk(\vx)|^2 = k_x(\vx)^2 + k_y(\vx)^2 + k_z(\vx)^2,
\end{equation}
thus the simple \emph{local dispersion relation } holds.
Obviously, for 2D sound fields $k_z(\vx)=0$.
In the current chapter, dealing exclusively with stationary virtual sound fields these assumptions hold.

\begin{figure}[h!]
	\small
	\centering
	\begin{overpic}[width = .9\columnwidth]{Figures/WFS_theory/wavenumber_vector.png}
	\put(0,30){a)}
	\put(50,30){b)}
	\put(0,0){c)}
	\put(50,0){d)}
	\end{overpic}
	\caption{Illustration of the local wavenumber vector for a 2D acoustic point source (a,c) and a 2D plane wave (b,d).
(a-b) show an arbitrarily chosen contour of constant phase, along with the wavenumber vector on this contour.
(c-d) show the local normalized $\hat{k}_x(x,y_0)$ component along the line $y_0 = 0.5 ~\mathrm{m}$.
These latter components are termed as the \emph{Lagrange submanifolds} in the field of ray-tracing \cite{Tracy2014}, forming one component of the wavenumber vector distribution, termed the \emph{Lagrange manifold}.}
	\label{Fig:Theory:general_sfs_geometry}
\end{figure}

Finally, one may define the \emph{normalized wavenumber vector} as
\begin{equation}
\vhk(\vx) = \frac{\vk(\vx)}{|\vk(\vx)|} = \frac{\vk(\vx)}{k(\vx)} = \frac{\vk(\vx)}{\omega/c},
\end{equation}
being a vector of unit length, pointing in the local propagation direction of the sound field\footnote{The normalized phase change of wave fields, here termed as normalized wavenumber vector, is a massively used concept in short wavelength wave theory, dealing with asymptotic/local approximate solutions of the wave equation.
In the field of ray tracing, expression $\Gamma(\vx) = \frac{\phi(\vx,\omega)}{k}$ is termed as the \emph{eikonal}, whose gradient defines the local propagation direction of the wave field: $\nabla \Gamma(\vx) = \vhk(\vx)$.
Substituting \eqref{eq:25D_WFS:general_sf} into the Helmholtz equation in terms of the eikonal and applying high-frequency assumptions leads to the \emph{eikonal equation}, forming the basis of ray acoustic theory \cite{Kinsler2000}.
In the field of high-frequency geometrical optics the representation of wave fields in $\vx, \vk(\vx)$ is termed the phase space representation \cite{Arnold1995}.
Over the last decades also the phase space representation of acoustic fields has gained an increasing interest\cite{Steinberg1993, Teyssandier2005}.}.

For the interpretation of the local wavenumber one should express the first order Taylor-expansion of the phase function around an arbitrary point $\vxo$ in the space
\begin{equation}
\phi(\vx,\omega) \approx \phi(\vxo,\omega) + (\vx-\vxo) \nabla \phi(\vx,\omega).
\end{equation}
By substitution into \eqref{eq:25D_WFS:general_sf} in the proximity of $\vxo$ the sound field is approximated as
\begin{equation}
P(\vx,\omega) \approx A(\vx,\omega) \te^{\ti ( \phi_0(\vxo,\omega) - \vk(\vx)^{\mathrm{T}} \vx )},
\end{equation}
with $\phi_0(\vxo,\omega) = \phi(\vxo,\omega) + \vk(\vx)^{\mathrm{T}} \vxo $.
Therefore each point of an arbitrary sound field is approximated as a local elementary plane wave, with the wavenumber and angular frequency given by $\vk(\vx)$ and $\omega$ respectively.

\subsubsection{Relation of local wavenumber and angular spectrum representation}
Clearly, there is a strong relationship between the local wavenumber vector concept and the plane wave decomposition/angular spectrum of sound fields.
The relation is established by the SPA.
Consider the forward and inverse Fourier transform of a general polar form sound field $P(\vx,\omega)$ given by \eqref{eq:25D_WFS:general_sf}
\begin{equation}
\tilde{P}(k_x,y,k_z,\omega) = \iint_{-\infty}^{\infty} A(\vx,\omega)\te^{\ti \phi(\vx,\omega)} \te^{\ti k_x x} \te^{\ti k_z z} \td x \td z,
\label{eq:forward_transform}
\end{equation}
\begin{equation}
P(x,y,z,\omega) = \frac{1}{(2\pi)^2} \iint_{-\infty}^{\infty} \tilde{A}(k_x,y,k_z,\omega)\te^{\ti \tilde{\phi}(k_x,y,k_z,\omega)}  \te^{-\ti k_x x} \te^{-\ti k_z z} \td k_x \td k_z,
\label{eq:inverse_transform}
\end{equation}
with $\tilde{P}(k_x,y,k_z,\omega) =\tilde{A}(k_x,y,k_z,\omega)\te^{\ti \tilde{\phi}(k_x,y,k_z,\omega)}$.

Supposing, that the sound field fulfills the SPA requirements---i.e.\ high frequency assumptions---the forward transform \eqref{eq:forward_transform}
may be evaluated asymptotically applying the stationary phase method \cite{Arnold1995, Tinkelman2005}.
The stationary point is found for a given $k_x$, where the gradient of the exponent is zero, thus where
\begin{align}
\frac{\partial}{\partial x} \phi(\vx,\omega) + k_x &= 0 \hspace{3mm} \rightarrow \hspace{3mm} k_x(\vx) = k_x, \\
\frac{\partial}{\partial z} \phi(\vx,\omega) + k_z &= 0 \hspace{3mm} \rightarrow \hspace{3mm} k_z(\vx) = k_z
\end{align}
holds.
This finding states, that each point in the plane wave spectrum of a sound field is dominated by the parts of the space, where the local wavenumber vector coincides with the corresponding plane wave wavenumber.
The local wavenumber components therefore may be interpreted as the stationary points of \eqref{eq:forward_transform} as a function of space \footnote{For a stationary phase approximation of the forward and inverse Fourier-transforms see \cite[Eq.\ 5.20, 5.51]{Tracy2014}}.

The counterpart of this statement is that the greatest contribution to the inverse transform \eqref{eq:inverse_transform} is associated to those plane waves---the stationary phase of the inverse integral for given $\vx$---, whose wave number vector coincide with the local wavenumber components at $\vx$.

\subsubsection{High-frequency gradient approximation}
%Applying the local wavenumber concept the 2D/3D WFS theory may be further simplified.
In the previous section it was verified, that the high-frequency WFS driving function is (-2) times the normal component of the target field gradient measured on the SSD, as given by equation \eqref{eq:theory:gen_WFS}.
In case of a planar SSD this driving function ensures perfect reconstruction of the virtual field.


In the high-frequency domain the gradient of an arbitrary sound field may be expressed in a simplified form in terms of the local wavenumber vector.
By applying the product rule of differentiation, the gradient of an arbitrary sound field, described by \eqref{eq:25D_WFS:general_sf} reads
\begin{equation}
\nabla P(\vx,\omega) = \left(  \frac{\nabla A(\vx,\omega)}{A(\vx,\omega)} + \ti \nabla \phi(\vx,\omega) \right) P(\vx,\omega) =  \left(  \frac{\nabla A(\vx,\omega)}{A(\vx,\omega)} - \ti \vk(\vx) \right) P(\vx,\omega).
\end{equation}
A standard pre-assumption for the general WFS theory is that in the frequency domain of interest the target sound field's phase function varies rapidly compared to the envelope of the oscillation, which must hold both to apply the Kichhoff approximation and the stationary phase approximation in the followings.
In the high frequency region $|\vk(\vx)| = k \gg \left| \frac{ \nabla A(\vx,\omega)}{A(\vx,\omega)} \right|$ holds, thus the gradient is approximated as
\begin{equation}
\nabla P(\vx,\omega) \approx - \ti \vk(\vx) P(\vx,\omega).
\label{eq:25D_WFS:gradient_appr}
\end{equation}
Note, that it is a further local plane wave approximation of arbitrary sound fields.
The expression holds for an arbitrary plane wave with equality, and approximates a point-like source in its far-field, where the amplitude does not change rapidly.

\subsection{Physical interpretation}
When the SPA is applied for the Rayleigh integral an expressive physical interpretation can be given for the solution of the stationary position.
Since in the frequency domain of interest the Green's functions in the 2D and 3D Rayleigh integrals are rapidly oscillating functions, therefore the pre-requisitions for the application of the SPA hold.
Approximating the gradient with its high-frequency/plane wave form, given by equation \eqref{eq:25D_WFS:gradient_appr} 
the synthesized field using a planar SSD located at $\vxo = [x_0,\ 0,\ z_0]^{\mathrm{T}}$ (i.e.\ the Rayleigh integral) reads
\begin{equation}
P(\vx,\omega) = \iint_{-\infty}^{\infty} 2 \ti k_y(\vxo) P(\vxo,\omega) G(\vx-\vxo,\omega) \td z_0 \td x_0.
\end{equation}
By definition \eqref{Eq:ndim_stat_point}, the stationary point $\vxo^*$ is given by
\begin{multline}
\nabla_{x_0,z_0} \left.
\left( \phase{ \ti P(\vxo,\omega)} + \phase{ G(\vx-\vxo,\omega)} \right) \right|_{\vxo^*} =
\\
\nabla_{x_0,z_0} \left.
\left( \frac{\pi}{2}+\phase{ P(\vxo,\omega)} + \phase{ G(\vx-\vxo,\omega)} \right) \right|_{\vxo^*} = 0
\end{multline}
holds.
The gradient of the constant phase shift vanishes and the $x_0$ and $z_0$ derivatives of the target field and the Green's function phase can be recognized as the $k_x$ and $k_z$ component of the corresponding local wavenumber vectors.
For the stationary position therefore the following equation holds
\begin{align}
\begin{split}
-k_{x}^P(\vxo^*) &= k_{x}^G(\vxo^*), \\
-k_{z}^P(\vxo^*) &= k_{z}^G(\vxo^*),
\end{split}
\end{align}
with $k_{x/z}^{P}$ and $k_{x/z}^{G}$ denoting the wavenumber components of $P(\vxo)$ and $G(\vxo|\vx)$ respectively
%
\begin{figure}
	\centering
	\begin{overpic}[width = .45\columnwidth ]{Figures/WFS_theory/stationary_phase_a.png}
	\scriptsize
	\put(16,44){virtual source}
	\put(55,31){stationary position}
	\put(98,14.5){$x_0$}
	\put(98,49.2){$x_0$}
	\put(81,60){$\vx$}
	\put(45,64){$y$}
	\put(18,38){$\phase{\ti P(x_0) + G(x_0)}$}
	\put(59,14){$x_0^*$}
	\end{overpic}
	\hspace{10mm}
	\begin{overpic}[width = .4\columnwidth]{Figures/WFS_theory/stationary_phase_b.png}
	\scriptsize
	\put(98,28){$x_0$}
	\put(17, 75.5){$y$}
	\put(40, 28){$x_0^*$}
	\put(58, 63){$\vx$}
	\put(47, 37.5){$\vk^P(\vxo^*)$}
	\put(34, 18){$\vk^G(\vxo^*)$}
	\end{overpic}
	\caption{Illustration of the stationary phase approximation.
Analytically, the stationary phase position is found, where the phase of the integrand has a stationary point, i.e.\ where its gradient is zero (a).
In the aspect of the Rayleigh integral the stationary position can be interpreted as the point, where the local wavenumber vector of the Green's function $G(\vxo|\vx)$ equals (-1) times the local wavenumber vector of the virtual field measured on the SSD (b).}
	\label{Fig:Theory:stationary_position}
\end{figure}

Along with the \emph{local dispersion relation} \cite{Tracy2014} $\left( \frac{\omega}{c} \right)^2 = k_x(\vx)^2+k_y(\vx)^2+k_z(\vx)^2$ at a fixed angular frequency two components completely determine the wavenumber vector, therefore the stationary position on the SSD for a given receiver position $\vx$ satisfies
\begin{equation}
\vk^P(\vxo^*) = - \vk^G(\vxo^*).
\end{equation}
Obviously, the same derivation holds for the 2 dimensional case by applying the 1D SPA, where the stationary position is found, where the $k_x$ components of the target and secondary source field's are equal.

Hence, the SPA compares the propagation direction/wave fronts of the virtual field and the Green’s function (placed at the receiver position $\vx$) along the SSD.
The stationary position is then found, where these two directions coincide.
See Figure \ref{Fig:Theory:stationary_position} (b) for an illustration, with the example of a virtual point source.
Obviously, at the stationary position $\vxo^*$, $\vk^P(\vxo^*)$ coincides with $-\vk^G(\vxo^*)$ both in magnitude and direction.
This result is of primary importance herein.
It states, \emph{that for each receiver position $\vx$, the synthesized sound field is mostly influenced by that SSD element $\vxo^*$, from which the emerging spherical wave fronts locally coincide with the target sound field’s wave fronts, or with other words the propagation direction of a SSD element and the virtual sound field coincide.}\footnote{Since the general SPA equation \eqref{Eq:SPAintegral_nd} holds for an arbitrary surface geometry the same conclusion can be drawn from finding the stationary position in the general Kirchhoff approximation integral with the driving function given by \eqref{eq:25D_WFS:generalized_2d_3d_wfs} by comparing the local wavenumber components specified by the actual SSD geometry.}

The counterpart of this statement declares that \emph{every point $\vxo$ on the SSD highly dominates the total synthesized sound field along a straight line, pointing from $\vxo$ towards the direction of the wave number vector $\vk(\vxo)$ of the target sound field.}
%For the case of a virtual spherical/cylindrical wave, this point is found in the intersection of the vector x 􀀀 xs and the SSD, as seen in Figure 2 (a).
% This is a well-known result in WFS theory
%
\begin{figure}
	\centering
\begin{overpic}[width = 0.45\columnwidth ]{Figures/WFS_theory/Spherical_wave_Stationary_point.png}
	\scriptsize
	\put(-5,2){(a)}
	\put(99, 19){$x_0$}
	\put(16, 69){$y$}
	\put(7, 46){$y$}
	\put(66, 19){$x$}
	\put(40, 19){$x_0^*$}
	\put(16, 4.5){$\vxs$}
	\put(70, 45.5){$\vx$}
	\begin{turn}{37}
	\put(60,-3.5){$\vx - \vxo$}
	\put(25,-2){$\vxo - \vxs$}
	\end{turn}
	\end{overpic}		
	\hspace{10mm}
	%%	
	\begin{overpic}[width = 0.45\columnwidth ]{Figures/WFS_theory/plane_wave_stationary_point.png}
	\scriptsize
	\put(-5,2){(b)}
	\put(69.5,52){$\mathbf{k}_\text{pw}$}
	\put(100,19){$x_0$}
	\put(18, 69){$y$}
	\put(12, 48){$y$}
	\put(65, 19){$x$}
	\put(68, 44.5){$\vx$}
	\put(23, 19){$x_0^*$}
	\put(33, 24.5){$\varphi_\text{PW}$}
	\begin{turn}{30}
	\put(47,13){$\vx - \vxo$}
	\end{turn}
	\end{overpic}
\caption{Geometry for finding the stationary point for a) a virtual cylindrical wave and b) a virtual plane wave.}
	\label{Fig:Theory:Spherical_and_Plane_Wave_stationary_point}
\end{figure}

For the case of a virtual spherical/cylindrical wave, this point is found in the intersection of the vector $ \vx - \vxs $ and the SSD, as seen in Figure \ref{Fig:Theory:Spherical_and_Plane_Wave_stationary_point} (a).
In terms of the wavenumber vector, where
\begin{equation}
k \frac{\vxo^*-\vxs}{|\vxo^*-\vxs|} = k \frac{\vx-\vxo^*}{|\vx-\vxo^*|}
\end{equation}
holds.
This is a well-known result in traditional WFS theory \cite{Start1997:phd,Verheijen1997:phd}.
%
\subsubsection{Plane Wave Example}	
The principle is further demonstrated via the example of a plane wave synthesis, which has not been covered in the related literature so far.
Let's assume a virtual 2D plane wave field with propagating direction $\mathbf{k}_\text{pw}=[k_x,k_y,k_z]^{\mathrm{T}}=k\,[\cosfi_\text{PW},\sinfi_\text{PW},0]^{\mathrm{T}}$.
The $y$-derivative of such a sound field is given by
\begin{equation}
\left.
\frac{\partial\,\te^{-\ti k ( \cosfi_\text{PW}\cdot x_0 + \sinfi_\text{PW}\cdot y )} }{\partial y} \right|_{ y = 0 } = -\ti k \sinfi_\text{PW}\,\te^{-\ti k \cosfi_\text{PW}\cdot x_0}.
\end{equation}
Substituting this back into the Rayleigh integral at a fixed receiver position the synthesized field reads
\begin{equation}
P(x,y,z=0,\omega) = \int\limits_{-\infty}^{\infty} \sinfi_\text{PW} \sqrt{8\pi \ti k |\vx-\vxo|}\,
\te^{-\ti k \cosfi_\text{PW} \cdot x_0} \frac{1}{4\pi}\,\frac{\te^{-\ti k |\vx - \vxo|}}{|\vx - \vxo|} \, \td x_0.\nonumber
\end{equation}
The derivative of the phase function within the integral is given by
\begin{equation}
\label{Eq:Phix0_PlaneWaveExample}
\phi'(x_0) = - k \left( \cosfi_\text{PW} - \frac{x-x_0}{|\vx - \vxo|} \right).
\end{equation}
For a fixed $x$-position the stationary point on the SSD is found for $\phi'(x_0) = 0$, thus where $\cosfi_\text{PW} = \frac{x-x_0}{|\vx-\vxo|}$ holds.
By observing the geometry in Figure \ref{Fig:Theory:Spherical_and_Plane_Wave_stationary_point} (b) it is obvious, that the equation is satisfied, where $\vx-\vxo$ coincides with the propagation direction $\mathbf{k}_\text{pw}$ of the plane wave.


%
%\fscom{example directly based on the calculus above: with \eqref{Eq:k_vs_PhaseGradients_P_G} 
%\begin{align}
%k_x(x_0,0) = -\frac{ \partial }{\partial x_0}\phase{ P(x_0,0,\omega) } = \frac{ \partial }{\partial x_0} \phase{G_{\mathrm{3D}}(|\vxo-\vx|,\omega)}
%\end{align}
%and the plane wave
%\begin{align}
%&P(x,y,\omega)\big|_{x=x_0,y=0} =\\
%&\te^{-\ti\,k\,(\cosfi_\text{PW}\,x+\sinfi_\text{PW}\,y)}\big|_{x=x_0,y=0} =\\
%&\te^{-\ti\,k\,(\cosfi_\text{PW}\,x_0)}
%\end{align}
%follows: we derive its phase
%\begin{align}
%&\frac{\partial }{\partial x_0} [-k\,(\cosfi_\text{PW}\,x_0)] = -k\cosfi_\text{PW}\\
%&k_x(x_0,0) = -\frac{ \partial }{\partial x_0}\phase{ P(x_0,0,\omega) } = (-)(-k\cosfi_\text{PW})
%\end{align}
%now check phase of Green 3D
%\begin{align}
%\frac{\partial }{\partial x_0} [-k\,\sqrt{(x_0-x)^2+(y_0-y)^2+(z_0-z)^2}] = \frac{k(x-x_0)}{|\vx-\vxo|}
%\end{align}
%thus we must ensure that
%\begin{align}
%\frac{k(x-x_0)}{|\vx-\vxo|} == k\cosfi_\text{PW}\\
%\frac{(x-x_0)}{|\vx-\vxo|} == \cosfi_\text{PW}\\
%\end{align}
%which gives us that the vector directions of $\mathbf{k}_{pw}$ and $\vx-\vxo$ coincide, or with their unit vectors the dot product is one.
This is then also consistent with the result \eqref{Eq:Phix0_PlaneWaveExample}.
%}
%

\begin{figure} 
	\centering
	\begin{overpic}[width = .95\columnwidth]{Figures/WFS_theory/2D_unified_wfs.png}
	\footnotesize
	\put(0,2){(a)}
	\put(47,2){(b)}
	\end{overpic}
	\caption{Synthesis of a point (line) source at $\vxs = [0,\ -1]^{\mathrm{T}}$ oscillating at $\omega_0 = 2\pi \cdot 1000 ~\mathrm{rad/sec}$ in an entirely 2D SFS scenario, using the high-frequency WFS driving functions \eqref{eq:25D_WFS:generalized_2d_3d_wfs}.
 The SSD is located at $\vxo = [x_0,\ 0]^{\mathrm{T}}$.
The figures show the synthesized field $\mathcal{R}\left( P_{\mathrm{synth}}(x,y,\omega) \right)$ (a) and the deviation from the target sound field $20\mathrm{log}_{10}\left( P_{\mathrm{synth}}(x,y,\omega) - P(x,y,\omega) \right)$ (b).}
	\label{Fig:WFS_theory:2D_unified_WFS}
\end{figure}


\section{Unified 2D/3D WFS driving functions}
In the previous section the high-frequency gradient approximation has already been applied to simplify the Rayleigh integral.
The same approach may be used in order to obtain compact 2/3D WFS driving functions valid for an arbitrary SSD surface.
Since the application of the Kirchhoff-approximation requires high-frequency conditions, therefore the approximation of the gradient is feasible.
Substituting the high-frequency gradient expression \eqref{eq:25D_WFS:gradient_appr} into the general WFS driving function \eqref{eq:theory:gen_WFS}
\begin{equation}
D(\vxo,\omega) = 2\ti w(\vxo) \langle \vni(\vxo) \cdot \left.
\vk(\vx)\right|_{\vx = \vxo}\rangle P(\vxo,\omega)
\end{equation}
is yielded, with $\vx, \vxo \in \mathbb{R}^{2/3}$.
One should introduce the normal component of the wavenumber vector.
By comparing the definition of the windowing function \eqref{eq:theory:windowing_function} with the driving functions it becomes clear, that the secondary source selection criterion can be inherently included by defining the normal component of $\vk(\vx)$ only for positive values as\footnote{Spors defined the secondary source selection criterion based on the time average intensity vector \cite{Spors2007:DAGA:SS_selection_criterion, Spors2007}.
Having said that in isotropic media the local wavenumber vector coincides with the direction of the energy flow the previous and the proposed criteria are equivalent for stationary sound fields.
For the non-stationary case, e.g.
for moving sound sources time averaging is infeasible}
\begin{equation}
\kn(\vxo) = \begin{cases}
						\langle \vni(\vxo) \cdot \left.
\vk(\vx)\right|_{\vx = \vxo}\rangle, \hspace{3mm} \forall \hspace{3mm} \kn(\vxo) > 0 \\
						0  \hspace{3mm} \text{elsewhere},
					\end{cases}
\label{eq:25D_WFS:normal_k}
\end{equation}
and the general 2D/3D WFS driving functions can be expressed as
\begin{equation}
D(\vxo,\omega) = 2\ti\kn(\vxo)  P(\vxo,\omega).
\label{eq:25D_WFS:generalized_2d_3d_wfs}
\end{equation}
It is noted, that for the special case of a virtual 3D point source the resulting driving function is completely equivalent with that given in \cite[Eq.(20)]{Zotter2013:uniqueness}.	

The application of the driving functions is depicted in \ref{Fig:WFS_theory:2D_unified_WFS} for the case of a linear SSD in a 2D WFS scenario.
Obviously, the approximation of the gradient introduces synthesis errors in front of the SSD towards the local wavenumber vector of the target sound field, emerging from SSD parts, where $\langle \left.
\frac{\nabla A(\vx,\omega)}{A(\vx,\omega)} \right|_{\vx = \vxo}  \cdot \vni(\vxo) \rangle$ is considerable.

\section{2.5D WFS of 2D sound fields}
For didactic reasons the presented WFS theory is introduced starting out from the 2D and 3D Rayleigh integrals, i.e.\ supposing a linear/planar SSD.
The theory is later extended for arbitrary SSD shapes applying the unified driving functions \eqref{eq:25D_WFS:generalized_2d_3d_wfs}.

\subsection{The 2.5D Rayleigh integral}
Suppose a sound field, synthesized by a planar SSD located at $\vxo = [x_0,\ 0,\ z_0]^{\mathrm{T}}$, applying the planar WFS driving functions given implicitly by the \emph{3D Neumann Rayleigh integral}:
\begin{equation}
P(\vx,\omega) = -2\iint_{-\infty}^{\infty} \left.
\frac{\partial P(\vx,\omega)}{\partial y} \right|_{\vx = \vxo} G_{3\mathrm{D}}(\vx-\vxo) \td z_0 \td x_0.
\label{eq:25D_WFS:3D_neumann} 
\end{equation}
Assuming a target sound field, being independent from the $z$ direction---i.e.\ $k_z(\vx) = 0$---the integral degenerates into the \emph{2D Neumann Raylegh integral} by the direct application of \eqref{Eq:Wave_Theory:2D_Green}
\begin{equation}
P(\vx,\omega) = -2\int_{-\infty}^{\infty} \left.
\frac{\partial P(\vx,\omega)}{\partial y} \right|_{\vx = \vxo} \int_{-\infty}^{\infty}  G_{3\mathrm{D}}(\vx-\vxo) \td z_0 \td x_0.
\label{eq:25D_WFS:2D_neumann} 
\end{equation}


\vspace{3mm}
In the following we restrict our investigation to the synthesis plane $z=0$.
For the sake of brevity $\vx = [x,\ y,\ 0]^{\mathrm{T}}$ denotes in-plane positions.
Restricting the synthesis to the $z=0$ plane the integral of the 3D Green's function (i.e.\ the 2D Green's function) may be approximated applying the SPA: based on the foregoing if the receiver position is located at $z=0$ and the virtual sound field radiation is independent from the $z$-coordinate, the stationary position of integral \eqref{eq:25D_WFS:2D_neumann} is located trivially at $z_0=0$: $\vxo^* = [x_0,\ y_0,\ 0]$.
The involved quantities for the SPA read
\begin{equation}
\phi(z_0=0) = -k|\vx-\vxo^*|, \hspace{5mm} \left.
\frac{\partial^2}{\partial z_0^2} \phi(z_0)\right|_{z_0=0} = -\frac{k}{|\vx-\vxo^*|},
\end{equation}
thus the discrepancy between the 2D and 3D Green's function is described by $ \sqrt{\frac{1}{ |\phi''(z_0^*) | }}$.
%\begin{equation}
%\label{Eq:SPAintegral_1d}
%I_{1\mathrm{D}} = \int\limits_{-\infty}^{\infty} F(z) \, \te^{\ti \phi(z)} \, \td z
%\end{equation}
By accounting for the negative sign of the second derivative around the stationary point, the integral is approximated by the SPA (by substituting into \eqref{Eq:SPAResult}) as:
\begin{equation}
\int_{-\infty}^{\infty} \frac{1}{4\pi} \frac{\te^{-\ti k |\vx-\vxo| }}{|\vx-\vxo|}\td z_0 = -\frac{\ti}{4} H_0^{(2)}\left( k|\vx-\vxo^*| \right) \approx 
\sqrt{\frac{2\pi |\vx-\vxo^*|}{\ti k}} \frac{1}{4\pi}  \frac{\te^{-\ti k |\vx-\vxo^*| }}{|\vx-\vxo^*|}.
\label{Eq:25D_WFS:Hankel_approx}
\end{equation}
This approximation of the Hankel function---termed as the asymptotic expansion for large arguments \cite[(10.2.6)]{Nist2010}---is frequently applied in the field of SFS, valid withing the SPA assumptions, i.e.\ for high frequencies and in the farfield, where $k|\vx-\vxo|\gg 1$ holds.

In the followings also the SSD positions are restricted to the synthesis plane, therefore we denote the in plane SSD positions as $\vxo = [x_0,\ 0,\ 0]^{\mathrm{T}}$.
Substituting back the approximation of the 2D Green's function into the 2D Rayleigh integral expressed in terms of the 3D Green's function one obtains the \emph{2.5 Neumann Rayilegh integral}:
\begin{equation}
P(\vx,\omega) = -2\int_{-\infty}^{\infty} \left.
\frac{\partial P(\vx,\omega)}{\partial y} \right|_{\vx = \vxo}\sqrt{\frac{2\pi |\vx-\vxo|}{\ti k}} G_{3\mathrm{D}}(\vx-\vxo,\omega) \td x_0.
\label{eq:25D_WFS:25D_Rayleigh} 
\end{equation}
The 2.5D Neumann Rayleigh integral \eqref{eq:25D_WFS:25D_Rayleigh}  contains the implicit solution of the SFS problem for a virtual 2D source in terms of the unknown driving function $D(x_0, \omega)$
\begin{equation}
D(x_0,\omega) = 
- 2\,\sqrt{\frac{2\,\pi}{\ti k}} \sqrt{|\vx-\vxo|} \left.
\frac{\partial P(\vx,\omega)}{\partial y} \right|_{\vx=\vxo}.
\label{Eq:2_5D_driv_fun_implicit}
\end{equation}
The factor $\sqrt{\frac{2\pi |\vx-\vxo|}{\ti k}}$ corrects the \emph{secondary source dimensional mismatch}, which emerges from the fact, that 3D point sources are applied in a 2D SFS scenario: the correction factor approximates the frequency response and the attenuation factor of the 2D Green's function in terms of the 3D Green's function.
Obviously, attenuation correction may be optimized only in one dedicated position in space, therefore the driving function depends on the listening position $\vx$.
In the following it is verified, that by choosing a proper referencing scheme the driving function can be made independent from a single receiver position, still ensuring amplitude correct synthesis on an arbitrary convex curve in front of the SSD.

It is important realizing, that no 3D virtual sound field can be synthesized by \eqref{eq:25D_WFS:25D_Rayleigh}.
Even by applying ideal line sources, the correct synthesis of a 3D monopole is impossible: amplitude errors would be present in the synthesized field.
This phenomenon is referred to as \emph{virtual source dimensional mismatch}, and has to be accounted for, when the aiming for a 3D virtual sound field.
In the 2D case two types of virtual sound field models are considered in the present treatise: virtual plane waves, propagating in the $z=0$ plane (i.e.\ with $k_z = 0$) and 2D point(line) sources.

\subsection{Referencing schemes for 2D sound fields}

\subsubsection{Referencing Function}

Let's define a \emph{referencing function} $d(x_0)$ for each SSD element to generalize the WFS driving function \eqref{Eq:2_5D_driv_fun_implicit} towards
\begin{equation}
D(x_0,\omega) = 
- \sqrt{\frac{8\pi}{\ti k}} \sqrt{d(x_0)} \left.
\frac{\partial P(\vx,\omega)}{\partial y}\right|_{\vx = \vxo}.
\label{Eq:Gen_rayleigh_dx0}
\end{equation}

The principle of arbitrary referencing---stemming from the wavenumber vector interpretation of the SPA given in section \ref{Section:25D_WFS:SPA}---can be stated as follows:
\emph{Each receiver point $\vx$ is mainly contributed by one individual SSD element $x_0$, from which the wave number vector ${\bf k}$ of the field of the SSD element and that of the target wave field coincide.
This SSD element is termed the stationary secondary source/stationary SSD element.
Therefore, one may control the amplitude of the synthesized field along an arbitrary receiver curve, by controlling the amplitude of the corresponding stationary SSD elements.}

The referencing function for virtual 2D sound fields is, cf.\ \eqref{Eq:2_5D_driv_fun_implicit}, \eqref{Eq:Gen_rayleigh_dx0}
\begin{align}
d(x_0) = |\vx-\vxo|,
\label{dx0_2DSources}
\end{align}
i.e.\ given simply by the distance from the stationary SSD point, where the corrected 3D Green's function approximately equals the ideal 2D Green's function.

In the following it is shown how this function could be chosen in order to reference the synthesized field along an arbitrary receiver curve.
Furthermore, the analysis allows for the critical investigation of the referencing schemes applied in traditional WFS theory.

\subsubsection{Parametric Curves}

\begin{figure}
	\centering
	\begin{overpic}[width = 0.45\columnwidth ]{Figures/WFS_theory/Plane_wave_Stationary_point_2.png}
	\scriptsize
	\put(-5,2){(a)}
	\put(100,19){$x$}
	\put(18, 69){$y$}
	\put(33,19){$\vxo$}
	%\put(74,42){$d(x_0)$}
	\put(12, 50){$y_{\mathrm{ref}}$}
	\put(82, 19){$x_{\mathrm{ref}}$}
	\put(84, 52){$\mathbf{x}_{\mathrm{ref}}$}
	\put(41.5, 25){$\varphi_\text{PW}$}
	\put(39, 33){$\mathbf{k}(x_0)$}
	\put(47, 41){$k_x(x_0)$}
	\put(63, 30){$k_y(x_0)$}
	\end{overpic}
	\hspace{10mm}
	\begin{overpic}[width = 0.45\columnwidth ]{Figures/WFS_theory/Spherical_wave_Stationary_point_2.png}
	\scriptsize
	\put(-5,2){(b)}
	\put(99, 19){$x$}
	\put(16, 69){$y$}
	\put(8, 53){$y_{\mathrm{ref}}$}
	\put(82.5, 19){$x_{\mathrm{ref}}$}
	\put(38, 19){$\vxo$}
	\put(16, 4.5){$\vxs$}
	%\put(74,42){$d(x_0)$}
	\put(45.5, 25){$\varphi$}
	\put(43, 33){$\mathbf{k}(x_0)$}
	\put(50, 43){$k_x(x_0)$}
	\put(66, 30){$k_y(x_0)$}
	\put(85, 55){$\mathbf{x}_{\mathrm{ref}}$}
	\put(27, 18){$r_0$}
	\end{overpic}	
\caption{Geometry for finding the position of correct synthesis for case of a plane wave (a) and cylindrical wave (b)}
	\label{Fig:25D_WFS:Position of correct synthesis}
\end{figure}

In Section \ref{Section:25D_WFS:SPA} the link between the stationary point and the wavenumber vector of the 2D virtual source $\vk(x_0) = [k_x(x_0),\ k_y(x_0)]^{\mathrm{T}}$ given on the SSD was introduced.
The positions of amplitude correct synthesis lie in the direction of the normalized wavenumber vector $\vhk(x_0) = \vk(x_0)/k$ from each SSD element $x_0$ at a distance $d(x_0) = |\vx-\vxo|$, since this is the distance at which the compensated 3D Green's function coincides with the 2D one.
The coordinates of the \emph{points of correct synthesis (PCS)} are thus given by %$\mathbf{x}_{\mathrm{ref}}(x_0)$:
\begin{align}
\label{Eq:xRefyRef_2D_General}
\mathbf{x}_{\mathrm{ref}}(x_0)=
\colvec{2}{x_{\mathrm{ref}}(x_0)}{y_{\mathrm{ref}}(x_0)}
=
\vxo + \vhk(\vxo)|\vx-\vxo|
=
\colvec{2}
{x_0 + \frac{k_x(x_0)}{k} d(x_0)}
{\frac{k_y(x_0)}{k} d(x_0)}
%x_{\mathrm{ref}}(x_0)& = x_0 + \frac{k_x(x_0)}{k} d(x_0)\\
%y_{\mathrm{ref}}(x_0)& =\frac{k_y(x_0)}{k} d(x_0).
\end{align}
\emph{The positions of correct synthesis are therefore restricted to a parametric curve, with the free variable being the SSD position $x_0$, and the shape of the curve is given by the referencing function and the virtual source model trough $\mathbf{k}(x_0)$.} %See Figure \ref{Fig:25D_WFS:Position of correct synthesis} for an illustration.

\paragraph{For a virtual 2D plane wave} the wavenumber vector / propagation direction ($k_z=0$) is
\begin{equation}
\label{Eq:kx0_PW}
\vk_{\text{PW}}(x_0) = \colvec{2}{ k_x(x_0) }{ k_y(x_0)} =  k\colvec{2}{\cosfi_\text{PW}}{\sinfi_\text{PW}}
\end{equation}
and with \eqref{Eq:kx0_PW} into \eqref{Eq:xRefyRef_2D_General} the positions of correct synthesis are 
\begin{align}
\vx_{\mathrm{ref,PW}}(x_0)=
\colvec{2}
{x_0 + \cosfi_\text{PW} \, d(x_0)}
{\sinfi_\text{PW} \, d(x_0)}.
%x_{\mathrm{ref}}(x_0)& = x_0 + \cosfi_\text{PW} \, d(x_0) \\
%y_{\mathrm{ref}}(x_0)& = \sinfi_\text{PW} \, d(x_0).
\end{align}
For the illustration see Figure \ref{Fig:25D_WFS:Position of correct synthesis} (a).

\paragraph{For a virtual line source} consider the location at $\mathbf{x}_s = [ x_s,\ y_s ]^{\mathrm{T}}$ with $r_0 = | \vxo - \mathbf{x}_s |$.
For the sake of convenience $y_s<0$ restricts the virtual source behind the SSD.

The wavenumber vector is obtained by evaluating the derivative of the line source's phase function using the high-frequency/far-field approximation of the Hankel function \eqref{Eq:25D_WFS:Hankel_approx}
\begin{equation} 
\label{Eq:Line_source_correcty_synth}
\vk_{\text{LS}}(x_0)
=-\colvec{2}
{\left.
\frac{\partial(\cdot)}{\partial x} \right|_{x = x_0} 
}{
\left.
\frac{\partial(\cdot)}{\partial y} \right|_{y = 0} 
}
\left(-k\,\sqrt{(x-x_s)^2 + (y-y_s)^2}\right)
=k\colvec{2}
{\frac{x_0- x_s}{r_0}
}{
\frac{-y_s}{r_0}
}, 
\end{equation}
which then is inserted into \eqref{Eq:xRefyRef_2D_General} yielding
\begin{align}
\vx_{\mathrm{ref,LS}}(x_0)=
\colvec{2}
{x_0 + \frac{x_0- x_s}{r_0} d(x_0)}
{\frac{-y_s}{r_0} d(x_0)}
\end{align}
The same conclusion may be drawn from simple geometrical considerations, as shown in Figure \ref{Fig:25D_WFS:Position of correct synthesis} (b).

Now we are able to estimate the PCS of different parametric curves by varying $d(x_0)$.
The different referencing approaches are validated using the virtual source configurations shown in Figure \ref{Fig:Theory:Real_part}.
\begin{figure}[]
	\centering
	\begin{overpic}[width = .95\columnwidth ]{Figures/WFS_theory/real_part.png}
	\scriptsize
	\end{overpic}
\caption{Real part of the synthesized field for a virtual plane wave (a) and a virtual line source (b) used in the following examples: (a) a virtual plane wave with $\varphi_\text{PW} = 45^{\circ}$ and (b) a line source at $\mathbf{x}_s = [0,\ -1]^{\mathrm{T}}$ both oscillating at $\omega = 2\pi\cdot 1~\mathrm{krad/s}$.}
	\label{Fig:Theory:Real_part}
\end{figure}

\begin{figure}[h]
	\centering
	\begin{overpic}[width = .85\columnwidth ]{Figures/WFS_theory/fixed_referencing.png}
	\scriptsize
	\end{overpic}
\caption{Effects of a constant referencing function: The absolute value of the error measured between the synthesized sound field and the target sound field.
The referencing function is set to $\dref = 2~\mathrm{m}$.
For the virtual plane wave the amplitude is thus referenced on a line at $y = \sinfi_\text{PW}\,\dref = 1.41~\mathrm{m}$.
For a virtual line source the positions of amplitude correct synthesis is given by the curve \eqref{Eq:Fixed_referencing_LS}, denoted by white dashed line.
In front of the virtual source the position of amplitude correct synthesis is located at $\dref$.}
	\label{Fig:Theory:fixed_referencing}
\end{figure}
%
\subsubsection[Referencing with constant dref]{Referencing with constant $\dref$}
With $d(x_0) = \dref$ the distance from the stationary SSD element becomes fixed.
In this referencing scheme the PCS are given by
\begin{align}
\label{Eq:Fixed_referencing_PW}
\vx_{\mathrm{ref,PW}}(x_0) =  \colvec{2}
{ x_0 + \cosfi_\text{PW}\,\dref }{ \sinfi_\text{PW}\,\dref}\\
\label{Eq:Fixed_referencing_LS}
\vx_{\mathrm{ref,LS}}(x_0) =  \colvec{2}
{ x_0 + \frac{x_0-x_s}{r_0}\,\dref }{ \frac{-y_s}{r_0}\,\dref}
\end{align}
for a plane wave and a line source, respectively.
By that a plane wave will be referenced along a line that is parallel to the SSD at $y = \sinfi_\text{PW}\,\dref$, whereas the line source becomes synthesized with correct amplitude along a bell contour.
There the maximum distance $\dref$ corresponds directly to the frontal position of the virtual line source.
For an illustration see Figure \ref{Fig:Theory:fixed_referencing}.

\begin{figure}
	\centering
	\begin{overpic}[width = .85\columnwidth ]{Figures/WFS_theory/line_referencing.png}
	\scriptsize
	\end{overpic}
\caption{Effects of referencing on a line, parallel to the SSD: The absolute value of the error measured between the synthesized sound field and the target sound field for (a) a virtual plane wave and (b) line source is shown.
The referencing function is set to $d_{pw,line}(x_0) = 2 / \sinfi_\text{PW} ~\mathrm{m}$ for the plane wave, and $d_{ls,line}(x_0) = 2 r_0/y_s ~\mathrm{m}$ for the line source, resulting in an amplitude correct synthesis at $\yref = 2~\mathrm{m}$.}
	\label{Fig:Theory:line_referencing}
\end{figure}
\subsubsection{Referencing along a parallel line}
With the appropriate choice of $d(x_0)$ in \eqref{Eq:xRefyRef_2D_General} it is possible to reference amplitude correct synthesis along an arbitrary curve.
A feasible choice is to reference the synthesis to a line that is parallel to the SSD at $y=\yref>0$.
This can be done, by setting the $y$-coordinate of the parametric curve to a constant value.
For a virtual plane wave the correct choice is given by
\begin{equation}
d_\text{line,PW}(x_0) = \frac{\yref}{\sinfi_\text{PW}},
\end{equation}
and for a virtual line source by
\begin{equation}
d_\text{line,LS}(x_0) = \frac{\yref}{-y_s} r_0.
\end{equation}

By substituting back to the WFS driving function \eqref{Eq:Gen_rayleigh_dx0}, it is obtained, that the driving functions, that reference the synthesis of a plane wave and a cylindrical wave to a reference line is given by
\begin{multline}
\label{Eq:Plane_wave_ref_line}
D_\text{line,PW}(x_0,\omega)
=- \sqrt{\frac{8\pi}{\ti k}}\sqrt{\frac{\yref}{\sinfi_\text{PW}}} \left.
\frac{\partial \, \te^{-\ti k (\cosfi_\text{PW}\cdot x_0 + \sinfi_\text{PW}\cdot y)}}{\partial y} \right|_{y = 0}\\
=\sqrt{8\pi\,\ti\,k\,\sinfi_\text{PW}\,\yref\,}\,\te^{-\ti k \cosfi_\text{PW}\cdot x_0 }
=\sqrt{8\pi\,\ti\,k_y\,\yref}\,\te^{-\ti k_x x_0 }
\end{multline}
and
\begin{multline}
D_\text{line,LS}(x_0,\omega) 
=- \sqrt{\frac{8\pi}{\ti k}}\sqrt{\frac{\yref}{y_s} r_0} \left.
\frac{\partial\,G_\text{2D}(\vx -  \mathbf{x}_s,\omega)}{\partial y} \right|_{x=x_0, y = 0} \\
=- \sqrt{\frac{\ti\,k\,\pi\,\yref\,y_s}{2\,r_0}}  H_1^{(2)}( k r_0 )
\end{multline}
respectively.
For the case of a virtual plane wave this is a well-known result, equivalent with the explicit SDM solution \cite[(29)]{Ahrens2010a}, \cite{Schultz2016:DAGA, Ahrens2012}.
%This fact suggest that explicit solution for a linear SSD operates based on the same principle by matching the amplitude and phase based on the direction of the virtual source and the SSD elements analytically, in the wave number domain.

As a generalization one may express the driving function for an arbitrary 2D target sound field, referencing the synthesis on the reference line.

With the introduced high-frequency gradient approximation \eqref{eq:25D_WFS:gradient_appr} applyied for the $y$-derivative
\begin{align}
\frac{\partial P(x,y,\omega)}{\partial y}  \approx  -\ti k_y(x,y) P(x,y,\omega)
\end{align}
and the general parallel line's referencing function, cf.
\eqref{Eq:xRefyRef_2D_General}
\begin{align}
d(x_0) = \frac{k}{k_y(x_0)}\,\yref
\end{align}
the driving function \eqref{Eq:Gen_rayleigh_dx0} becomes
\begin{equation}
D(x_0,\omega) = \sqrt{8\pi\,\ti\,k_y(x_0)\,\yref } P(x_0,0,\omega).
\end{equation} 
This formulation requires only the pressure and the $y$-derivative of the phase of the virtual sound field.
%, and ensures amplitude correct synthesis on a reference line.

\subsubsection{Relation with the explicit solution}
Since plane waves give a full orthogonal basis for an arbitrary 2D sound field, therefore the driving function of an arbitrary 2D sound field may be constructed from the plane wave driving functions with the appropriate referencing function, expressed in terms of $k_x$ and $k_y$.
 As an example: the driving function referencing the synthesis on a reference line is obtained from the spatio-temporal spectrum/plane wave decomposition of the virtual sound field measured on the SSD utilizing \eqref{Eq:Plane_wave_ref_line}: %\fscom{$\hat{P}$ is not introduced}
\begin{equation}
D(x_0,\omega) = \frac{1}{2\pi} \int\limits_{-\infty}^{\infty} \hat{P}(k_x,0,\omega) \,\sqrt{8\pi\,\ti\,k_y\,\yref} 
\,\te^{-\ti k_x x_0}\,
 \td k_x,
	\label{Eq:General_WFS_in_kx_domain}
\end{equation}
where $\hat{P}(k_x,0,\omega)$ is the angular spectrum/spatial Fourier transform of the target sound field taken on the SSD.

\begin{figure} 
	\centering
	\raisebox{-0.5\height}{\begin{overpic}[width = .4\columnwidth ]{Figures/WFS_theory/circular_referencing.png}
	\scriptsize
	\put(100,22){$x$}
	\put(10, 61){$y$}
	\put(20, 30){$R_{\mathrm{ref}}$}
	\put(35, 11){$r_0$}
	\put(55, 34){$\dref$}
	\end{overpic}}
	\hspace{10mm}
	\raisebox{-0.5\height}{\begin{overpic}[width = .5\columnwidth ]{Figures/WFS_theory/circle_referencing.png}
	\scriptsize
	\end{overpic}}
\caption{Referencing a line source on a circle: Geometry for finding the corresponding referencing function (a), and the absolute value of the error measured between the synthesized sound field and the target sound field (b) for a line source at $\mathbf{x}_s = [0,\ -1]^{\mathrm{T}}$.
The synthesis is referenced on a circle around the line source, with a radius of $R_{\mathrm{ref}} = y_s + 2 ~\mathrm{m}$.
}
	\label{Fig:Theory:circle_referencing}
\end{figure}

\vspace{3mm}
As it was stated in section \ref{Sec:SFS_theory:linear_SDM} the explicit SDM driving function \eqref{Eq:Theory:LinearSDM1} can not be further simplified in case of a 3D target sound field.
However when a 2D target field is considered it can be expressed in terms of the target spectrum on the SSD by using 2D wave field extrapolation applying \eqref{Eq:Theory:Wave_field_extrapolation} with $k_z = 0$, i.e.\ %
 \begin{equation}
D_{\mathrm{SDM}}(x_0,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \frac{ \hat{P}(k_x,0,\omega) \te^{-\ti k_y |\yref|}}{
-\frac{\ti}{4}H_0^{(2)}\left( k_y |\yref| \right) }
\te^{-\ti k_x x_0 }
\td k_x.
\label{Eq:25D_WFS:2D_sdm}
\end{equation}
holds, with $k_y = \sqrt{k^2-k_x^2}$.
The large-argument approximation of the Green's function spectrum is yielded by applying the stationary phase approximation to the Fourier integral 
\begin{equation}
-\frac{\ti}{4} H_0^{(2)} \left( \sqrt{k^2-k_x^2} |\vx| \right)  = \int_{-\infty}^{\infty} \frac{1}{4\pi} \frac{\te^{-\ti k|\vx|}}{|\vx|}
\te^{\ti k_x x} \td x
\approx  
\frac{\te^{-\ti k_y |\vx|}}{\sqrt{8\pi\ti k_y |\vx|}}.
\end{equation}
valid for $|\vx| \gg 1$ i.e.\ here in the far-field of the SSD.
Substituting the approximated spectrum into \eqref{Eq:25D_WFS:2D_sdm} the exponentials cancel out, and one obtains the WFS driving functions, given by \eqref{Eq:General_WFS_in_kx_domain}.
This remark indicates the fact, that WFS with a linear SSD and a linear reference curve is the general approximation of the explicit solution for the same setup.

\subsubsection{Referencing along a circle}
For a cylindrical virtual source it might be feasible in several applications to reference the synthesis on a circle around the center of the virtual source.
The example is presented in order to demonstrate the validity of the presented referencing approach.

Referencing to a circle with a radius of $R_{\mathrm{ref}} > r_0$ may be done by observing the problem geometry in Figure \ref{Fig:Theory:circle_referencing} (a).

In the stationary point $R_{\mathrm{ref}} = \dref + r_0$, thus
%
\begin{equation}
d_\text{circle,LS}(x_0) = R_{\mathrm{ref}} - r_0.
\label{Eq:dCircleLS}
\end{equation}
For the result of this type of referencing see Figure \ref{Fig:Theory:circle_referencing} (b).

\section{2.5D WFS of 3D sound fields}

All the foregoing holds for pure 2D sound fields, invariant to the vertical direction (here $z$). 
In many practical cases the virtual source model is a virtual point source with a flat frequency response and an attenuation factor of $\frac{1}{4\pi\,r}$ opposed to a line source. 
The different attenuation factor yields that---although the stationary point remains in the same position in the horizontal direction as for a line source due to the same phase functions in the plane of the synthesis---the same referencing function results in amplitude error in a  distance $\dref$ measured from a stationary SSD element. 
This phenomenon is referred to as \emph{virtual source dimension mismatch}, and has already been reported in e.g. \cite{Voelk2012}.

\subsection{2.5D Neumann Rayleigh Integral}
In order to find the PCS with the incorporation of the 3D nature of a point source the 3D Rayleigh integral \eqref{eq:25D_WFS:3D_neumann} is applied. 
Assuming a virtual 3D point source at $\vxs = [x_s,\ y_s,\ 0]^{\mathrm{T}}$  the Rayleigh integral reads
\begin{equation}
\label{Eq:Rayleigh3DPointSrc}
P(\vx,\omega) = -2 \iint\limits_{-\infty}^{\infty} \left. \frac{\partial}{\partial y} G_{3\text{D}}\left( \vxo-\vxs,\omega \right) \right|_{\vx = \vxo} G_{3\text{D}}\left( \vx-\vxo,\omega \right)\,\td x_0\,\td z_0.
\end{equation}
Again, the SPA is applied in order to approximate the integral along the $z$-dimension. Obviously, for any listener position in the plane of the synthesis the vertical stationary position is at $z_0^*=0$. This holds for an arbitrary 3D sound field, for which $k_z(x,y,0) = 0$. By applying the high-frequency gradient of the target field \eqref{eq:25D_WFS:gradient_appr} the phase function and its second derivative under consideration is now
\begin{equation}
\phi(z_0^*) = -k \left( |\vxo -\vxs| + |\vx - \vxo| \right) +\pi/2, \hspace{10mm} \phi''(z_0^*) = -k\left(   \frac{1}{| \vxo - \vxs|} + \frac{1}{ |\vx - \vxo |} \right).
\end{equation}
with $\vx = [x,\ y,\ 0]^{\mathrm{T}}$, $\vxo = [x_0,\ 0,\ 0]^{\mathrm{T}}$ being the in-plane distances. 
Note the difference of $|\phi''(z^*)| = k \frac{1}{ |\vx - \vxo| }$ for the virtual 2D line source and $|\phi''(z^*)| = k \left( \frac{1}{| \vx - \vxo|} + \frac{1}{ |\vxo - \mathbf{x}_s |} \right)$ for the virtual 3D point source. 
In the latter case, not only the secondary source, but also the virtual source attenuation needs to be corrected.

Evaluating the integral by substituting the corresponding expressions into \eqref{Eq:SPAResult}---with taking the negative sign of the second derivative into consideration---leads to the 2.5D Neumann Rayleigh integral for a 3D target field
\begin{equation}
\label{Eq:Rayleigh25DPointSrc}
P(\vx,\omega) = -2 \int\limits_{-\infty}^{\infty}\sqrt{ \frac{2\pi}{\ti k} }\sqrt{\frac{|\vxo-\vxs| |\vx-\vxo|}{|\vxo-\vxs| + |\vx-\vxo|}} \left. \frac{\partial}{\partial y}  G_{3\text{D}}\left( \vx-\vxs,\omega \right) \right|_{\vx = \vxo} G_{3\text{D}}\left( \vx-\vxo,\omega \right)\,\td x_0,
\end{equation}
or written in the more general form
\begin{equation}
\label{Eq:Rayleigh25DGeneral}
P(\vx,\omega) = -2 \int\limits_{-\infty}^{\infty}
\sqrt{\frac{2\pi}{\ti| \phi_P''(\vxo,\omega) + \phi_G''(\vxo,\omega)|}} 
\left. \frac{\partial}{\partial y}  P\left( \vx,\omega \right) \right|_{\vx = \vxo} 
G_{3\text{D}}\left( \vx-\vxo,\omega \right)\,\td x_0.
\end{equation}

\subsection{2.5D WFS driving function for a virtual 3D point source}
The 2.5D Neumann Rayleigh integral contains the implicit solution of the SFS problem for a virtual 3D point source in terms of the unknown driving function $D(x_0, \omega)$
\begin{equation}
D(x_0,\omega) = 
- 2\,\sqrt{\frac{2\pi}{\ti k}} \sqrt{\frac{| \vxo - \mathbf{x}_s |\cdot | \vx - \vxo|  }{| \vxo - \mathbf{x}_s | + | \vx - \vxo| }} \left. \frac{\partial G(\vx-\vxs,\omega)}{\partial y} \right|_{\vx = \vxo}.
\label{Eq:2_5D_point_source_implicit_df}
\end{equation}
Comparing this result with \eqref{Eq:2_5D_driv_fun_implicit} it is revealed, that the virtual source mismatch can be compensated with the correction factor $\sqrt{\frac{| \vxo - \mathbf{x}_s |  }{| \vxo - \mathbf{x}_s | + | \vx - \vxo| }}$ and therefore the 3D point source driving function consist of the following terms:
\begin{equation}
D(x_0,\omega) = 
\underbrace{\sqrt{\frac{2\pi}{\ti k}}}_{\substack{\text{SSD freq.}\\\text{compensation}}} 
\underbrace{\sqrt{ | \vx - \vxo|}}_{\substack{\text{SSD amp.}\\\text{compensation}}} 
\underbrace{\sqrt{\frac{| \vxo - \mathbf{x}_s |  }{| \vxo - \mathbf{x}_s | + | \vx - \vxo| }}  }_
{\substack{\text{Virt. source}\\\text{amp. comp.}}}\times
\underbrace{ \left. -2 \frac{\partial P(\vx,\omega)}{\partial y}  \right|_{\vx = \vxo}}_{\text{3D driving function}}.
\label{Eq:2_5D_point_source_implicit_df_Explanations}
\end{equation}
Also in the 3D case, the horizontal SPA holds, and the stationary SSD element is found in the same position as for the case of a virtual line source at $z=0$.
The correction factor gains physical meaning the horizontal stationary position ($\vk_P(\vxo) = \vk_G(\vxo)$), i.e. where $|\vxo-\vxs| + |\vx - \vxo| = |\vx-\vxs|$:
in the stationary position the numerator stands for the attenuation correction from the point source to the SSD, and the denominator for the correction from the point source to the listener position. 

Recently, a physical interpretation was given for the correction factors by Völk\cite{Voelk2012}, based on introducing manual correctional terms. 
Although giving a very specific solution for the general problem, the main idea is outlined here in order to give an insight into the 2.5D WFS driving functions. 
It is known, that 2D WFS is capable of the synthesis of 2D point sources using a linear array of vertical line sources, i.e.
\begin{equation}
G_{2D}(\vx-\vxs) = -2\int_{-\infty}^{\infty} \left. \frac{\partial}{\partial y}G_{2D}(\vx-\vxs)\right|_{\vx = \vxo} G_{2D}(\vx-\vxo)\td x_0.
\end{equation}
In order to adjust the equation for the synthesis of 3D point sources using a linear array of 3D point sources and applying the derivative of the 3D target field taken on the SSD three correction factors are needed
\begin{itemize}
\item in order to apply 3D point sources as SSD elements the secondary source correction is applied to the integral kernel, i.e. $G_{3D}(\vx-\vxo)/G_{2D}(\vx-\vxo)$.
\item to express the driving functions in term of the 3D point source driving function the adjustment by $\frac{\partial}{\partial y} G_{3D}(\vxo-\vxs)/\frac{\partial}{\partial y} G_{2D}(\vxo-\vxs)$ is needed.
\item these corrections would result in the synthesis of a 2D point source written in terms of 3D ones. 
Finally to let the 2D Rayleigh integral describe a 3D point source both sides should be multiplied by $G_{3D}(\vx-\vxs)/G_{2D}(\vx-\vxs)$.
These latter two constitute the virtual source compensation factor.
\end{itemize}
Applying the high-frequency approximations for the Green's functions \emph{around the vertical stationary point} the two approaches result in the very same driving functions, given by \eqref{Eq:2_5D_point_source_implicit_df_Explanations}.
This statement gives us an important insight into the WFS compensation factors, also reflecting, that the vertical and horizontal SPAs are inherently related, since the result of the vertical SPA can be physically interpreted only in the horizontal stationary point.


\subsection{Referencing schemes for 3D sound fields}

\subsubsection{Referencing function}
For the general WFS driving function \eqref{Eq:Gen_rayleigh_dx0}
\begin{equation*}
D(x_0,\omega) = 
- \sqrt{\frac{8\pi}{\ti k}} \sqrt{d(x_0)} \left. \frac{\partial P(\vx,\omega)}{\partial y}\right|_{\vx = \vxo},
\end{equation*}
the \emph{referencing function} $d(x_0)$ for each SSD element can be stated as
\begin{equation}
d(x_0) = \frac{ | \vxo - \mathbf{x}_s | \cdot | \vx - \vxo|  }{ | \vxo - \mathbf{x}_s | + | \vx - \vxo| }
\label{Eq:dx0_PointSource}
\end{equation}
from \eqref{Eq:2_5D_point_source_implicit_df} and \eqref{Eq:2_5D_point_source_implicit_df_Explanations}. For the sake of brevity $r_0 = | \vxo - \mathbf{x}_s |$ is used in the followings.

\subsubsection{Parametric Curves}
The synthesis may be referenced to an arbitrary curve. From \eqref{Eq:dx0_PointSource} the PCS measured from the stationary SSD point
\begin{equation}
|\vx - \vxo| = d(x_0)\frac{r_0}{r_0 - d(x_0)}
\label{Eq:dx0_PointSource_xx0}
\end{equation}
are derived. 
Comparing the referencing function \eqref{dx0_2DSources} for virtual 2D sound fields and \eqref{Eq:dx0_PointSource_xx0} for the virtual point source, the substitution
\begin{equation}
d(x_0) \rightarrow d(x_0)\frac{r_0}{r_0 - d(x_0)}
\label{Eq:dx0_mapping}
\end{equation}
allows for utilizing the parametric curve description \eqref{Eq:Line_source_correcty_synth} that was derived for the virtual line source, due to the equality of the thir wavenumber vectors in $z=0$. 
This yields the PCS
\begin{align}
\mathbf{x}_{\mathrm{ref,PS}}(x_0)=
\colvec{2}
{x_0 + (x_0-x_s) \frac{d(x_0)}{r_0 - d(x_0)} }{
-y_s \frac{d(x_0)}{r_0 - d(x_0)}}.
\label{Eq:3D_curve}
\end{align}

\begin{figure}
	\centering
	\begin{overpic}[width = 0.85\columnwidth ]{Figures/WFS_theory/point_source_referencing.png}
	\scriptsize
	\end{overpic}
\caption{Referencing the synthesis of a 3D point source with a constant referencing function (a), to a reference line (b) and to a circle around the virtual source (c). The virtual source is a point source located at $\mathbf{x}_s = [0,\ -3,\ 0]^\mathrm{T}$, oscillating at $\omega = 2\pi \cdot 1 ~\mathrm{krad/s}$. For the constant referencing $\dref = 1.5~\mathrm{m}$ is set. Note, that in front of the point source the amplitude correct synthesis is ensured at $\frac{y_s}{y_s/\dref - 1 } = 3~\mathrm{m}$. For the case of referencing to a line $\yref = 1.5~\mathrm{m}$, while for referencing to a circle $R_{\mathrm{ref}} = y_s + 1.5~\mathrm{m}$ was chosen.}
	\label{Fig:Theory:point_source_referencing}
\end{figure}

\subsubsection[Referencing with constant dref]{Referencing with constant $\dref$}
By fixing the referencing function to a constant value $d(x_0) = \dref$ in \eqref{Eq:3D_curve} the PSC are given by
\begin{equation}
\mathbf{x}_{\mathrm{ref}}(x_0)  =  
\colvec{2}
{x_0 + (x_0-x_s)\frac{1}{r_0/\dref - 1 } }
{-y_s \frac{1}{r_0/\dref - 1}}.
\label{Eq:3D_fixed_reference}
\end{equation}
This parametric curve is similar to that of the 2D line source case (cf. \eqref{Eq:Fixed_referencing_LS}, Figure \ref{Fig:Theory:fixed_referencing}), however with several important differences.

The $y$-coordinate exhibits a maximum in front of the virtual source, where $r_0 = |y_s|$. For any other position the PCS is closer to the SSD. 
Therefore, $r_0 = |y_s|$ is the critical point of the curve: a position of correct synthesis can only be found in the listening area if $|y_s| > \dref$, i.e. the virtual source must be further away from the SSD than the fixed reference distance. 
Actually, the synthesis gives a fair result close to the SSD only in case, $|y_s| \gg \dref$. 
As the virtual source approaches the SSD the position of correct synthesis tends to infinity.
This type of referencing therefore may suffer from serious amplitude errors in the vicinity of the SSD.

The result of synthesis using constant referencing is often investigated along a line, parallel with the SSD at $y=\yref$, i.e. on the reference line. 
In the previous section it was revealed, that for a virtual plane wave the constant referencing function differs from that, referencing the synthesis on the reference line in a factor of $\sqrt{\sinfi}$. 
This fact is also pointed out in \cite[(30)]{Ahrens2010a}, \cite[Ch. 3.9.4]{Ahrens2012}, \cite{Schultz2016:DAGA}. 
From this, it is clear, that using constant referencing the synthesized field on the reference line will read
\begin{equation}
P_{\mathrm{synth,PW}}(x,\yref,\omega) = \sqrt{\sinfi_\text{PW}} \, P_{\mathrm{ideal,PW}}(x,\yref,\omega) 
\end{equation}
%
which particular result has already been pointed out in \cite[3.9.4]{Ahrens2012}.
For a virtual line source located at $\mathbf{x}_s = [x_s,\ y_s,\ 0]$:
%
\begin{equation}
P_{\mathrm{synth,LS}}(x,\yref,\omega) = \sqrt{\cosfi_0(x)} \, P_{\mathrm{ideal,LS}}(x,\yref,\omega),
\end{equation}
where $\cosfi_0(x) = \langle\, \frac{\vx- \mathbf{x}_s}{|\vx- \mathbf{x}_s|}, \mathbf{n}_\text{SSD}\rangle$ with $\mathbf{n}_\text{SSD} = [0,\ 1,\ 0]^{\mathrm{T}}$ for the present setup.
For a virtual point source the error stemming from the virtual source dimensional mismatch is also present, therefore the synthesized field with constant referencing will read
%
\begin{equation}
P_{\mathrm{synth,PS}}(x,\yref,\omega) = \sqrt{\frac{ | \vxo - \mathbf{x}_s | + | \vx - \vxo| }{ | \vxo - \mathbf{x}_s |}} \times
\sqrt{\cosfi_0(x)} \, P_{\mathrm{ideal,PS}}(x,\yref,\omega).
\end{equation}
%
This type of error can be examined in \cite[Fig.5.13.]{Ahrens2012} with normalized amplitudes (i.e. the constant error factor from the virtual source dimensional mismatch is not shown in the figure.).

\subsubsection{Referencing along a parallel line}
Referencing along a line that is parallel to the SSD at distance $y=\yref>0$ is obtained by setting the $y$-coordinate of \eqref{Eq:3D_curve} to
\begin{equation}
-y_s \frac{d(x_0)}{r_0 - d(x_0)} = \yref.
\end{equation}
The resulting referencing function reads
\begin{equation}
d_\text{line,PS}(x_0) = r_0 \frac{\yref}{\yref-y_s}.
\end{equation}
Substituting it back to \eqref{Eq:2_5D_point_source_implicit_df} and applying the high-frequency gradient approximation, with $k_{y,\text{PS}}(\vxo) = k \frac{y_0-y_s}{r_0} $ one obtains
\begin{equation}
D(x_0,\omega) = 
- \sqrt{\frac{\ti k}{2\pi}} \sqrt{\frac{\yref}{\yref -y_s}}  y_s \frac{\te^{-\ti k r_0 }}{r_0^{3/2}},
\end{equation}
which exactly yields the well-known WFS driving function \cite[(2.27)]{Verheijen1997}, \cite[(3.16)\&(3.17)]{Start1997:phd} of a point source, that is equivalent to the farfield/high-frequency approximated explicit SDM solution \cite[(25)]{Spors10ahrens:analysis}.

\subsubsection{Referencing along a circle}
Referencing the synthesis along a circle around the point source in the synthesis plane is obtained by solving, cf. \eqref{Eq:dx0_mapping} and \eqref{Eq:dCircleLS}
\begin{equation}
d(x_0)\frac{r_0}{r_0 - d(x_0)} = R_{\mathrm{ref}} - r_0,
\end{equation}
resulting in
\begin{equation}
d_\text{circle,PS}(x_0)  = r_0 \frac{R_{\mathrm{ref}} - r_0}{R_{\mathrm{ref}}}.
\end{equation}
%
The performance of this referencing type is demonstrated in Figure \ref{Fig:Theory:point_source_referencing} (c).

\section{2.5D WFS for non-linear secondary source distributions}

\subsection{2.5D Neumann Rayleigh integral}
%
\begin{figure}
	\centering
	\begin{overpic}[width = 0.7\columnwidth ]{Figures/WFS_theory/wfs_nonlinear_Geometry.png}
	\scriptsize
	\put(17,14){$x$}	
	\put(12,28){$y$}	
	\put(1, 36){$z$}
	\put(33.5,20){$\vxo$}
	\put(46.6,31.5){$\vx$}
	\put(80,34){synthesis plane}
	\put(69,42){$\dO_{3\mathrm{D}}$}
	\put(69,23){$\dO_{2.5\mathrm{D}}$}
	\end{overpic}
\caption{General 3D WFS geometry for the derivation of 2.5D driving functions.
The SSD surface $\dO_{3\mathrm{D}} = f(x_0,y_0)$ is chosen to be independent of $z$-coordinate in order to be able to evaluate the integral with respect to $z_0$ using the SPA. If the virtual sound field is a 2D one, propagating in the direction parallel to the listening plane the the SSD can be interpreted as a continuous set of infinite vertical line sources along $\dO_{2.5\mathrm{D}}$ (described by the 2D Green's function), capable of the perfect synthesis of a virtual 2D field inside the enclosure.}
	\label{Fig:WFS_Theory:non_linear_geometry}
\end{figure}
%
In order to extend the 2.5D WFS theory for non-linear SSDs the geometry depicted in Figure \ref{Fig:WFS_Theory:non_linear_geometry} is considered. The SSD surface is chosen to be an enclosing contour in the $xy$-plane, being invariant along the vertical dimension.
Under high-frequency assumptions the general 2D/3D WFS driving functions, given by \eqref{eq:theory:gen_WFS} can be applied. In this special geometry the synthesized field inside the enclosure can be written in the form
\begin{equation}
P(\vx,\omega) = -2 \oint\displaylimits_{\dO_{2.5\mathrm{D}}} \int\displaylimits_{-\infty}^{\infty} w(\vxo) \frac{\partial P(\vxo,\omega)}{\partial \vni} G(\vx-\vxo,\omega) \, \td z_0 \, \td \dO_{2.5\mathrm{D}}(x_0,y_0).
\end{equation}
Similarly to the planar SSD case, the vertical integral may be approximated by the SPA. Again, $k_{z,P}(x,y,0)$ is assumed, i.e. virtual fields, propagating in the plane of synthesis parallel in $z=0$ direction. The stationary position for any $z=0$ receiver position therefore becomes trivially $z_0^*=0$, and the surface integral can be approximated by a contour integral, termed as the \emph{general 2.5D Neumann Rayleigh integral}
\begin{multline}
P(\vx,\omega) = -2 \oint\displaylimits_{\dO_{2.5\mathrm{D}}} \sqrt{\frac{2 \pi}{\ti \left| \phi''_{P,z,z}(\vxo,\omega) +  \phi''_{G,z,z}(\vx - \vxo,\omega) \right|}} \\
w(\vxo) \frac{\partial P(\vxo,\omega)}{\partial \vni} G(\vx-\vxo,\omega) \, \td \dO_{2.5\mathrm{D}}(x_0,y_0),
\end{multline}
with $\vx = [x,y,0]^{\mathrm{T}}$, $\vxo = [x_0,y_0, 0]^{\mathrm{T}}$ denoting in-plane positions.

The integral implicitly contains the---yet receiver position dependent---2.5D driving functions. Substituting the second derivative of the 3D SSD elements' field yields the general form 
\begin{equation}
D(\vxo,\omega) = -2 w(\vxo) \sqrt{\frac{2 \pi}{\ti k}}\sqrt{\dref(\vxo)}
\frac{\partial P(\vxo,\omega)}{\partial \vni},
\end{equation}
where the referencing function takes the same form as given by \eqref{dx0_2DSources} and \eqref{Eq:dx0_PointSource} for a 2D and a 3D point source target field respectively. Using the Kirchhoff approximation therefore the 2.5D driving functions are given by the 2.5D linear driving functions, completed by the already known windowing function.

In the followings it is demonstrated, that the referencing approach, described earlier may be applied without any modification for arbitrary SSD contours. 
Since both SPA and Kirchhoff-approximation are valid at high-frequency regions no further presumptions are required. The positions of correct synthesis are therefore given by
\begin{equation}
\vxref = \vxo + \vhk |\vx-\vxo|
\end{equation}
for an arbitrary SSD geometry.


\subsection{Referencing function and referencing schemes}

The validity of the referencing schemes are demonstrated via the example of a circular SSD with a radius of $R_0$. 
For such an SSD ensemble the normal derivative is given by the radial derivative and the WFS driving function reads
\begin{equation}
D(\beta,\omega) = + \sqrt{\frac{8\pi}{\ti k}}\,w(\beta)\,\sqrt{d(\beta)} \left. \frac{\partial P(r,\beta)}{\partial r}  \right|_{r = R_0}.
\end{equation}

\begin{figure}
	 \centering
	 \begin{overpic}[width = .95\columnwidth]{Figures/WFS_theory/real_part_circular.png}
	 \end{overpic}
 \caption{ The synthesis of a plane wave (a) and a line source (b), used in the following examples. The plane waves propagates in the $x$-direction. The line source is located at $\mathbf{x}_s = [-3,\ 0]^{\mathrm{T}}$. The SSD is a circular array with $R_0 = 2~\mathrm{m}$. The source frequency is set to $\omega_0 = 2\pi	\cdot 1 ~\mathrm{krad/s}$.}
	 \label{Fig:Theory:real_part_circular}
 \end{figure}
%
The referencing function $d(\beta)$ for an arbitrary curve can be found in the same manner as for a linear SSD using the SPA. 
In this case geometrical considerations give us a much simpler referencing method: the stationary secondary source can be found where the wavenumber vector intersects the SSD, which is a constant directed vector for a plane wave, and any vector directed radially from the source position for a line/point source. 
The position of reference position can be found in the same direction from any stationary secondary source in a distance of $d(\beta)$ in the plane wave and line source case, and $d(\beta)\frac{r_0}{r_0-d(\beta)}$ for a 3D point source.

Two referencing schemes are presented in order to demonstrate the validity of the presented approach: referencing the synthesis along a straight line, and along a concentric circle inside the circular SSD.

\subsubsection{Effects of constant referencing}

First, the effect of a constant referencing function is investigated. 
For both a plane wave and a line source the position of correct synthesis can be found based on the problem geometry.

\begin{figure}
	\centering
	\begin{overpic}[width = .85\columnwidth  ]{Figures/WFS_theory/fixed_referencing_circle.png}
	\scriptsize
	\put(6,36.2){$\varphi_\text{PW}$}
	\put(43, 17){$x$}
	\put(23, 39){$y$}
    \put(9.5,30){$\dref$}
    \put(3,  39){$\mathbf{k}$}
    \put(17.5, 19.2){$\beta$}
	\put(3.5,    27){$\vxo$}
%
    \put(63.5, 27.5){$\dref$}
    \put(100,17){$x$}
    \put(79, 38){$y$}
    \put(69, 22){$R_0$}
    \put(56.5,21.5){$r_0$}
    \put(58.5,19.5){$\alpha$}
    \put(68.5,19.5){$\beta$}
    \put(55,  17){$\mathbf{x}_s$}
	\end{overpic}
\caption{ Geometry for finding the position of amplitude correct reproduction of a plane wave (a) and a line source (b) }
	\label{Fig:Theory:fixed_referencing_circle}
\end{figure}

For the case of the synthesis of a plane wave it is obvious, that the points from each SSD element at a distance of $\dref$ describe a circle with the same radius as the SSD, translated in the direction of the plane wave by $\dref$. 
See Figure \ref{Fig:Theory:fixed_referencing_circle} (a). The PCS are therefore given by
\begin{eqnarray}
\mathbf{x}_{\mathrm{ref,PW}}(\vxo) = \colvec{2}{ \cos \beta \,R_0  + \cosfi_\text{PW}\, \dref }{  \sin \beta \,R_0  + \sinfi_\text{PW}\, \dref }
\label{Eq:Fixed_referencing_pw_circle}
\end{eqnarray}
with $\varphi_\text{PW}$ being the propagation angle of the plane wave measured from the $x$-axis.
\begin{figure}
	\centering
	\begin{overpic}[width = .95\columnwidth]{Figures/WFS_theory//fixed_referencing_circular.png}
	\end{overpic}
\caption{ Positions of amplitude correct synthesis using circular SSD for a virtual plane wave (a) and line source (b). The referencing function is set to $\dref = 1~\mathrm{m}$. }
	\label{Fig:Theory:fixed_referencing_circular}
\end{figure}

For a virtual line source the parametric curve can be given by the problem geometry, displayed in Figure \ref{Fig:Theory:fixed_referencing_circle} (b).
The PCS are given by
\begin{eqnarray}
\mathbf{x}_{\mathrm{ref,LS}}(\vxo) =  \colvec{2}{ x_s + \cos\alpha \, (\dref + r_0)}{ y_s + \sin\alpha\, (\dref+r_0)}.
\label{Eq:Fixed_referencing_ls_circle}
\end{eqnarray}
This curve is not easily accessible for analytic investigation, however two limiting curves can be described purely from the problem geometry. 
As the virtual source approaches the SSD the curve describes a circle around the virtual source with a radius of $\dref$. 
If the virtual source is very far from the SSD the incident field becomes a plane wave and the curve describes a circle with a radius same as the SSD, translated by $\dref$ into the direction, defined by the position vector of the virtual source. 
%In other virtual source position the curve is a mixture of these two circles. 
It is also ensured, that in front of the virtual source, the distance of amplitude correct synthesis from the corresponding SSD element is $\dref$. 
%This fact is in analogy with the linear SSD case.
Results of numeric simulation, using these referencing schemes are depicted in Figure \ref{Fig:Theory:fixed_referencing_circular}.

\begin{figure}
	\centering
	\begin{overpic}[width = .85\columnwidth]{Figures/WFS_theory/fixed_referencing_circular_ps.png}
	\end{overpic}
\caption{ Positions of amplitude correct synthesis using circular SSD with radius of $R_0 = 1.5~\mathrm{m}$ for a virtual point source with the virtual source positioned at $\mathbf{x}_s = [-2.5,\ 0,\ 0]^{\mathrm{T}}$ (a) and $\mathbf{x}_s = [-4,\ 0,\ 0]^{\mathrm{T}}$ (b). The referencing function is set to $\dref = 1~\mathrm{m}$. In (a) in front of the virtual source is $0.5~\mathrm{m}$, with $r_0< \dref$, therefore no position for correct synthesis can be found. As the virtual source gets further from the SSD (b), $r_0> \dref$ is satisfied, and the position of correct synthesis in front of the virtual source becomes $x_c = x_s + r_0\frac{r_0}{r_0-\dref} = 0$. }
	\label{Fig:Theory:fixed_referencing_circular_ps}
\end{figure}

In each case it should be noted, that the position of amplitude correct synthesis can be defined only inside the SSD. 
Moreover, due to high-frequency approximations for the arbitrary SSD extension the curve of correct synthesis is shorter, than it would be allowed by the previous limitation (i.e. does not limited by the intersections with the SSD). 
This can be explained by two reasons: in the ending of the curves the corresponding stationary SSD elements can not be modeled as flat surfaces in order to apply the Kirchhoff-approximation due to the large local angle of inclination of the incident field. On the other hand in these parts also the diffraction waves would have considerable contribution in the synthesized field, which are inherently omitted in the geometrical optics approximation (i.e. in these parts of the SSD both assumptions for the Kirchhoff approximation fail).
This phenomenon can be observed in both Figure \ref{Fig:Theory:fixed_referencing_circular} (a) and (b).

For the synthesis of a virtual point source the substitution of $\dref \rightarrow \dref \frac{r_0}{r_0 - \dref}$ w.r.t. the line source case in \eqref{Eq:Fixed_referencing_ls_circle} holds as discussed above. The PSC are then given as
\begin{eqnarray}
\mathbf{x}_{\mathrm{ref,PS}}(\vxo) =  \colvec{2}{ x_s + \cos\alpha \, r_0 \frac{r_0}{r_0 - d}  }{ y_s + \sin\alpha\, r_0 \frac{r_0}{r_0 - d} }.
\label{Eq:Fixed_referencing_ps_circle}
\end{eqnarray}
Similarly to the linear SSD case that means, that in front of the virtual source the position of correct synthesis measured from the SSD becomes $\dref \frac{r_0}{r_0- \dref}$, therefore if the point source is closer to the SSD than the reference distance, no position for amplitude correct synthesis can be found. This can be observed in Figure \ref{Fig:Theory:fixed_referencing_circular_ps}.

\subsubsection{Referencing to an arbitrary curve}
\begin{figure}
	\centering
	\begin{overpic}[width = .85\columnwidth]{Figures/WFS_theory/referencing_on_circle_and_line.png}
	\scriptsize
	\put(43, 17){$x$}
	\put(23, 39){$y$}
    \put(9.5,28.5){$d(\varphi)$}
    \put(5,  38){$\mathbf{k}$}
    \put(16, 20){$\beta$}
	\put(4.5,  28){$x_0$}
	\put(12,  22){$R_0$}
	\put(16.5,  25){$R_{\mathrm{ref}}$}
%
    \put(65, 27.5){$d(\varphi)$}
    \put(100,17){$x$}
    \put(80, 39){$y$}
    \put(69, 22){$R_0$}
    \put(56.5,21.5){$r_0$}
    \put(70.5,17){$x_0$}
    \put(68.5,20){$\beta$}
    \put(55,  17){$\mathbf{x}_s$}
	\end{overpic}
\caption{ Geometry for finding $d(\varphi)$ referencing the synthesis of a plane wave to a concentric circle (a) and the synthesis of a line source to a straight line (b). }
	\label{Fig:Theory:referencing_on_line_and_circle}
\end{figure}

Finally it is shown, how synthesis may be referenced to an arbitrary curve. 
Two examples are presented: referencing a plane wave on a circle, and a point source on a line.
Our aim is to find the referencing function $d(\beta)$, equaling the length of the corresponding vector, seen in Figure \ref{Fig:Theory:referencing_on_line_and_circle}. With geometrical considerations they can be expressed as
\begin{eqnarray}
d_\text{circle,PW}(\beta) = R_0\cos \beta - \sqrt{ R_{\mathrm{ref}}^2 - R_0^2\,\sin^2\varphi_\text{PW} }
\\
d_\text{line,LS}(\beta) = -r_0 \left( \frac{x_0 + R_0\cos \beta}{x_s + R_0\cos \beta} \right)
\end{eqnarray}
respectively. 
This latter would ensure the amplitude correct synthesis for a line source. In order to apply the formulation for a 3D point source  $\dref \rightarrow \dref \frac{r_0}{r_0 - \dref}$ substitution is needed, ending up in
\begin{equation}
d_{ps,line}(\beta) = r_0 \frac{x_0 + R_0\cos \beta}{x_0-x_s}.
\end{equation}
The validity of the referencing functions are demonstrated in Figure \ref{Fig:Theory:pw_to_circle_ps_to_line}.
\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/WFS_theory/pw_to_circle_ps_to_line.png}
	\end{overpic}
\caption{ Result of referencing the synthesis of a plane wave to a circle (a) and a 3D point source to a line. The plane wave propagates parallel to the $x$-axis and the point source is located at $\mathbf{x}_s = [-4,\ 0,\ 0]^{}\mathrm{T}$. The radius of the reference circle is $R_{\mathrm{ref}} = 1~\mathrm{m}$ at (a) and the line of referencing is located at $x_0 = -0.5~\mathrm{m}$ in (b).}
	\label{Fig:Theory:pw_to_circle_ps_to_line}
\end{figure}

\newpage
\section{Relation with the explicit solution}
\subsection{SDM driving functions in the spatial domain}
\subsection{Driving functions on the SSD}
	
%
% Referencing focused sources
% Synthesis applying directive SSD
% The WFS pre-fiters in time domain