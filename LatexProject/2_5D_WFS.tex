The chapter presents the implicit solution for the SFS problem using a linear SSD, i.e. 2.5D WFS theory.
During the last three decades two main 2.5D WFS methodologies have been developed, commonly referred to as \emph{traditional WFS} and \emph{revisited WFS}.
Both concepts were able to reconstruct the phase---i.e. the wavefronts--- of the target sound field, with the basic difference lying in the applied virtual source models and in the optimalization of amplitude correct rconstruction.

Traditional WFS theory applying a linear SSD---as first proposed by Berkhout et al. as a holographic approach for sound field control \cite{Berkhout1988}---applied the stationary phase approximation to the 3D Rayleigh integral formulation in order to derive driving functions for a secondary dipole array, modeling electrostatic transducers \cite{Berkhout93}.
The theory focused on the reproduction of virtual 3D point sources, optimizing/\emph{referencing} the synthesis on a line, parallel to the SSD, termed as the \emph{reference line}.
The concept was soon unified for secondary arrays consisting of 3D point sources \cite{Start1997:phd,Vogel1993:phd, Verheijen1997:phd, Bruijn2004, Hulsebos2004}, considering also curved SSDs \cite{start1996application}, directive SSD elements \cite{devries1996sound} or the variation of the reference curve by the manual adjustment of the virtual point source amplitude factor \cite{Sonke1998, Sonke2000:Phd}.

A recent 2.5D WFS generalization by Spors, often termed as \emph{revisited 2.5D WFS} included arbitrary virtual source models applying arbitrary shaped SSDs, with a target field independent referencing factor aiming at the optimization of synthesis to a reference point \cite{Spors2008:WFSrevisited}.
The referencing scheme was further simplified by Ahrens \cite{Ahrens2012} using a constant reference factor.
The approaches account for the SSD dimension correction factors, but neglect the \emph{virtual source dimensionality} mismatch \cite{Voelk2012} in the case of reproducing a 3D point source, resulting in amplitude errors.
Furthermore, the exact positions of the amplitude correct synthesis has not been investigated 

Instead of introducing 2.5D WFS theory via the existing approaches, this chapter presents a novel unified 2.5D WFS formulation that adapts the target wave field characteristics to the referencing function, and ensures optimized synthesis on an arbitrary reference curve applying arbitrary shaped SSDs.
The driving functions are expressed both in terms of the target field, measured at the SSD---similarly to classic WFS techniques--- and measured at the reference curve---similarly to the explicit solution.
The presented approach inherently includes former methods as special cases of the applied referencing schemes.
The chapter overviews the results, presented in \cite{Firtha2016:UnifiedWFS} and \cite{Firtha2016:WFS_vs_SDM}.

\vspace{3mm}
The chapter is structured as follows:
\begin{itemize}
\item 2.5D WFS theory relies heavily on the \emph{stationary phase approximation} (SPA) in order to approximate the 2D and 3D Neumann Rayleigh integrals.
The chapter starts with the introduction of the stationary phase method in section \ref{Section:25D_WFS:SPA}.
\item In the previous chapter, dealing with the Kirchhoff approximation the wavenumber vector was already introduced.
Here a formal definition is given, and by applying the wavenumber vector concept, an expressive physical interpretation is given for the SPA when applied both to the spatial Fourier transform and to the Rayleigh integral, revealing the latter's wavefront matching nature within the context of discussion.
\item Applying the physical interpretation of the SPA section \ref{Sec:Unified_WFS} presents a unified 2.5D WFS framework, allowing amplitude correct synthesis on an arbitrary chosen control curve, termed the \emph{reference curve}.
The presented theory is verified via numerical examples.
\item It is followed by the investigation of the exact relation of 2.5D WFS and the explicit solution in section \ref{Sec:SDM_vs_WFS}.
By the asymptotic evaluation of the general SDM driving function integrals new driving functions are presented, requiring only the target pressure over an arbitrary control curve.
\item Finally, stemming from these later driving functions the general high-frequency equivalence of the implicit and explicit method is presented.
\end{itemize}

%
\section{The stationary phase approximation}
\label{Section:25D_WFS:SPA}
%
As it is verified in the followings 2.5D WFS is the local solution for the general SFS problem, ensuring local wavefront matching.
Extraction of the asymptotic, local solution from the global solution written in terms of either a boundary or a spectral integral is allowed by the stationary phase approximation.

\subsection{The integral approximation}
%
The SPA is a basic tool of asymptotic analysis, applied to approximate integrals around critical points in the integral path.
The method yields approximate solutions of integrals of the form
\begin{equation}
\label{Eq:SPAintegral_1d_nd}
I_{1\mathrm{D}} = \int\limits_{-\infty}^{\infty} F(z) \, \te^{\ti \phi(z)} \, \td z,
\hspace{20mm} 
I_{n\mathrm{D}} = \int\limits_{\dO} F(\vxo) \, \te^{\ti \phi(\vxo)} \, \td \dO(\vxo)
\end{equation}
in one and $n$ dimensions respectively with $\vxo \in \mathbb{R}^{n}$, when $\te^{\ti \phi(\vxo)}$ is highly oscillating and $F(\vxo)$ is comparably slowly varying.


For the 1D case a rigorous derivation of the SPA based on integration by parts is given in \cite{Bleistein1984, Blenstein1975, Williams1999}.
More informally the method relies on the second order truncated Taylor series of the exponent around $z^*$, where $\phi'(z^*) = 0$ and $\phi''(z^*) \neq 0$, with $\phi'(z)$ denoting the derivative with respect to $z$:
\begin{equation}
\phi(z) \approx \phi(z^*) + \frac{1}{2}\phi''(z^*)(z-z^*)^2.
\end{equation}
Point $z^*$ is termed the \emph{stationary point}.

Supposing that $F(z)$ is a slowly varying smooth function compared to $\phi(z)$, it is assumed, that where the phase varies, i.e.\ $\phi'(z) \neq 0$, the integral of rapid oscillation cancels out, thus the greatest contribution to the total integral comes from the immediate surroundings of the stationary point.
Moreover in the proximity of the stationary point $F(z)$ can be regarded as constant with the value $F(z^*)$.

With these considerations the integral becomes
\begin{align}
I_{1D} \approx F(z^*)\,\te^{+\ti\phi(z^*)} 
\int\limits_{-\infty}^{\infty} \te^{+\ti \frac{1}{2}\phi''(z^*)(z-z^*)^2} \, \td z.
\end{align}
The remaining integral can be evaluated and the SPA of \eqref{Eq:SPAintegral_1d_nd} becomes \cite[Ch.\ 2.8]{Blenstein1975}
\begin{equation}
\label{Eq:SPAResult}
I_{1D} \approx \sqrt{\frac{2\pi}{| \phi''(z^*) |}} F(z^*) \, \te^{+\ti \phi(z^*) + \ti \frac{\pi}{4}\,\mathrm{sgn}\left(  \phi''(z^*) \right)}.
\end{equation}
\vspace{3mm}
Similarly, in higher dimensions the stationary point (or more precisely a \emph{simple stationary point}) is defined as
\begin{align}
\label{Eq:ndim_stat_point}
\begin{split}
\left.
\nabla \phi(\vxo)\right|_{\vxo = \vx^*} &= 0,
\\ \vspace{3mm} \\
\det H \neq 0,
\hspace{5mm} 
H &= \left[
\frac{\partial^2 \phi(\vx^*)}{\partial x_i \partial x_j} 
\right],
\hspace{5mm}
i,j = 1,2,...,n,
\end{split}
\end{align}
with $H$ being the Hessian matrix of the phase function.
The multidimensional formula for the integral value reads
\begin{equation}
\label{Eq:SPAResult_nd}
I_{nD} \approx \sqrt{\frac{(2\pi)^n}{|\det H|}} F(\vx^*) \te^{\ti \phi(\vx^*) + \ti \frac{\pi}{4}\,\mathrm{sgn}\left( H \right)},
\end{equation}
where $\mathrm{sgn}\left( H \right)$ is the signature of the Hessian (the number of positive eigenvalues minus the number of negative eigenvalues) \cite{Bleistein2000}.


\subsection{The local wavenumber vector}

In order to interpret the SPA an important concept is introduced: the local properties/asymptotic description of arbitrary sound fields.
Consider an arbitrary steady state harmonic sound field in $\vx \in \mathbb{R}^2 / \mathbb{R}^3$ written in a general polar form with $A(\vx,\omega)$, $\phi(\vx,\omega) \in \mathbb{R}$
\begin{equation}
P(\vx,\omega) = A^P(\vx,\omega)\te^{\ti \phi^P(\vx,\omega)},
\label{eq:25D_WFS:general_sf}
\end{equation}
%
with a suppressed temporal dependency $\te^{\ti \omega t}$.
The dynamics of wave propagation is described by the phase of the sound field, playing a central role in the present local investigations.
Borrowed from ray-tracing/geometrical optics theory we introduce the following quantities \cite{Romer2005,Carozzi2004}:
%
\begin{equation}
\vk^P(\vx) = [k_x^P(\vx),\ k_y^P(\vx),\ k_z^P(\vx)]^{\mathrm{T}} = -\nabla \phi^P(\vx,\omega),
\end{equation}
%
\begin{equation}
k^P(\vx) =  \frac{1}{c} \frac{\partial}{\partial t} \phase{P(\vx,\omega)}  = \frac{1}{c} \left( \omega + \frac{\partial}{\partial t} \phi^P(\vx,\omega) \right),
\end{equation}
%
termed as the \emph{local wavenumber vector} and the \emph{instantaneous local wavenumber} of sound field $P$, respectively, with $ \frac{\partial}{\partial t} \phase{P(\vx,\omega)}$ being the \emph{instantaneous local angular frequency}, where $\phase{f}$ denotes the phase of $f$.
In the followings the existence of the superscript distinguishes local properties from the global ones (e.g. wavenumber components of spectral decomposition).
The wavenumber vector, defined as the negative gradient of the phase function points in the direction of maximal phase advance, i.e.\ it is perpendicular to the wave front in an arbitrary position.
For an isotropic media, where the propagation speed is constant, the phase velocity the and group velocity coincide, and the wavenumber vector points in the direction of the wave's energy flow, i.e.\ in the local wave propagation direction \footnote{This statement holds exclusively for isotropic media.
Although the wavenumber vector is always perpendicular to the wavefront, in anisotropic media the energy of a wave not necessarily travels along the path as the wavefront normals\cite{Pollard1977}.}.
For stationary steady state sound fields the wavenumber vector does not depend on time and the instantaneous wavenumber is constant, given by 
\begin{equation}
k^2 = \left( \frac{\omega}{c} \right)^2 = |\vk^P(\vx)|^2 = k^P_x(\vx)^2 + k^P_y(\vx)^2 + k^P_z(\vx)^2,
\end{equation}
thus the simple \emph{local dispersion relation } holds.
Obviously, for 2D sound fields $k^P_z(\vx)=0$.
In the current chapter, dealing exclusively with stationary virtual sound fields these assumptions hold.

\begin{figure}[h!]
	\small
	\centering
	\begin{overpic}[width = .9\columnwidth]{Figures/WFS_theory/wavenumber_vector.png}
	\put(0,30){a)}
	\put(50,30){b)}
	\put(0,0){c)}
	\put(50,0){d)}
	\end{overpic}
	\caption{Illustration of the local wavenumber vector for a 2D acoustic point source (a,c) and a 2D plane wave (b,d).
(a-b) show an arbitrarily chosen contour of constant phase, along with the wavenumber vector on this contour.
(c-d) show the local normalized $\hat{k}_x(x,y_0)$ component along the line $y_0 = 0.5 ~\mathrm{m}$.
These latter components are termed as the \emph{Lagrange submanifolds} in the field of ray-tracing \cite{Tracy2014}, forming one component of the wavenumber vector distribution, termed the \emph{Lagrange manifold}.}
	\label{Fig:Theory:general_sfs_geometry}
\end{figure}

Finally, one may define the \emph{normalized wavenumber vector} as
\begin{equation}
\vhk^P(\vx) = \frac{\vk^P(\vx)}{|\vk^P(\vx)|} = \frac{\vk^P(\vx)}{k^P(\vx)} = \frac{\vk^P(\vx)}{\omega/c},
\end{equation}
being a vector of unit length, pointing in the local propagation direction of the sound field\footnote{The normalized phase change of wave fields, here termed as normalized wavenumber vector, is a massively used concept in short wavelength wave theory, dealing with asymptotic/local approximate solutions of the wave equation.
In the field of ray tracing, expression $\Gamma(\vx) = \frac{\phi(\vx,\omega)}{k}$ is termed as the \emph{eikonal}, whose gradient defines the local propagation direction of the wave field: $\nabla \Gamma(\vx) = \vhk(\vx)$.
Substituting \eqref{eq:25D_WFS:general_sf} into the Helmholtz equation in terms of the eikonal and applying high-frequency assumptions leads to the \emph{eikonal equation}, forming the basis of ray acoustic theory \cite{Kinsler2000}.
In the field of high-frequency geometrical optics the representation of wave fields in $\vx, \vk(\vx)$ is termed the phase space representation \cite{Arnold1995}.
Over the last decades also the phase space representation of acoustic fields has gained an increasing interest\cite{Steinberg1993, Teyssandier2005}.}.

For the interpretation of the local wavenumber one should express the first order Taylor-expansion of the phase function around an arbitrary point $\vxo$ in the space
\begin{equation}
\phi^P(\vx,\omega) \approx \phi^P(\vxo,\omega) + (\vx-\vxo) \nabla \phi^P(\vx,\omega).
\end{equation}
By substitution into \eqref{eq:25D_WFS:general_sf}, with a slowly varying amplitude function---i.e. $A^P(\vx)$ is approximated by the first order Taylor expansion coefficient---in the proximity of $\vxo$ the sound field is approximated as
\begin{equation}
\label{Eq:25D_WFS:plane_wave_approximation}
P(\vx,\omega) \approx A^P(\vxo,\omega) \te^{\ti ( \phi_0^P(\vxo,\omega) - \vk(\vx)^{\mathrm{T}} \vx )},
\end{equation}
with $\phi_0^P(\vxo,\omega) = \phi^P(\vxo,\omega) + \vk^P(\vx)^{\mathrm{T}} \vxo $.
Therefore each point of an arbitrary sound field is approximated as a local elementary plane wave, with the wavenumber and angular frequency given by $\vk^P(\vx)$ and $\omega$ respectively.

\subsubsection{High-frequency gradient approximation}
%Applying the local wavenumber concept the 2D/3D WFS theory may be further simplified.
%In the previous section it was verified, that the high-frequency WFS driving function is (-2) times the normal component of the target field gradient measured on the %SSD, as given by equation \eqref{eq:theory:gen_WFS}.
%In case of a planar SSD this driving function ensures perfect reconstruction of the virtual field.

%Determination of the driving functions often requires the gradient of an arbitrary sound field.
In the high-frequency domain the gradient of an arbitrary sound field---required by the Rayleigh integral---may be expressed in a simplified form in terms of the local wavenumber vector.
By applying the product rule of differentiation, the gradient of an arbitrary sound field, described by \eqref{eq:25D_WFS:general_sf} reads
\begin{equation}
\nabla P(\vx,\omega) = \left(  \frac{\nabla A^P(\vx,\omega)}{A^P(\vx,\omega)} + \ti \nabla \phi^P(\vx,\omega) \right) P(\vx,\omega) =  \left(  \frac{\nabla A^P(\vx,\omega)}{A^P(\vx,\omega)} - \ti \vk^P(\vx) \right) P(\vx,\omega).
\end{equation}
A standard pre-assumption for the general WFS theory is that in the frequency domain of interest the target sound field's phase function varies rapidly compared to the envelope of the oscillation, which must hold both to apply the Kichhoff approximation and the stationary phase approximation in the followings.
In the high frequency region $|\vk^P(\vx)| = k \gg \left| \frac{ \nabla A^P(\vx,\omega)}{A^P(\vx,\omega)} \right|$ holds, thus the gradient is approximated as
\begin{equation}
\nabla P(\vx,\omega) \approx - \ti \vk^P(\vx) P(\vx,\omega).
\label{eq:25D_WFS:gradient_appr}
\end{equation}
Note, that it is a further local plane wave approximation of arbitrary sound fields, expressing the gradient of the local plane wave representation \eqref{Eq:25D_WFS:plane_wave_approximation}.
The expression holds therefore for an arbitrary plane wave with equality, and approximates a point-like source in its far-field, where the amplitude does not change rapidly.

\subsubsection{The local wavefront curvature}


\subsection{Fourier transform SPA interpretation}
Clearly, there is a strong relationship between the local wavenumber vector concept and the plane wave decomposition/angular spectrum of sound fields.
The relation is established by the SPA.
Consider the forward and inverse Fourier transform of a general polar form sound field $P(\vx,\omega)$ given by \eqref{eq:25D_WFS:general_sf}
\begin{equation}
\tilde{P}(k_x,y,k_z,\omega) = \iint_{-\infty}^{\infty} A^P(\vx,\omega)\te^{\ti \phi^P(\vx,\omega)} \te^{\ti k_x x} \te^{\ti k_z z} \td x \td z,
\label{eq:forward_transform}
\end{equation}
\begin{equation}
P(x,y,z,\omega) = \frac{1}{(2\pi)^2} \iint_{-\infty}^{\infty} \tilde{A}^{\tilde{P}}(k_x,y,k_z,\omega)\te^{\ti \tilde{\phi}^{\tilde{P}}(k_x,y,k_z,\omega)}  \te^{-\ti k_x x} \te^{-\ti k_z z} \td k_x \td k_z,
\label{eq:inverse_transform}
\end{equation}
with $\tilde{P}(k_x,y,k_z,\omega) =\tilde{A}^{\tilde{P}}(k_x,y,k_z,\omega)\te^{\ti \tilde{\phi}^{\tilde{P}}(k_x,y,k_z,\omega)}$.

\begin{figure}[h!]
	\small
	\centering
	\begin{overpic}[width = .95\columnwidth]{Figures/WFS_theory/stationary_points_in_kx.png}
%	\put(0,30){a)}
%	\put(50,30){b)}
%	\put(0,0){c)}
%	\put(50,0){d)}
	\end{overpic}
	\caption{Illustration of the stationary phase approximation of the Fourier transform in case of a 3D point source at $\vxs = \posvec{3}{0}{0}{0}$ with its one-dimensional Fourier-transform evaluated along $y = 0.5 ~ \mathrm{m}$. 
Due to the spherical symmetry in the plane of investigation the wavenumber vector, shown in Figure (b) equals to that of a 2D point source, presented in Figure \ref{Fig:Theory:general_sfs_geometry}. 
Figure (a) presents a spectral basis function (i.e. a plane wave) at $k_x = 0.5 k$. 
For this spectral component the stationary phase point at the field of the point source is found, where the local propagation direction of the point source coincides with that of the plane wave---indicated by white arrow---.
The spectrum, shown in Figure (d), therefore will be dominated by this part of space at $k_x = 0.5k$. 
In (c) and (d) corresponding symbols denote further stationary point pair examples in the spectral components and the local waveunumber components. 
It is noted here, that in this case, for a given wavenumber component the corresponding stationary position can be found explicitly, and the SPA of the Fourier transform can be evaluated analytically. 
The result is given by the well-known large argument/asymptotic approximation of the Hankel function \cite[p. 118]{Williams1999} (hence the terminology).}
	\label{Fig:Theory:stat_pos_in_kx}
\end{figure}

Supposing, that the sound field fulfills the SPA requirements---i.e.\ high frequency assumptions---the forward transform \eqref{eq:forward_transform}
may be evaluated asymptotically applying the stationary phase method \cite{Arnold1995, Tinkelman2005}.
The stationary point is found for a given $k_x$, where the gradient of the exponent is zero, thus where
\begin{align}
\frac{\partial}{\partial x} \phi^P(\vx,\omega) + k_x &= 0 \hspace{3mm} \rightarrow \hspace{3mm} k_x^P(\vx) = k_x, \\
\frac{\partial}{\partial z} \phi^P(\vx,\omega) + k_z &= 0 \hspace{3mm} \rightarrow \hspace{3mm} k_z^P(\vx) = k_z
\end{align}
holds.
This finding states, that each point in the plane wave spectrum of a sound field is dominated by the parts of the space, where the local wavenumber vector coincides with the corresponding plane wave wavenumber.
The local wavenumber components therefore may be interpreted as the stationary points of \eqref{eq:forward_transform} as a function of space \footnote{For a stationary phase approximation of the forward and inverse Fourier-transforms see \cite[Eq.\ 5.20, 5.51]{Tracy2014}}.

The counterpart of this statement is that the greatest contribution to the inverse transform \eqref{eq:inverse_transform} is associated to those plane waves---the stationary phase of the inverse integral for given $\vx$---, whose wave number vector coincide with the local wavenumber components at $\vx$.

The interpretation of Fourier transform asymptotic approximation is illustrated in Figure \ref{Fig:Theory:stat_pos_in_kx}.

Note, that here it is assumed, that in the region of investigation (an infinite plane or line, depending on the transform dimensionality) the stationary phase position and thus each propagation direction is unique.
This trivially does not hold for the case of e.g. a plane wave, or complex acoustic fields.
The SPA however can be extended for multiple stationary positions, and the result of the approximation is obtained by summing the SPA contributions over the stationary positions \cite[p. 129]{Bleistein2000}.
In the present treatise this limitation is not investigated further, since the results involving the SPA of the Fourier transform hold without any modification for a virtual plane wave as a limiting case.

\paragraph{Point source example:\\}
As a simple example consider the 1D Fourier transform of a 3D point source, for the sake of simplicity located at the origin. 
The transform is taken along the $x$-axis at an arbitrary $\posvec{3}{x}{y}{0}$.
The exact solution for the problem is available analytically, given by the second order Hankel function.
\begin{equation}
\tilde{P}(k_x,y,0,\omega) = \frac{1}{4\pi} \int_{-\infty}^{\infty} \frac{\te^{-\ti k \sqrt{x^2 + y^2}}}{\sqrt{x^2 + y^2}} \te^{\ti k_x x} \td x = 
-\frac{\ti}{4} H_0^{(2)}\left( \sqrt{k^2- k_x^2} |y| \right).
\end{equation}
By definition, for an arbitrary spectral wavenumber $k_x$ the stationary position is found, where the $x$-derivative of the phase function vanishes i.e. $x^*(k_x)$ satisfies
\begin{equation}
k \frac{x^*(k_x)}{\sqrt{x^*(k_x)^2 + y^2}} = k_x 
\hspace{1cm} \rightarrow \hspace{1cm} 
x^*(k_x) = y \frac{k_x}{\sqrt{k^2 - k_x^2}}.
\end{equation}
For the geometric interpretation of the stationary point refer to Figure \ref{Fig:Theory:stat_pos_in_kx}.
At the stationary point the phase of the integrand its second derivative reads
\begin{align}
\phi^{G_{3\mathrm{D}}}(\vx^*(k_x)) &=  -k \sqrt{x^*(k_x)^2 + y^2} + k_x x^*(k_x) = -|y| \sqrt{k^2 - k_x^2},\\
\phi^{''G_{3\mathrm{D}}}_{xx}(\vx^*(k_x)) &=  -k \frac{y^2}{\sqrt{ x^*(k_x)^2 +y^2 }^3} = - \frac{\sqrt{k^2-k_x^2}^3}{k^2 |y|}.
\end{align}
Substitution into the SPA \eqref{Eq:SPAResult} with $\sqrt{x^*(k_x)^2 + y^2} = |y|\frac{k}{\sqrt{k^2 - k_x^2}}$ and taking the negative sign of the second derivative into account yields the asymptotic form of the 3D point source spectrum, i.e. of the Hankel function
\begin{equation}
\tilde{P}(k_x,y,0,\omega) = -\frac{\ti}{4} H_0^{(2)}\left( \sqrt{k^2- k_x^2} |y| \right) \approx \frac{1}{\sqrt{8\pi \ti}} \frac{\te ^{-\ti |y| \sqrt{k^2 - k_x^2}}}{\sqrt{|y|\sqrt{k^2-k_x^2}}}
\label{Eq:25D_WFS:3D_Greens_asymp_spectrum}
\end{equation}

\subsection{Rayleigh integral SPA interpretation}

When the SPA is applied for the Rayleigh integral an expressive physical interpretation can be given for the solution of the stationary position.
Since in the frequency domain of interest the Green's functions in the 2D and 3D Rayleigh integrals are rapidly oscillating functions, therefore the pre-requisitions for the application of the SPA hold.
As given in the previous chapters the general 3D Rayleigh integral, describing also the synthesized field at $\vx$ using an infinite planar SSD located at 
$\vxo = \posvec{3}{x_0}{0}{z_0}$ reads
\begin{equation}
P(\vx,\omega) = \iint_{-\infty}^{\infty} - 2 \underbrace{ \left. \frac{\partial}{\partial y} P(\vxo,\omega) \right|_{y = 0}}_{ \approx -\ti k_y^P(\vxo) P(\vxo,\omega)}
 G(\vx-\vxo,\omega) \td z_0 \td x_0.
\end{equation}

Approximating the gradient of the target field by its high-frequency/local plane wave approximation, given by equation \eqref{eq:25D_WFS:gradient_appr} reveals, that the phase of the target field gradient at the SSD differs from the pressure field only in a constant phase shift.
By definition \eqref{Eq:ndim_stat_point}, the stationary point $\vxo^*$ is therefore given by
\begin{multline}
\nabla_{x_0,z_0} \left.
\left( \phase{ \ti P(\vxo,\omega)} + \phase{ G(\vx-\vxo,\omega)} \right) \right|_{\vxo^*} =
\\
\nabla_{x_0,z_0} \left.
\left( \frac{\pi}{2}+ \phi^P(\vxo,\omega) + \phi^G(\vx-\vxo,\omega) \right) \right|_{\vxo^*} = 0
\end{multline}
holds.
The gradient of the constant phase shift vanishes and the $x_0$ and $z_0$ derivatives of the target field and the Green's function phase can be recognized as the $k_x$ and $k_z$ component of the corresponding local wavenumber vectors.
For the stationary position therefore the following equations hold
\begin{align}
\begin{split}
-k_{x}^P(\vxo^*) &= k_{x}^G(\vxo^* - \vx), \\
-k_{z}^P(\vxo^*) &= k_{z}^G(\vxo^* - \vx),
\end{split}
\end{align}
with $k_{x/z}^{P}$ and $k_{x/z}^{G}$ denoting the wavenumber components of $P(\vxo)$ and $G(\vxo|\vx)$ respectively.
Note, that here the reciprocity of the Green's function was exploited.
%
\begin{figure}
	\centering
	\begin{minipage}{0.45\columnwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/WFS_theory/stationary_point_rayleigh.png}
	\scriptsize
	\put(57,92){$\vx$}
	\put(38,35){stationary position}		
	\end{overpic}
	\end{minipage}
	%
	\hspace{15mm}
	\begin{minipage}{0.4\columnwidth}
	\vspace{-5mm}
	\begin{overpic}[width = 1\columnwidth ]{Figures/WFS_theory/stationary_phase_b.png}
	\scriptsize
	\put(70, 68){$x$}
	\put(7,  99){$y$}
	\put(27, 68){$x_0^*$}	
	\put(40, 93){$\vx$}
	\put(33, 76){$\vk^P(\vxo^*)$}
	\put(25, 62){$\vk^G(\vxo^* - \vx)$}
	%
	\put(70, 12){$x$}
	\put(7,  43){$y$}
	\put(27, 12){$x_0^*$}	
	\put(40, 37){$\vx$}
	\put(33, 20){$\vk^P(\vxo^*)$}
	\end{overpic}
	\end{minipage}
	\caption{Illustration of the Rayleigh integral stationary phase approximation.
Analytically, the stationary phase position is found, where the phase of the integrand has a stationary point, i.e.\ where its gradient is zero (b).
In the aspect of the Rayleigh integral the stationary position can be interpreted as the point, where the local wavenumber vector of the Green's function positioned at the receiver position $G(\vxo|\vx)$ equals (-1) times the local wavenumber vector of the virtual field measured on the SSD (a)-(c).
By placing back the point source into the SSD the wavefront of the actual SSD element at $\vxo^*$ and the virtual field coincide at $\vx$.}
	\label{Fig:Theory:stationary_position}
\end{figure}
Along with the \emph{local dispersion relation} \cite{Tracy2014} $\left( \frac{\omega}{c} \right)^2 = k_x^P(\vx)^2+k_y^P(\vx)^2+k_z^P(\vx)^2$ at a fixed angular frequency two components completely determine the wavenumber vector, therefore the stationary position on the SSD for a given receiver position $\vx$ satisfies
\begin{equation}
\vk^P(\vxo^*) = - \vk^G(\vxo^* - \vx).
\label{Eq:25D_WFS:Ralyeigh_stat_point}
\end{equation}
Obviously, the same derivation holds for the 2 dimensional case by applying the 1D SPA, where the stationary position is found, where the $k_x$ components of the target and secondary source field's are equal.

Hence, the SPA compares the propagation direction/wave fronts of the virtual field and the Green’s function (placed at the receiver position $\vx$) along the SSD.
The stationary position is then found, where these two directions coincide.
See Figure \ref{Fig:Theory:stationary_position} (a,c) for an illustration, with the example of a virtual point source.
Obviously, at the stationary position $\vxo^*$, $\vk^P(\vxo^*)$ coincides with $-\vk^G(\vxo^* - \vx )$ both in magnitude and direction.
This result is of primary importance herein.
It states, \emph{that for each receiver position $\vx$, the synthesized sound field is mostly influenced by that SSD element $\vxo^*$, from which the emerging spherical wave fronts locally coincide with the target sound field’s wave fronts, or with other words the propagation direction of a SSD element and the virtual sound field coincide.}\footnote{Since the general SPA equation \eqref{Eq:SPAintegral_1d_nd} holds for an arbitrary surface geometry the same conclusion can be drawn from finding the stationary position in the general Kirchhoff approximation integral with the driving function given by \eqref{eq:theory:gen_WFS} by comparing the local wavenumber components specified by the actual SSD geometry.}

The counterpart of this statement declares that \emph{every point $\vxo$ on the SSD highly dominates the total synthesized sound field along a straight line, pointing from $\vxo$ towards the direction of the wave number vector $\vk^P(\vxo)$ of the target sound field.}
%For the case of a virtual spherical/cylindrical wave, this point is found in the intersection of the vector x 􀀀 xs and the SSD, as seen in Figure 2 (a).
% This is a well-known result in WFS theory
%


\paragraph{Cylindrical wavefront example: \\}
As a simple 2D example the stationary position for the synthesis of a cylindrical wave field is discussed.
The cylindrical wave, emitted by a 2D point source describing both the virtual field and the field of the SSD elements is given by the Hankel function.
Applying the large-argument/asymptotic form \cite{Williams1999} the phase of the 2D Green's function can be extracted as
\begin{equation}
\phi^{G_{2\mathrm{D}}}(\vx|\vxo) = k |\vx - \vxo|.
\end{equation}
Expressing the $x$-component of the wavenumber vector of the involved sound fields the stationary point for the 2D Rayleigh integral is found, where
\begin{equation}
k_{x}^P(\vxo^*) = k \frac{\vxo^*-\vxs}{|\vxo^*-\vxs|} = - k \frac{\vx-\vxo^*}{|\vx-\vxo^*|} = - k_{x}^{G_{2\mathrm{D}}}( \vx - \vxo^* )
\end{equation}
holds.
The equation is satisfied in the intersection of the vector $ \vx - \vxs $ and the SSD, as seen in Figure \ref{Fig:Theory:Spherical_and_Plane_Wave_stationary_point} (a).
This is a well-known result in traditional WFS theory \cite{Start1997:phd,Verheijen1997:phd}.
%
\begin{figure}
	\centering
\begin{overpic}[width = 0.45\columnwidth ]{Figures/WFS_theory/Spherical_wave_Stationary_point.png}
	\scriptsize
	\put(-5,2){(a)}
	\put(99, 19){$x_0$}
	\put(16, 69){$y$}
	\put(7, 46){$y$}
	\put(66, 19){$x$}
	\put(40, 19){$x_0^*$}
	\put(16, 4.5){$\vxs$}
	\put(70, 45.5){$\vx$}
	\begin{turn}{37}
	\put(60,-3.5){$\vx - \vxo$}
	\put(25,-2){$\vxo - \vxs$}
	\end{turn}
	\end{overpic}		
	\hspace{10mm}
	%%	
	\begin{overpic}[width = 0.45\columnwidth ]{Figures/WFS_theory/plane_wave_stationary_point.png}
	\scriptsize
	\put(-5,2){(b)}
	\put(69.5,52){$\mathbf{k}_\text{pw}$}
	\put(100,19){$x_0$}
	\put(18, 69){$y$}
	\put(12, 48){$y$}
	\put(65, 19){$x$}
	\put(68, 44.5){$\vx$}
	\put(23, 19){$x_0^*$}
	\put(33, 24.5){$\varphi_\text{PW}$}
	\begin{turn}{30}
	\put(47,13){$\vx - \vxo$}
	\end{turn}
	\end{overpic}
\caption{Geometry for finding the stationary point for a) a virtual cylindrical wave and b) a virtual plane wave.}
	\label{Fig:Theory:Spherical_and_Plane_Wave_stationary_point}
\end{figure}

\paragraph{Planar wavefront example: \\}
The principle is further demonstrated via the example of a plane wave synthesis.
Let's assume a virtual 2D plane wave field with propagating direction $\mathbf{k}_\text{pw}=[k_x,k_y,k_z]^{\mathrm{T}}=k\,[\cosfi_\text{PW},\sinfi_\text{PW},0]^{\mathrm{T}}$.
Comparison of the $k_x$ component of the plane wave and the cylindrical SSD elements yields the stationary position $x_0^*$, satisfying
\begin{equation}
\label{Eq:Phix0_PlaneWaveExample}
- k \cosfi_\text{PW} = -k \frac{x-x_0^*}{|\vx - \vxo^*|}.
\end{equation}
By observing the geometry in Figure \ref{Fig:Theory:Spherical_and_Plane_Wave_stationary_point} (b) it is obvious, that the equation is satisfied, where $\vx-\vxo^*$ coincides with the propagation direction $\mathbf{k}_\text{pw}$ of the plane wave.


\section{Unified 2.5D WFS theory}
\label{Sec:Unified_WFS}

This section provides a unified WFS framework applying the SPA to the 3D Rayleigh integral, in order to reduce the planar single layer potential into a linear one, containing the linear SSD driving function implicitly.
Based on its physical interpretation a further horizontal SPA is applied in order to ensure amplitude correct synthesis on an arbitrary control curve---instead of a control point---, termed the \emph{reference curve} with its shaped controlled by the properly chosen \emph{referencing function}.
Finally it is verified, that the presented driving functions can be applied without modification to a arbitrary smooth, curved SSD based on the Kirchhoff-approximation.

\subsection{Unified 2.5D driving functions}
Suppose a sound field, synthesized by a planar SSD located at $\vxo = [x_0,\ 0,\ z_0]^{\mathrm{T}}$, applying the planar WFS driving functions given implicitly by the \emph{3D Neumann Rayleigh integral}:
\begin{equation}
P(\vx,\omega) = \iint_{-\infty}^{\infty} 
\underbrace{ -2 \left. \frac{\partial}{\partial y} P(\vx, \omega) \right|_{\vx = \vxo}}_{ D_{3\mathrm{D}}(\vxo, \omega) \, \approx \, 2 \ti k_y P(\vxo,\omega) }
G(\vx-\vxo, \omega) \td z_0 \td x_0.
\label{eq:25D_WFS:3D_neumann} 
\end{equation}
Due to the orthogonal integral variables the 3D Rayleigh integral could be evaluated by two consequent SPAs along the vertical and horizontal dimension around the stationary point, with its physical interpretation given in the previous section.
In order to reduce the problem dimensionality the SPA is applied to evaluate the integral vertically, along the $z_0$-dimension resulting in driving functions for a horizontal linear SSD.

\subsubsection{Virtual source models}
Based on the foregoing for a fixed $x_0$ position, the vertical stationary point is found at $z_0^*$, where 
\begin{equation}
k_z^P(x_0,0,z_0^*) + k_z^{G}(x - x_0,0,z-z_0^*) =0
\label{eq:vertical_stat_pos}
\end{equation}
holds.
Obviously, virtual field dependent vertical SSD position (i.e. variation in the vertical stationary position) is not feasible in practical applications. 
In the followings we restrict our investigation to the horizontal plane $z=0$, termed the \emph{synthesis plane}, including both the receiver positions, and the linear SSD. 
The vertical stationary position is supposed to be at $z_0^*=0$, and $\vx = [x,\ y,\ 0]^{\mathrm{T}}$ denotes in-plane positions.
These requirements a-priori determine the synthesized field's propagation direction as for each SSD element $k_z^{G}(x - x_0,0,0) \equiv 0$ must hold.
Substitution into \eqref{eq:vertical_stat_pos} reveals, that the virtual source models are restricted to those, that propagate parallel to the synthesis plane at $z=0$, they must satisfy
\begin{equation}
-\left. \frac{\partial}{\partial z} \phi^P(x,0,z)\right|_{z = 0} = k_z^P(x,y,0) \equiv 0.
\label{eq:25D_WFS:virtu_field_cons}
\end{equation}
This is satisfied by an arbitrary 2D sound field invariant along the vertical dimension and ensembles of 3D point sources located at the synthesis plane.
Note, that these restrictions on the virtual source model are equivalent, with the considerations, given for linear SDM in section \ref{Sec:SFS_theory:linear_SDM}.

For didactic reasons the investigation begins with the case of a height-invariant 2D virtual field, which is later extended for 3D virtual fields.
Such a SPA scenario with the SPA integration path and the vertical stationary position is illustrated by Figure \ref{Fig:WFS_Theory:25D_Rayleigh}.
%
\begin{figure}
	\centering
	\begin{overpic}[width = 0.6\columnwidth ]{Figures/WFS_theory/25D_Rayleigh_geometry.png}
	\scriptsize
	\put(74, 54){$x$}	
	\put(88, 35){$y$}	
	\put(47, 74){$z$}
	\put(80, 45){$\vx$}
	\put(53, 43){$\vxo^*$}
	\put(45, 24){synthesis plane}
	\put(58, 61){SPA integral path}
	\put(-1, 62){\parbox{.5in}{2D virtual source}}
	\end{overpic}
\caption{Geometry for derivation of the 2.5D Neumann Rayleigh integral in case of a general 2D virtual sound field.}
	\label{Fig:WFS_Theory:25D_Rayleigh}
\end{figure}
%

\subsubsection{The 2.5D Rayleigh integral for 2D wave fields}
Consider a purely 2 dimensional virtual wave field, independent from the $z_0$ coordinate.
In this case the 3D Rayleigh integral can be rearranged as
\begin{equation}
P_{2\mathrm{D}}(\vx,\omega) = \int_{-\infty}^{\infty} 
-2 \left. \frac{\partial}{\partial y} P_{2\mathrm{D}}(\vx, \omega) \right|_{\vx = \vxo}
\underbrace{\int_{-\infty}^{\infty}  G(\vx-\vxo, \omega) \td z_0 }_{G_{2\mathrm{D}}(\vx-\vxo, \omega)} \td x_0.
\label{eq:25D_WFS:2D_neumann} 
\end{equation}
Based on the considerations above with the receiver position fixed to $z=0$ the vertical stationary point lies at $z_0^* = 0$.
With the required second phase derivative reading
%\begin{equation}
$ \phi_{zz}^{G''}(\vx - \vxo,\omega) = -k \frac{1}{|\vx - \vxo|}$
%\end{equation} 
and accounting for its negative sign (holding for an arbitrary diverging field) the asymptotic approximation of \eqref{eq:25D_WFS:2D_neumann} at the synthesis plane yields the \emph{2.5D Neumann Rayleigh integral for 2D sound fields} 
\begin{equation}
P_{2\mathrm{D}}(\vx,\omega) \approx \int_{-\infty}^{\infty} -2
\left. \frac{\partial}{\partial y} P_{2\mathrm{D}}(\vx,\omega) \right|_{\vx = \vxo}
\sqrt{\frac{ 2\pi |\vx - \vxo|}{\ti k }}
G(\vx-\vxo, \omega) \td x_0,
\label{eq:25D_WFS:25D_neumann_2D} 
\end{equation}
with $\vx = \posvec{3}{x}{y}{0}$ and $\vxo = \posvec{3}{x_0}{0}{0}$.

\vspace{3mm}
The 2D Green's function therefore may be approximated in the high-frequency/far-field region in terms of the 3D Green's function, based on the asymptotic form of the Hankel function \cite[(10.2.6)]{Nist2010} 
\begin{equation}
G_{2\mathrm{D}}(\vx- \vxo,\omega) \approx \sqrt{\frac{ 2\pi |\vx - \vxo|}{\ti k }}
G(\vx-\vxo, \omega).
\label{eq:25D_WFS:2D_Greens_vs_3D} 
\end{equation}
Note, that this result can be directly obtained by substituting $k_x = 0$ to the asymptotic spectrum of the 3D Green's function, given by \eqref{Eq:25D_WFS:3D_Greens_asymp_spectrum}.
In the field of 2.5D WFS the discrepancy between the 2D and 3D Green's function, describing SSD elements is termed as \emph{secondary source dimensionality mismatch}, consisting of the following components:\footnote{The terminology refers to the fact, that based on the 2D Rayleigh integral a 2D wave field could be perfectly reconstructed by applying 2D point sources as SSD elements. Application of infinite line sources however is not feasible practically, instead 3D point sources are applied, leading to amplitude errors without compensation \cite{Spors2008:WFSrevisited}.}
\begin{itemize}
\item While a 3D point source has a flat frequency response, an infinite line source radiates with a frequency response of $\sim \sqrt{1/\omega}$. 
\item Due to the different spatial degrees of freedom in a 2D and 3D radiation problem a 2D wave field attenuates in a lower rate, with an attenuation factor of $\sim 1/\sqrt{|\vx-\vxo|}$, than a 3D point source field, attenuating according to $\sim 1/|\vx-\vxo|$.
\end{itemize}

The 2.5D Rayleigh integral implicitly contains the driving functions, given by
\begin{equation}
D_{2.5\mathrm{D}}(\vxo,\omega) =
\underbrace{\sqrt{\frac{2\pi}{\ti k}}}_{\substack{\text{SSD freq.}\\\text{compensation}}} 
\underbrace{\sqrt{ | \vx - \vxo|}}_{\substack{\text{SSD amp.}\\\text{compensation}}} 
\underbrace{ \left( -2 \right) \left. \frac{\partial}{\partial y} P_{\text{2D}}(\vx,\omega) \right|_{\vx = \vxo}}_{\substack{\text{2D driving}\\\text{function}}},
\label{Eq:2_5D_driv_fun_for_2D}
\end{equation}
where the secondary source compensation factors adjust the 3D point source characteristics to a 2D one.
Obviously, the amplitude of each SSD element can be corrected to a fixed receiver position (or to a fixed distance around from the actual source),
leading to receiver position dependent driving functions.
In order to obtain receiver point independent driving functions, in the related literature either $\vx$ is fixed to a designated reference point $\vx_{\text{ref}}$ \cite{Spors2008:WFSrevisited}, or the entire correction factor $|\vx-\vxo|$ is set to a constant value $\dref$ \cite{Ahrens2012}. 
In the followings it will be verified, that proper choice of the amplitude compensation factor as a function of $\vxo$ allows one to optimize the amplitude of the synthesis to an arbitrary \emph{reference curve}.

\subsubsection{The 2.5D Rayleigh integral for 3D wave fields}
For an arbitrary 3D sound field, satisfying \eqref{eq:25D_WFS:virtu_field_cons} the general 3D Rayleigh integral has to be evaluated along the vertical dimension around $z_0^* = 0$.
Application the SPA to the 3D Rayleigh integral---with assuming a diverging virtual sound field with a negative second phase derivative---results in a line integral representation of the synthesized field at the synthesis plane, termed the \emph{2.5D Neumann Rayleigh integral for 3D sound fields}
\begin{equation}
P(\vx,\omega) \approx \int_{-\infty}^{\infty} -2
\sqrt{\frac{2\pi}{\ti |\phi_{zz}^{P''}(\vxo, \omega) + \phi_{zz}^{G''}(\vx - \vxo,\omega)|}}
\left. \frac{\partial}{\partial y} P(\vx,\omega) \right|_{\vx = \vxo}
G(\vx-\vxo, \omega) \td x_0,
\label{eq:25D_WFS:25D_neumann_general} 
\end{equation}
with $\vxo = \posvec{3}{x_0}{0}{0}$ and $\vx = \posvec{3}{x}{y}{0}$.

The 2.5D Rayleigh integral implicitly contains the driving functions for a linear SSD, given by
\begin{equation}
D_{2.5\mathrm{D}}(\vxo,\omega) = -2
\sqrt{\frac{2\pi}{\ti |\phi_{zz}^{P''}(\vxo, \omega) + \phi_{zz}^{G''}(\vx - \vxo,\omega)|}}
\left. \frac{\partial}{\partial y} P(\vx,\omega) \right|_{\vx = \vxo}.
\label{eq:25D_WFS:25D_driv_fun_general} 
\end{equation}
Similarly to the 2D virtual field case, the driving function is still dependent on the receiver position, due to the secondary source compensation factor, described in the previous subsection.
Besides the secondary source dimensionality mismatch in this case also a \emph{virtual source dimensionality mismatch} is present which is taken into account by an additional virtual source compensation factor\footnote{Revisited WFS theory as given by Spors applied the 2.5D WFS driving functions \eqref{eq:25D_WFS:25D_neumann_2D} for an arbitrary virtual sound field. Neglecting the virtual source compensation factor therefore resulted in amplitude errors when the virtual field was a 3D one.}.

Obviously, the 3D to 2.5D Rayleigh integral is a generalization, with the 2D virtual field example being a special case with $\phi_{zz}^{P''}(\vxo, \omega) = \frac{\partial}{\partial z} k_{z}^P(\vx) \equiv 0$.

\vspace{3mm}
As a well-studied example consider the synthesis of a 3D point source, located behind the SSD at $\vxs = \posvec{3}{x_s}{y_s}{0}$.
Applying the high-frequency gradient approximation, substituting the explicit expressions for the Green's function second phase derivatives and after basic rearrangement the 2.5D WFS driving functions become
\begin{equation}
D(x_0,\omega) = 
\underbrace{\sqrt{\frac{2\pi}{\ti k}}}_{\substack{\text{SSD freq.}\\\text{compensation}}} 
\underbrace{\sqrt{ | \vx - \vxo|}}_{\substack{\text{SSD amp.}\\\text{compensation}}} 
\underbrace{\sqrt{\frac{| \vxo - \mathbf{x}_s |  }{| \vxo - \mathbf{x}_s | + | \vx - \vxo| }}  }_
{\substack{\text{Virt. source}\\\text{amp. comp.}}}
\underbrace{ \left. \left( -2\right) \frac{\partial P(\vx,\omega)}{\partial y}  \right|_{\vx = \vxo}}_{\text{2D driving function, HF approx.}}.
\label{Eq:2_5D_point_source_implicit_df_Explanations}
\end{equation}
Comparing this result with \eqref{Eq:2_5D_driv_fun_for_2D} it is revealed, that the virtual source mismatch can be compensated with the correction factor $\sqrt{\frac{| \vxo - \mathbf{x}_s |  }{| \vxo - \mathbf{x}_s | + | \vx - \vxo| }}$. 
%This result has an expressive geometrical meaning around the horizontal stationary position, since 2D WFS would assume a point source with an attenuation factor of $\frac{1}{\sqrt{r}}$. 
In the correction factor the numerator stands for the attenuation correction from the point source to the SSD, and the denominator for the correction from the point source to the listener position. 
%Alternatively: multiplication by $\sqrt{| \vxo - \mathbf{x}_s |}$ approximates the source strength at the source position, while correction with $\frac{1}{\sqrt{| \vxo - \mathbf{x}_s | + | \vx - \vxo| }}$ corrects the $1/\sqrt{r}$ attenuation to $1/r$.

\subsubsection{Introduction of the referencing function}

So far receiver position dependent driving functions have been found for a linear SSD.
In the followings we restrict the investigation to the synthesis plane.
Let's generalize the 2D and 3D 2.5D WFS driving functions towards
\begin{equation}
D(x_0,\omega) = 
- \sqrt{\frac{8\pi}{\ti k}} \sqrt{d(x_0)} \left. \frac{\partial P(\vx,\omega)}{\partial y}\right|_{\vx = \vxo},
\label{Eq:Gen_rayleigh_dx0}
\end{equation}
which is obviously a common generalization of \eqref{Eq:2_5D_driv_fun_for_2D} and \eqref{eq:25D_WFS:25D_neumann_general}.
The term $d(x_0)$ denotes the newly introduced \emph{referencing function}, whose general role in the synthesis is to optimize amplitude correct synthesis---i.e. to reference the synthesis---to a prescribed \emph{reference curve}.

The principle of referencing the synthesis stems from the physical interpretation of the horizontal SPA:
\emph{As each receiver point $\vx$ is mainly contributed by one individual SSD element $\vxo$, one may control the amplitude of the synthesized field along an arbitrary receiver curve $\vxref(\vxo)$ by controlling the amplitude of the corresponding stationary SSD element $\vxo$ through the referencing function.}

Based on the physical interpretation of the SPA  $\vxref(\vxo)$ is related to $\vxo$ trough the implicit relation 
\begin{equation}
\label{Eq:PCS_def}
\vk_P(\vxo) = \vk_G(\vxref(\vxo)-\vxo).
\end{equation}
Substituting the explicit expression for the Green's function's wavenumber vector and rearranging leads to  
\begin{align}
\label{Eq:xRefyRef_General}
\vx_{\mathrm{ref}}(x_0)= \vxo + \frac{\vk_P(\vxo)}{k} |\vx_{\mathrm{ref}}(\vxo) - \vxo|.
\end{align}
The equation is satisfied in radial directions from individual SSD elements along the direction of $\vk_P(\vxo)$.
As a general statement, the distance at which the individual SSD elements ensure amplitude correct synthesis is given by the amplitude factor of the secondary source dimensionality mismatch $|\vx(\vxo) - \vxo|$.
This distance is controlled by the referencing function.
%As a consequence---concluding the foregoing---, the \emph{positions of correct synthesis (PCS)} lie $|\vx(\vxo) - \vxo|$ away from position $\vxo$ in the direction of $\vk_P(\vxo)$, and their coordinates are thus given by %$\mathbf{x}_{\mathrm{ref}}(x_0)$:
%

\emph{The position of correct synthesis is therefore restricted to a parametric curve, with the free variable being the SSD position $x_0$, and the shape of the curve is given by the referencing function and the virtual source model trough $\vk(x_0)$.}
%Practically, the shape of the desired reference curve is prescribed.

In the followings it is presented, how the corresponding referencing function $d(x_0)$ may be derived for 2D and 3D virtual sound fields.

\vspace{3mm}
It is worth noting, that referencing is always performed by the proper control of the SSD correction factor: as a generalization the referencing approach may be involved to the general 2.5D driving function \eqref{eq:25D_WFS:25D_driv_fun_general} by introducing the here defined referencing curve:
\begin{equation}
D_{2.5\mathrm{D}}(x_0,\omega) = -2
\sqrt{\frac{2\pi}{\ti |\phi_{zz}^{P''}(\vxo, \omega) + \phi_{zz}^{G''}(\vxref(x_0) - \vxo,\omega)|}}
\left. \frac{\partial}{\partial y} P(\vx,\omega) \right|_{\vx = \vxo},
\label{Eq:25D_WFS:Referencing_25D_WFS_driv_fun}
\end{equation}
where $\phi_{zz}^{G''}(\vxref(x_0) - \vxo,\omega)$ is dependent only on $|\vxref(x_0) - \vxo|$ (by considering the explicit expression of the second derivative).
Solving \eqref{Eq:xRefyRef_General} for this reference curve-to-SSD distance and substituting back into \eqref{Eq:25D_WFS:Referencing_25D_WFS_driv_fun} leads to the very same results as given in the followings, independently from the virtual field dimensionality.
The introduction of the referencing function concept---although giving a problem dimensionality dependent referencing function---provides a more expressive interpretation of the referencing mechanism, as well as giving an easier to compare description with the existing approaches.


\subsection{Referencing 2D sound fields}

%Based on the integral representation \eqref{Eq:2D_Rayleigh} an arbitrary 2D sound field can be perfectly resynthesized with a linear set of ideal, vertical line sources. 
%Practically, one uses loudspeakers that rather radiate like 3D point sources. This results in a \emph{secondary source dimensional mismatch}. 
%One may overcome this by introducing the high-frequency/far field approximated 2D Green's function that includes the 3D Green's function and a dimensional correction factor \eqref{Eq:2.5D_Rayleigh}, \eqref{Eq:2_5D_driv_fun_implicit}. 
%Due to the different attenuation factors in the 3D and 2D Green's function, the approximation factor still contains the receiver position, at which the 2D Green's function approximately equals the corrected 3D Green's function. 
%This is known as referencing the SFS driving function w.r.t. a certain receiver position---a specific receiver curve. 

%Let's define a \emph{referencing function} $d(x_0)$ for each SSD element to generalize the WFS driving function \eqref{Eq:2_5D_driv_fun_implicit} towards


Comparing \eqref{Eq:2_5D_driv_fun_for_2D} and \eqref{Eq:Gen_rayleigh_dx0} reveals, that for a 2D virtual sound field the referencing function is given directly by the distance of the SSD and the corresponding stationary position along the reference curve
%
\begin{align}
d(x_0) = |\vxref(\vxo) -\vxo|.
\label{dx0_2DSources}
\end{align}
%
%In Sec. \ref{Sec:SPA} the link of the stationary point with the wave number vector of the virtual source $\vk(x_0) = [k_x(x_0),\ k_y(x_0)]^{\mathrm{T}}$ given on the SSD was introduced. 
and the points of correct synthesis are given by
%
\begin{align}
\label{Eq:xRefyRef_2D_General}
\mathbf{x}_{\mathrm{ref}}(x_0)=
\begin{bmatrix}
x_{\mathrm{ref}}(x_0)\\
y_{\mathrm{ref}}(x_0)
\end{bmatrix}
=
\begin{bmatrix}
x_0 + \frac{k_x(x_0)}{k} d(x_0)\\
\frac{k_y(x_0)}{k} d(x_0)
\end{bmatrix}.
%x_{\mathrm{ref}}(x_0)& = x_0 + \frac{k_x(x_0)}{k} d(x_0)\\
%y_{\mathrm{ref}}(x_0)& =\frac{k_y(x_0)}{k} d(x_0).
\end{align}

As simple examples for 2D virtual sound fields virtual plane waves and line sources are investigated.

\begin{figure}
	\centering
	\begin{overpic}[width = 0.4\columnwidth ]{Figures/WFS_theory/Plane_wave_Stationary_point_2.png}
	\scriptsize
	\put(-5,2){(a)}
	\put(100,19){$x$}
	\put(18, 69){$y$}
	\put(33,19){$\vxo$}
	%\put(74,42){$d(x_0)$}
	\put(12, 50){$y_{\mathrm{ref}}$}
	\put(82, 19){$x_{\mathrm{ref}}$}
	\put(84, 52){$\mathbf{x}_{\mathrm{ref}}$}
    \put(41.5, 25){$\varphi_\text{PW}$}
    \put(39, 33){$\vk(x_0)$}
    \put(47, 41){$k_x(x_0)$}
    \put(63, 30){$k_y(x_0)$}
	\end{overpic}
	\hspace{10mm}
	\begin{overpic}[width = 0.4\columnwidth ]{Figures/WFS_theory/Spherical_wave_Stationary_point_2.png}
    \scriptsize
	\put(-5,2){(b)}
	\put(99, 19){$x$}
	\put(16, 69){$y$}
	\put(8, 53){$y_{\mathrm{ref}}$}
	\put(82.5, 19){$x_{\mathrm{ref}}$}
    \put(38, 19){$\vxo$}
    \put(16, 4.5){$\vxs$}
	%\put(74,42){$d(x_0)$}
    \put(45.5, 25){$\varphi$}
    \put(43, 33){$\vk(x_0)$}
    \put(50, 43){$k_x(x_0)$}
    \put(66, 30){$k_y(x_0)$}
	\put(85, 55){$\mathbf{x}_{\mathrm{ref}}$}
    \put(27, 18){$r_0$}
	\end{overpic}	
\caption{Geometry for finding the positions of correct synthesis for a plane wave (a) and a line/point source (b)}
	\label{Fig:Theory:Position of correct synthesis}
\end{figure}

\subsubsection{For a virtual 2D plane wave} the wavenumber vector / propagation direction ($k_z=0$) is
\begin{equation}
\label{Eq:kx0_PW}
\vk_\mathrm{PW}(x_0) = \begin{bmatrix} k_x(x_0) \\[0.3em] k_y(x_0)\\[0.3em]    \end{bmatrix} =  k\begin{bmatrix} \cosfi_\text{PW} \\[0.3em] \sinfi_\text{PW} \\[0.3em]    \end{bmatrix}
\end{equation}

and with \eqref{Eq:kx0_PW} into \eqref{Eq:xRefyRef_2D_General} the positions of correct synthesis (PCS) are 
\begin{align}
\label{Eq:PCS_PW}
\mathbf{x}_{\mathrm{ref,PW}}(x_0)=
\begin{bmatrix}
x_0 + \cosfi_\text{PW} \, d(x_0)\\
\sinfi_\text{PW} \, d(x_0)
\end{bmatrix}
%x_{\mathrm{ref}}(x_0)& = x_0 + \cosfi_\text{PW} \, d(x_0) \\
%y_{\mathrm{ref}}(x_0)& = \sinfi_\text{PW} \, d(x_0).
\end{align}

\subsubsection{For a virtual line source} consider the source location at $\mathbf{x}_s = [ x_s,\ y_s ]^{\mathrm{T}}$ with $r_0 = | \vxo - \mathbf{x}_s |$. 
For the sake of convenience $y_s<0$ restricts the virtual source behind the SSD. 
For the derivative of the phase function the high-frequency/far-field approximation of the Hankel function \eqref{eq:25D_WFS:2D_Greens_vs_3D}  as the line source model is applied, yielding
%
\begin{equation} 
\label{Eq:kx0_LS}
\vk_\text{LS}(x_0)
%\begin{bmatrix} k_x(x_0) \\[0.3em] k_y(x_0)\\[0.3em]    \end{bmatrix}
%&=-\begin{bmatrix} 
%\left. \frac{\partial(\cdot)}{\partial x} \right|_{x = x_0} 
%\\[0.3em] 
%\left. \frac{\partial(\cdot)}{\partial y} \right|_{y = 0} 
%\\[0.3em]    \end{bmatrix} 
%\left(-k\,\sqrt{(x-x_s)^2 + (y-y_s)^2}\right) \nonumber\\
=k\begin{bmatrix} 
\frac{x_0- x_s}{r_0}
\\[0.3em] 
\frac{-y_s}{r_0}
\\[0.3em]    \end{bmatrix}.
\end{equation}
%
Inserting into \eqref{Eq:xRefyRef_2D_General} the PCS are
%
\begin{align}
\mathbf{x}_{\mathrm{ref,LS}}(x_0)=
\begin{bmatrix}
x_0 + \frac{x_0-x_s}{r_0} \, d(x_0) \\
\frac{-y_s}{r_0} \, d(x_0)
\end{bmatrix}.
%x_{\mathrm{ref}}(x_0)& = x_0 + \frac{x_0-x_s}{r_0} \, d(x_0) \\
%y_{\mathrm{ref}}(x_0)& = \frac{-y_s}{r_0} \, d(x_0).
\label{Eq:Line_source_correcty_synth}
\end{align}
For the same solution by geometric considerations see Figure \ref{Fig:Theory:Position of correct synthesis}.

%Now we are able to estimate the PCS of different parametric curves by varying $d(x_0)$.


\subsection{Referencing 3D sound fields}

For 3D referencing example the investigation is restricted exclusively to 3D point sources.

Also in the 3D case, the horizontal SPA holds, and due to the same phase functions in the plane of the synthesis the stationary point remains in the same position in the horizontal direction as for a line source.
%The different attenuation factor however yields that, the same referencing function results in amplitude error in a  distance $\dref$ measured from a stationary SSD element.
Again, the synthesis will be amplitude correct in a distance of $| \vx(\vxo) - \vxo |$ from the stationary SSD element, in a radial direction away from the virtual source. 
Refer to Figure \ref{Fig:Theory:Position of correct synthesis} (b) for the geometry. 

Also for a virtual 3D point source the driving functions can be written in the form of the general WFS driving function \eqref{Eq:Gen_rayleigh_dx0}.
Comparison with \eqref{Eq:2_5D_point_source_implicit_df_Explanations} reveals, that in this case the \emph{referencing function} $d(x_0)$ for each SSD element can be stated as
\begin{equation}
d(x_0) = \frac{ r_0 \cdot | \vxref(\vxo) - \vxo|  }{ r_0 + | \vxref(\vxo) - \vxo| }
\label{Eq:dx0_PointSource}
\end{equation}
using $r_0 = | \vxo - \mathbf{x}_s |$, therefore the distance of the PCS measured from the stationary SSD point is
%
\begin{equation}
|\vxref(\vxo) - \vxo| = d(x_0)\frac{r_0}{r_0 - d(x_0)}.
\label{Eq:dx0_PointSource_xx0}
\end{equation}
%
Comparing the referencing function \eqref{dx0_2DSources} for virtual 2D sound fields and \eqref{Eq:dx0_PointSource_xx0} for the virtual point source, the substitution
\begin{equation}
d(x_0) \rightarrow d(x_0)\frac{r_0}{r_0 - d(x_0)}
\label{Eq:dx0_mapping}
\end{equation}
allows for utilizing the parametric curve description \eqref{Eq:Line_source_correcty_synth} that was derived for the virtual line source. 
This yields the PCS
\begin{align}
\mathbf{x}_{\mathrm{ref,PS}}(x_0)=
\begin{bmatrix}
x_0 + (x_0-x_s) \frac{d(x_0)}{r_0 - d(x_0)}\\
-y_s \frac{d(x_0)}{r_0 - d(x_0)}
\end{bmatrix}.
\label{Eq:3D_curve}
\end{align}

In the following section it will be shown how the referencing function could be chosen in order to reference the synthesized field along a prescribed receiver curve. 
Furthermore, the analysis allows for the discussion of established referencing function's choices in traditional WFS theory.



\section{Application Examples}
\label{Sec:examples}

This section presents application examples for the unified WFS referencing approach via the synthesis of virtual plane waves, line and point sources.
As a simple referencing approach applied in revisited WFS \cite{Ahrens2012} the effects of choosing a constant referencing function are investigated.
As practical choices of the reference curve it is demonstrated how the referencing function should be chosen in order to reference the synthesis on a line, parallel with the SSD and on a circle around the virtual line/point source.

\subsection{Reference Schemes 2D Sound fields}

\begin{figure}
	\centering
	\begin{overpic}[width = .85\columnwidth ]{Figures/WFS_theory/fixed_referencing.png}
	\scriptsize
	\end{overpic}
\caption{Effects of a constant referencing function: The absolute value of the error measured between the synthesized sound field and the target sound field at $\omega = 2\pi\cdot 1.5~\mathrm{krad/s}$ for (a) a virtual plane wave with $\varphi_\text{PW} = 45^{\circ}$ and (b) a line source at $\mathbf{x}_s = [0,\ -1]^{\mathrm{T}}$ is shown. The referencing function is set to $\dref = 2~\mathrm{m}$. 
For the virtual plane wave the amplitude is thus referenced on a line at $y = \sinfi_\text{PW}\,\dref = 1.41~\mathrm{m}$. 
For a virtual line source the positions of amplitude correct synthesis is given by the curve\eqref{Eq:Line_source_correcty_synth} with $d(x_0) \rightarrow \dref$, denoted by white dashed line. 
In front of the virtual source the position of amplitude correct synthesis is located at $\dref$.}
	\label{Fig:Theory:fixed_referencing}
\end{figure}

\subsubsection[Referencing with constant dref]{Referencing with constant $\dref$}
With $d(x_0) = \dref$ the distance from the stationary SSD element becomes fixed. 
In this referencing scheme the PCS are given by \eqref{Eq:PCS_PW} and \eqref{Eq:Line_source_correcty_synth} with a fixed referencing function
for a plane wave and a line source, respectively. 
By that a plane wave will be referenced along a line that is parallel to the SSD at $y = \sinfi_\text{PW}\,\dref$, whereas the line source becomes synthesized with correct amplitude along a bell contour. 
There the maximum distance $\dref$ corresponds directly to the frontal position of the virtual line source. 
For an illustration see Figure \ref{Fig:Theory:fixed_referencing}.

\begin{figure}
	\centering
	\begin{overpic}[width = .85\columnwidth ]{Figures/WFS_theory/line_referencing.png}
	\scriptsize
	\end{overpic}
\caption{Effects of referencing on a line, parallel to the SSD: The absolute value of the error measured between the synthesized sound field and the target sound field for (a) a virtual plane wave with $\varphi_\text{PW} = 45^{\circ}$  and (b) line source at $\mathbf{x}_s = [0,\ -1]^{\mathrm{T}}$ is shown. 
The referencing function is set to $d_{pw,line}(x_0) = 2 / \sinfi_\text{PW} ~\mathrm{m}$ for the plane wave, and $d_{ls,line}(x_0) = 2 r_0/y_s ~\mathrm{m}$ for the line source, resulting in an amplitude correct synthesis at $\yref = 2~\mathrm{m}$.}
	\label{Fig:Theory:line_referencing}
\end{figure}

\subsubsection{Referencing along a parallel line}
With the appropriate choice of $d(x_0)$ in \eqref{Eq:xRefyRef_2D_General} it is possible to reference amplitude correct synthesis along an arbitrary curve. 
A feasible choice is to reference the synthesis to a line that is parallel to the SSD at $y=\yref>0$. 
This can be done, by setting the $y$-coordinate of the parametric curve to a constant value, by choosing the general referencing function, cf. \eqref{Eq:xRefyRef_2D_General}
\begin{align}
\label{Eq:General_line_Ref_fun}
d(x_0) = \frac{k}{k_y(x_0)}\,\yref.
\end{align}

The referencing functions are obtained via the substitution of the corresponding wavenumber component of a plane wave and a line source, given by \eqref{Eq:kx0_PW} and \eqref{Eq:kx0_LS} respectively.
By substituting back to the WFS driving function \eqref{Eq:Gen_rayleigh_dx0}, it is obtained, that the driving functions, that reference the synthesis of a plane wave and a cylindrical wave to a reference line is given by
\begin{equation}
\label{Eq:Plane_wave_ref_line}
D_\text{line,PW}(x_0,\omega) 
=\sqrt{8\pi\,\ti\,k_y\,\yref}\,\te^{-\ti k_x x_0 }
\end{equation}
and
\begin{equation}
D_\text{line,LS}(x_0,\omega) =- \sqrt{\frac{\ti\,k\,\pi\,\yref\,y_s}{2\,r_0}}  H_1^{(2)}( k r_0 )
\end{equation}
respectively. 
For the case of a virtual plane wave this is a well-known result, equivalent with the explicit SDM solution \cite[(29)]{Ahrens2010a}, \cite{Ahrens2012}.

It is mentioned here, that since plane waves give a full orthogonal basis for an arbitrary 2D sound field, therefore 
the driving function of an arbitrary 2D sound field may be constructed from the plane wave driving functions with appropriate referencing function, expressed in terms of $k_x$ and $k_y$.  As an example: the driving function referencing the synthesis on a reference line is obtained from the spatio-temporal spectrum/plane wave decomposition of the virtual sound field measured on the SSD utilizing \eqref{Eq:Plane_wave_ref_line}:
\begin{equation}
D(x_0,\omega) = \frac{1}{2\pi} \int\limits_{-\infty}^{\infty} \hat{P}(k_x,0,\omega) \,\sqrt{8\pi\,\ti\,k_y\,\yref} 
\,\te^{-\ti k_x x_0}\,
 \td k_x,
	\label{Eq:General_WFS_in_kx_domain}
\end{equation}
where $\hat{P}(k_x,0,\omega)$ is the wavenumber content / spatial Fourier transform of the target field measured on the SSD.

 One important fact should be pointed out. The explicit solution---termed as the \emph{Spectral Division Method}---finds the driving function as the ratio of the wavenumber content of the target sound field and the 3D Green's function measured on the reference line \cite{Ahrens2010a}. 
 If the target sound field is a 2D one, its wavenumber content on the SSD can be explicitly expressed, yielding the driving function
%
 \begin{equation}
D_{\mathrm{SDM}}(x_0,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \frac{ \hat{P}(k_x,0,\omega) \te^{-\ti k_y |\yref|}}{
-\frac{\ti}{4}H_0^{(2)}\left( k_y |\yref| \right) }
\te^{-\ti k_x x_0 }
 \td k_x.
\end{equation}
If the large-argument approximation of the Hankel function is used: $-\frac{\ti}{4}H_0^{(2)}\left( k_y |\yref| \right) \approx \te^{-\ti k_y |\yref|}/\sqrt{8\pi\ti k_y |\yref|}$ \cite{Williams1999}, valid in the far-field of the SSD, the exponentials cancel out, and one obtains the WFS driving functions, given by \eqref{Eq:General_WFS_in_kx_domain}. 
This remark indicates the fact, that WFS with a linear SSD and a linear reference curve is the general approximation of the explicit solution for the same setup.

Alternatively the corresponding formulation can be given purely in the spatial domain: with expressing the derivative in \eqref{Eq:Gen_rayleigh_dx0} by the introduced high-frequency approximation \eqref{Eq:y_derivative}, and substituting the general parallel line's referencing function \eqref{Eq:General_line_Ref_fun}
the driving function \eqref{Eq:Gen_rayleigh_dx0} becomes
\begin{equation}
D(x_0,\omega) = \sqrt{8\pi\,\ti\,k_y(x_0)\,\yref } P(x_0,0,\omega).
\end{equation} 
This formulation requires only the pressure and the $y$-derivative of the phase of the virtual sound field.

\begin{figure}
	\centering
	\begin{minipage}{0.4\columnwidth}
	\vspace{-5mm}
	\begin{overpic}[width = 1\columnwidth]{Figures/WFS_theory/circular_referencing.png}
	\scriptsize
	\put(100,17){$x$}
	\put(8,  49){$y$}
    \put(20, 30){$R_{\mathrm{ref}}$}
    \put(30, 10){$r_0$}
    \put(48, 24){$\dref$}
	\end{overpic}
	\end{minipage}
	\hspace{5mm}
	\begin{minipage}{0.5\columnwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/WFS_theory/circle_referencing.png}
	\scriptsize
	\end{overpic}
	\end{minipage}
\caption{Geometry for deriving the referencing function for a circle around the virtual line source (a) and the absolute value of the error (b) measured between the synthesized sound field and the target sound field for a line source at $\mathbf{x}_s = [0,\ -1]^{\mathrm{T}}$. The synthesis is referenced on a circle around the line source, with a radius of $R_{\mathrm{ref}} = y_s + 2 ~\mathrm{m}$.}
	\label{Fig:Theory:circular_referencing}
\end{figure}

\subsubsection{Referencing along a circle}
For a cylindrical virtual source it might be feasible in several applications to reference the synthesis on a circle around the center of the virtual source. 
The example is presented in order to demonstrate the validity of the presented referencing approach.

Referencing to a circle with a radius of $R_{\mathrm{ref}} > r_0$ may be done by observing the problem geometry in Figure \ref{Fig:Theory:circular_referencing}. 
In the stationary point $R_{\mathrm{ref}} = \dref + r_0$, thus
%
\begin{equation}
d_\text{circle,LS}(x_0) = R_{\mathrm{ref}} - r_0.
\label{Eq:dCircleLS}
\end{equation}
%
For the result of this type of referencing see Figure \ref{Fig:Theory:circular_referencing}.


\subsection{Reference schemes for 3D Point Source}

\begin{figure}[h!]
	\centering
	\begin{overpic}[width = .85\columnwidth ]{Figures/WFS_theory/point_source_referencing.png}
	\scriptsize
	\end{overpic}
\caption{Referencing the synthesis of a 3D point source with a constant referencing function (a), to a reference line (b) and to a circle around the virtual source (c). The virtual source is a point source located at $\mathbf{x}_s = [0,\ -3,\ 0]^\mathrm{T}$, oscillating at $\omega = 2\pi \cdot 1.5 ~\mathrm{rad/s}$. For the constant referencing $\dref = 1.5~\mathrm{m}$ is set. Note, that in front of the point source the amplitude correct synthesis is ensured at $\frac{y_s}{y_s/\dref - 1 } = 3~\mathrm{m}$. For the case of referencing to a line $\yref = 1.5~\mathrm{m}$, while for referencing to a circle $R_{\mathrm{ref}} = y_s + 1.5~\mathrm{m}$ was chosen.}
	\label{Fig:Theory:point_source_referencing}
\end{figure}

\subsubsection[Referencing with constant dref]{Referencing with constant $\dref$}

Similarly to the 2D case, by fixing the referencing function to a constant value the PCS are given by \eqref{Eq:3D_curve} with the substitution $d(x_0) = \dref$.
%\begin{equation}
%\mathbf{x}_{\mathrm{ref}}(x_0)  =  \begin{bmatrix} x_0 + (x_0-x_s)\frac{1}{\frac{r_0}{\dref} - 1 } \\[0.3em] -y_s \frac{1}{\frac{r_0}{\dref} - 1}\\[0.3em]    \end{bmatrix}.
%\label{Eq:3D_fixed_reference}
%\end{equation}
This parametric curve is similar to that of the 2D line source case (Figure \ref{Fig:Theory:fixed_referencing}), however with several important differences.

The $y$-coordinate exhibits a maximum in front of the virtual source, where $r_0 = |y_s|$. For any other position the PCS is closer to the SSD. 
Therefore, $r_0 = |y_s|$ is the critical point of the curve: a position of correct synthesis can only be found in the listening area if $|y_s| > \dref$, i.e. the virtual source must be further away from the SSD than the fixed reference distance. 
Actually, the synthesis gives a fair result close to the SSD only in case, $|y_s| \gg \dref$. 


As the virtual source approaches the SSD the position of correct synthesis tends to infinity. Here it is stated , that $|y_s|$ should be less, than $\dref$. 
If $\dref$ is large enough, far field assumptions for the SPA still hold, however no PCS can be found. 
This type of referencing therefore may suffer from serious amplitude errors in the vicinity of the SSD.


\subsubsection{Referencing along a parallel line}
Referencing along a line that is parallel to the SSD at distance $y=\yref>0$ is obtained by setting the $y$-coordinate of \eqref{Eq:3D_curve} to a fix $\yref$ value, yielding the referencing function
%\begin{equation}
%-y_s \frac{d(x_0)}{r_0 - d(x_0)} = \yref.
%\end{equation}
%The resulting referencing function reads
\begin{equation}
d_\text{line,PS}(x_0) = r_0 \frac{\yref}{\yref-y_s}.
\end{equation}
Substituting it back to \eqref{Eq:2_5D_point_source_implicit_df_Explanations} one obtains
\begin{equation}
D(x_0,\omega) = 
- \sqrt{\frac{\ti k}{2\pi}} \sqrt{\frac{\yref}{\yref -y_s}}  y_s \frac{\te^{-\ti k r_0 }}{r_0^{3/2}},
\end{equation}
which exactly yields the well-known WFS driving function \cite[(2.27)]{Verheijen1997:phd}, \cite[(3.16)\&(3.17)]{Start1997:phd} of a point source, that is simultaneously equivalent to the farfield/high-frequency approximated explicit SDM solution \cite[(25)]{Spors10ahrens:analysis}.

\subsubsection{Referencing along a circle}
Referencing the synthesis along a circle around the point source in the synthesis plane is obtained by solving, cf. \eqref{Eq:dx0_mapping} and \eqref{Eq:dCircleLS}
\begin{equation}
d(x_0)\frac{r_0}{r_0 - d(x_0)} = R_{\mathrm{ref}} - r_0,
\end{equation}
resulting in
\begin{equation}
d_\text{circle,PS}(x_0)  = r_0 \frac{R_{\mathrm{ref}} - r_0}{R_{\mathrm{ref}}}.
\end{equation}
%
The performance of this referencing type is demonstrated in Figure \ref{Fig:Theory:point_source_referencing} (c).



\section{2.5D WFS for non-linear secondary source distributions}

\subsection{2.5D Neumann Rayleigh integral}
%
\begin{figure}
	\centering
	\begin{overpic}[width = 0.7\columnwidth ]{Figures/WFS_theory/wfs_nonlinear_Geometry.png}
	\scriptsize
	\put(17,14){$x$}	
	\put(12,28){$y$}	
	\put(1, 36){$z$}
	\put(33.5,20){$\vxo$}
	\put(46.6,31.5){$\vx$}
	\put(80,34){synthesis plane}
	\put(69,42){$\dO_{3\mathrm{D}}$}
	\put(69,23){$\dO_{2.5\mathrm{D}}$}
	\end{overpic}
\caption{General 3D WFS geometry for the derivation of 2.5D driving functions.
The SSD surface $\dO_{3\mathrm{D}} = f(x_0,y_0)$ is chosen to be independent of $z$-coordinate in order to be able to evaluate the integral with respect to $z_0$ using the SPA. If the virtual sound field is a 2D one, propagating in the direction parallel to the listening plane the the SSD can be interpreted as a continuous set of infinite vertical line sources along $\dO_{2.5\mathrm{D}}$ (described by the 2D Green's function), capable of the perfect synthesis of a virtual 2D field inside the enclosure.}
	\label{Fig:WFS_Theory:non_linear_geometry}
\end{figure}

In order to extend the 2.5D WFS theory for non-linear SSDs the geometry depicted in Figure \ref{Fig:WFS_Theory:non_linear_geometry} is considered. The SSD surface is chosen to be an enclosing contour in the $xy$-plane, being invariant along the vertical dimension.
Under high-frequency assumptions the general 2D/3D WFS driving functions, given by \eqref{eq:theory:gen_WFS} can be applied. In this special geometry the synthesized field inside the enclosure can be written in the form
\begin{equation}
P(\vx,\omega) = -2 \oint\displaylimits_{\dO_{2.5\mathrm{D}}} \int\displaylimits_{-\infty}^{\infty} w(\vxo) \frac{\partial P(\vxo,\omega)}{\partial \vni} G(\vx-\vxo,\omega) \, \td z_0 \, \td \dO_{2.5\mathrm{D}}(x_0,y_0).
\end{equation}
Similarly to the planar SSD case, the vertical integral may be approximated by the SPA. Again, $k_{z,P}(x,y,0)$ is assumed, i.e. virtual fields, propagating in the plane of synthesis parallel in $z=0$ direction. The stationary position for any $z=0$ receiver position therefore becomes trivially $z_0^*=0$, and the surface integral can be approximated by a contour integral, termed as the \emph{general 2.5D Neumann Rayleigh integral}
\begin{multline}
P(\vx,\omega) = -2 \oint\displaylimits_{\dO_{2.5\mathrm{D}}} \sqrt{\frac{2 \pi}{\ti \left| \phi''_{P,z,z}(\vxo,\omega) +  \phi''_{G,z,z}(\vx - \vxo,\omega) \right|}} \\
w(\vxo) \frac{\partial P(\vxo,\omega)}{\partial \vni} G(\vx-\vxo,\omega) \, \td \dO_{2.5\mathrm{D}}(x_0,y_0),
\end{multline}
with $\vx = [x,y,0]^{\mathrm{T}}$, $\vxo = [x_0,y_0, 0]^{\mathrm{T}}$ denoting in-plane positions.

The integral implicitly contains the---yet receiver position dependent---2.5D driving functions. Substituting the second derivative of the 3D SSD elements' field yields the general form 
\begin{equation}
D(\vxo,\omega) = -2 w(\vxo) \sqrt{\frac{2 \pi}{\ti k}}\sqrt{\dref(\vxo)}
\frac{\partial P(\vxo,\omega)}{\partial \vni},
\end{equation}
where the referencing function takes the same form as given by \eqref{dx0_2DSources} and \eqref{Eq:dx0_PointSource} for a 2D and a 3D point source target field respectively. Using the Kirchhoff approximation therefore the 2.5D driving functions are given by the 2.5D linear driving functions, completed by the already known windowing function.

In the followings it is demonstrated, that the referencing approach, described earlier may be applied without any modification for arbitrary SSD contours. 
Since both SPA and Kirchhoff-approximation are valid at high-frequency regions no further presumptions are required. The positions of correct synthesis are therefore given by
\begin{equation}
\vxref = \vxo + \vhk |\vx-\vxo|
\end{equation}
for an arbitrary SSD geometry.


\subsection{Referencing function and referencing schemes}

The validity of the referencing schemes are demonstrated via the example of a circular SSD with a radius of $R_0$. 
For such an SSD ensemble the normal derivative is given by the radial derivative and the WFS driving function reads
\begin{equation}
D(\beta,\omega) = + \sqrt{\frac{8\pi}{\ti k}}\,w(\beta)\,\sqrt{d(\beta)} \left. \frac{\partial P(r,\beta)}{\partial r}  \right|_{r = R_0}.
\end{equation}

\begin{figure}
	 \centering
	 \begin{overpic}[width = .95\columnwidth]{Figures/WFS_theory/real_part_circular.png}
	 \end{overpic}
 \caption{ The synthesis of a plane wave (a) and a line source (b), used in the following examples. The plane waves propagates in the $x$-direction. The line source is located at $\mathbf{x}_s = [-3,\ 0]^{\mathrm{T}}$. The SSD is a circular array with $R_0 = 2~\mathrm{m}$. The source frequency is set to $\omega_0 = 2\pi	\cdot 1 ~\mathrm{krad/s}$.}
	 \label{Fig:Theory:real_part_circular}
 \end{figure}
%
The referencing function $d(\beta)$ for an arbitrary curve can be found in the same manner as for a linear SSD using the SPA. 
In this case geometrical considerations give us a much simpler referencing method: the stationary secondary source can be found where the wavenumber vector intersects the SSD, which is a constant directed vector for a plane wave, and any vector directed radially from the source position for a line/point source. 
The position of reference position can be found in the same direction from any stationary secondary source in a distance of $d(\beta)$ in the plane wave and line source case, and $d(\beta)\frac{r_0}{r_0-d(\beta)}$ for a 3D point source.

Two referencing schemes are presented in order to demonstrate the validity of the presented approach: referencing the synthesis along a straight line, and along a concentric circle inside the circular SSD.

\subsubsection{Effects of constant referencing}

First, the effect of a constant referencing function is investigated. 
For both a plane wave and a line source the position of correct synthesis can be found based on the problem geometry.

\begin{figure}
	\centering
	\begin{overpic}[width = .85\columnwidth  ]{Figures/WFS_theory/fixed_referencing_circle.png}
	\scriptsize
	\put(6,36.2){$\varphi_\text{PW}$}
	\put(43, 17){$x$}
	\put(23, 39){$y$}
    \put(9.5,30){$\dref$}
    \put(3,  39){$\mathbf{k}$}
    \put(17.5, 19.2){$\beta$}
	\put(3.5,    27){$\vxo$}
%
    \put(63.5, 27.5){$\dref$}
    \put(100,17){$x$}
    \put(79, 38){$y$}
    \put(69, 22){$R_0$}
    \put(56.5,21.5){$r_0$}
    \put(58.5,19.5){$\alpha$}
    \put(68.5,19.5){$\beta$}
    \put(55,  17){$\mathbf{x}_s$}
	\end{overpic}
\caption{ Geometry for finding the position of amplitude correct reproduction of a plane wave (a) and a line source (b) }
	\label{Fig:Theory:fixed_referencing_circle}
\end{figure}

For the case of the synthesis of a plane wave it is obvious, that the points from each SSD element at a distance of $\dref$ describe a circle with the same radius as the SSD, translated in the direction of the plane wave by $\dref$. 
See Figure \ref{Fig:Theory:fixed_referencing_circle} (a). The PCS are therefore given by
\begin{eqnarray}
\mathbf{x}_{\mathrm{ref,PW}}(\vxo) = \colvec{2}{ \cos \beta \,R_0  + \cosfi_\text{PW}\, \dref }{  \sin \beta \,R_0  + \sinfi_\text{PW}\, \dref }
\label{Eq:Fixed_referencing_pw_circle}
\end{eqnarray}
with $\varphi_\text{PW}$ being the propagation angle of the plane wave measured from the $x$-axis.
\begin{figure}
	\centering
	\begin{overpic}[width = .95\columnwidth]{Figures/WFS_theory//fixed_referencing_circular.png}
	\end{overpic}
\caption{ Positions of amplitude correct synthesis using circular SSD for a virtual plane wave (a) and line source (b). The referencing function is set to $\dref = 1~\mathrm{m}$. }
	\label{Fig:Theory:fixed_referencing_circular}
\end{figure}

For a virtual line source the parametric curve can be given by the problem geometry, displayed in Figure \ref{Fig:Theory:fixed_referencing_circle} (b).
The PCS are given by
\begin{eqnarray}
\mathbf{x}_{\mathrm{ref,LS}}(\vxo) =  \colvec{2}{ x_s + \cos\alpha \, (\dref + r_0)}{ y_s + \sin\alpha\, (\dref+r_0)}.
\label{Eq:Fixed_referencing_ls_circle}
\end{eqnarray}
This curve is not easily accessible for analytic investigation, however two limiting curves can be described purely from the problem geometry. 
As the virtual source approaches the SSD the curve describes a circle around the virtual source with a radius of $\dref$. 
If the virtual source is very far from the SSD the incident field becomes a plane wave and the curve describes a circle with a radius same as the SSD, translated by $\dref$ into the direction, defined by the position vector of the virtual source. 
%In other virtual source position the curve is a mixture of these two circles. 
It is also ensured, that in front of the virtual source, the distance of amplitude correct synthesis from the corresponding SSD element is $\dref$. 
%This fact is in analogy with the linear SSD case.
Results of numeric simulation, using these referencing schemes are depicted in Figure \ref{Fig:Theory:fixed_referencing_circular}.

\begin{figure}
	\centering
	\begin{overpic}[width = .85\columnwidth]{Figures/WFS_theory/fixed_referencing_circular_ps.png}
	\end{overpic}
\caption{ Positions of amplitude correct synthesis using circular SSD with radius of $R_0 = 1.5~\mathrm{m}$ for a virtual point source with the virtual source positioned at $\mathbf{x}_s = [-2.5,\ 0,\ 0]^{\mathrm{T}}$ (a) and $\mathbf{x}_s = [-4,\ 0,\ 0]^{\mathrm{T}}$ (b). The referencing function is set to $\dref = 1~\mathrm{m}$. In (a) in front of the virtual source is $0.5~\mathrm{m}$, with $r_0< \dref$, therefore no position for correct synthesis can be found. As the virtual source gets further from the SSD (b), $r_0> \dref$ is satisfied, and the position of correct synthesis in front of the virtual source becomes $x_c = x_s + r_0\frac{r_0}{r_0-\dref} = 0$. }
	\label{Fig:Theory:fixed_referencing_circular_ps}
\end{figure}

In each case it should be noted, that the position of amplitude correct synthesis can be defined only inside the SSD. 
Moreover, due to high-frequency approximations for the arbitrary SSD extension the curve of correct synthesis is shorter, than it would be allowed by the previous limitation (i.e. does not limited by the intersections with the SSD). 
This can be explained by two reasons: in the ending of the curves the corresponding stationary SSD elements can not be modeled as flat surfaces in order to apply the Kirchhoff-approximation due to the large local angle of inclination of the incident field. On the other hand in these parts also the diffraction waves would have considerable contribution in the synthesized field, which are inherently omitted in the geometrical optics approximation (i.e. in these parts of the SSD both assumptions for the Kirchhoff approximation fail).
This phenomenon can be observed in both Figure \ref{Fig:Theory:fixed_referencing_circular} (a) and (b).

For the synthesis of a virtual point source the substitution of $\dref \rightarrow \dref \frac{r_0}{r_0 - \dref}$ w.r.t. the line source case in \eqref{Eq:Fixed_referencing_ls_circle} holds as discussed above. The PSC are then given as
\begin{eqnarray}
\mathbf{x}_{\mathrm{ref,PS}}(\vxo) =  \colvec{2}{ x_s + \cos\alpha \, r_0 \frac{r_0}{r_0 - d}  }{ y_s + \sin\alpha\, r_0 \frac{r_0}{r_0 - d} }.
\label{Eq:Fixed_referencing_ps_circle}
\end{eqnarray}
Similarly to the linear SSD case that means, that in front of the virtual source the position of correct synthesis measured from the SSD becomes $\dref \frac{r_0}{r_0- \dref}$, therefore if the point source is closer to the SSD than the reference distance, no position for amplitude correct synthesis can be found. This can be observed in Figure \ref{Fig:Theory:fixed_referencing_circular_ps}.

\subsubsection{Referencing to an arbitrary curve}
\begin{figure}
	\centering
	\begin{overpic}[width = .85\columnwidth]{Figures/WFS_theory/referencing_on_circle_and_line.png}
	\scriptsize
	\put(43, 17){$x$}
	\put(23, 39){$y$}
    \put(9.5,28.5){$d(\varphi)$}
    \put(5,  38){$\mathbf{k}$}
    \put(16, 20){$\beta$}
	\put(4.5,  28){$x_0$}
	\put(12,  22){$R_0$}
	\put(16.5,  25){$R_{\mathrm{ref}}$}
%
    \put(65, 27.5){$d(\varphi)$}
    \put(100,17){$x$}
    \put(80, 39){$y$}
    \put(69, 22){$R_0$}
    \put(56.5,21.5){$r_0$}
    \put(70.5,17){$x_0$}
    \put(68.5,20){$\beta$}
    \put(55,  17){$\mathbf{x}_s$}
	\end{overpic}
\caption{ Geometry for finding $d(\varphi)$ referencing the synthesis of a plane wave to a concentric circle (a) and the synthesis of a line source to a straight line (b). }
	\label{Fig:Theory:referencing_on_line_and_circle}
\end{figure}

Finally it is shown, how synthesis may be referenced to an arbitrary curve. 
Two examples are presented: referencing a plane wave on a circle, and a point source on a line.
Our aim is to find the referencing function $d(\beta)$, equaling the length of the corresponding vector, seen in Figure \ref{Fig:Theory:referencing_on_line_and_circle}. With geometrical considerations they can be expressed as
\begin{eqnarray}
d_\text{circle,PW}(\beta) = R_0\cos \beta - \sqrt{ R_{\mathrm{ref}}^2 - R_0^2\,\sin^2\varphi_\text{PW} }
\\
d_\text{line,LS}(\beta) = -r_0 \left( \frac{x_0 + R_0\cos \beta}{x_s + R_0\cos \beta} \right)
\end{eqnarray}
respectively. 
This latter would ensure the amplitude correct synthesis for a line source. In order to apply the formulation for a 3D point source  $\dref \rightarrow \dref \frac{r_0}{r_0 - \dref}$ substitution is needed, ending up in
\begin{equation}
d_{ps,line}(\beta) = r_0 \frac{x_0 + R_0\cos \beta}{x_0-x_s}.
\end{equation}
The validity of the referencing functions are demonstrated in Figure \ref{Fig:Theory:pw_to_circle_ps_to_line}.
\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/WFS_theory/pw_to_circle_ps_to_line.png}
	\end{overpic}
\caption{ Result of referencing the synthesis of a plane wave to a circle (a) and a 3D point source to a line. The plane wave propagates parallel to the $x$-axis and the point source is located at $\mathbf{x}_s = [-4,\ 0,\ 0]^{}\mathrm{T}$. The radius of the reference circle is $R_{\mathrm{ref}} = 1~\mathrm{m}$ at (a) and the line of referencing is located at $x_0 = -0.5~\mathrm{m}$ in (b).}
	\label{Fig:Theory:pw_to_circle_ps_to_line}
\end{figure}
%
%\newpage
%\section{Relation with the explicit solution}
%\label{Sec:SDM_vs_WFS}
%
%\subsection{SDM driving functions in the spatial domain}
%\subsection{Driving functions on the SSD}
	
% General HF WFS driv. fun.
% Referencing focused sources
% Synthesis applying directive SSD
% The WFS pre-fiters in time domain