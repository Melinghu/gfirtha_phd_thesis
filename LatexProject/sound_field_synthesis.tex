	%\section{The problem formulation}
\begin{figure}[b!]
	\centering
	\begin{overpic}[width = .8\columnwidth]{Figures/SFS_theory/general_sfs.png}
	\small
	\put(0,26){virtual source}
	\put(45,0.5){$\mathbf{0}$}
	\put(71,31){$\vx$}
	\put(43,15){$\vxo$}
	\begin{turn}{27}
	\put(57,-3){$|\vx - \vxo|$}
	\end{turn}
	\put(50,35){$\Omega$}
	\put(80,20.5){$\dO$}
	\end{overpic}
	\caption{Geometry for the general Sound Field Synthesis problem}
	\label{Fig:Theory:general_sfs_geometry}
\end{figure}

In the followings the general Sound Field Synthesis problem is formulated. 
Consider a source-free volume $\Omega \subset \mathbb{R}^n$, bounded by a continuous set of acoustic sources forming the boundary surface $\dO$.
The enclosing source ensemble is termed the \emph{secondary source distribution (SSD)}.
%Obviously, in the aspect of practical applications only 3D problems are of importance ($n=3$).%, however for the sake of computational simplicity several simulations 
The general geometry is depicted in Figure \ref{Fig:Theory:general_sfs_geometry}.
For the sake of simplicity we assume that the boundary is acoustically transparent and the secondary sources are acoustic point sources, i.e. described by the $n$-dimensional free field Green's function. 
Unless it is denoted otherwise, $G(\vx,\omega)$ refers to the 3D Green's function in the followings.
Since dynamic loudspeakers can be modeled as 3D monopoles in the low-frequency region, this choice of SSD elements is feasible. 

With these assumptions the pressure at any $\vx \in \Omega$ is given by the sum of the individual SSD elements, written as a single layer potential \cite{Ahrens2012,Ahrens2010phd,Wierstorf2014,Schultz2014:Comparing_approaches}:
\begin{equation}
P(\vx,\omega) = \oint_{\dO} D(\vxo,\omega) G(\vx - \vxo , \omega ) \td \dO ( \vxo ).
\label{Eq:Theory:3D_SFS}
\end{equation}
The weighting factor $D(\vxo,\omega)$ is termed the \emph{driving function} for the given SSD. 
The Sound Field Synthesis problem can be formulated as the following:
Given a \emph{target sound field}, or the sound field of a \emph{virtual source} $P(\vx,\omega)$, our aim is to solve the integral equation for $D(\vxo,\omega)$, so that the weighted sum of the SSD's sound field---i.e. the \emph{synthesized field}---equals to the target sound field. 
The problem is therefore an inverse problem and has a unique solution for general enclosures.

Comparing the general SFS formulation \eqref{Eq:Theory:3D_SFS} with the Kirchhoff-Helmholtz integral \eqref{Eq:Theory:Kirchhoff-Helmholtz} it becomes clear that SFS with a single layer SSD is not able to ensure identically zero sound field outside the enclosure. Practically, the dipole sources that would cancel the field of the monopoles outside the volume are removed from the surface.
In the present thesis free-field conditions are assumed: the exterior sound field satisfies the Sommerfeld radiation condition, thus the effect of the listening environment in practical applications is not considered. For the inclusion of room effects to the SFS problem refer to \cite{Spors2005}.
%
%In the followings mainly planar and linear SSD geometries are considered employing 3-dimensional secondary sources.
%Since dynamic loudspeakers can be modeled as 3D monopoles in the low-frequency region, this choice of SSD elements is feasible. 
%\footnote{Dynamic loudspeakers actually can be modeled as point sources with respect to the velocity potential, forming a pulsating point source. Due to the virtual source and secondary source interchangeability this means, that when the target sound field is that of a point source, the virtual source model will be a point source with respect to the velocity potential in practical applications.}.

\vspace{3mm}
So far only the general 3D SFS setup has been discussed.
This requires an enclosing surface or an infinite planar distribution of 3D point sources, making practical implementations hardly realizable.
In practice it is often sufficient to restrict the reproduction to the plane containing the 2D contour of secondary sources.
This \emph{synthesis plane} can be chosen at $z=0$ without loss of generality.
This reproduction scenario is termed \emph{2.5D synthesis}, referring to the fact, that although the problem dimensionality is reduced to $n=2$, still the 2D SSD contour consists of 3D point source elements.
In this geometry the general 2.5D synthesis problem is formulated as
\begin{equation}
P(\vx,\omega) = \oint_{C} D(x_0,y_0,0,\omega) G(x - x_0, y-y_0, 0 , \omega ) \td s( \vxo ),
\label{Eq:Theory:25D_SFS}
\end{equation}
where $C(x_0,y_0)$ is the SSD contour and $\td s$ is the arc length.
Obviously, neither 2D nor 3D sound fields can be perfectly synthesized in this geometry due to dimensionality inconsistency between the target field and the SSD.
Overcoming the artifacts of this \emph{dimensionality mismatch} is the central question of practical sound field synthesis and the main topic of the present chapter.

This chapter presents approaches to solve the 3D and 2.5D SFS problem including physically based implicit and particularly mathematical explicit solutions. 

%Explicit solutions aim to solve the inverse problem directly, while implicit approaches transform the KHIE to the form of \eqref{Eq:Theory:3D_SFS} with taking the SSD geometry into consideration, thus the obtained single layer potential implicitly contains the driving functions.

%For special geometries---planar, linear, spherical, circular or cylindrical SSDs---analytical expressions are available.
%In the following these approaches are outlined focusing on planar and linear SSD arrays.


\section{Implicit solution: Wave Field Synthesis}

\subsection{3D Wave Field Synthesis}

Generally speaking, the implicit solution for the SFS problem aims at the derivation of an appropriate single layer potential representation of the target sound field, containing the required SSD driving functions implicitly.
In case of a 3D SFS problem obtaining the implicit solution is straightforward, based on the boundary integral representations discussed in the previous chapters.

Assume a general enclosing 3D SSD surface consisting of 3D point sources.
Comparing the Kirchhoff approximation of the Kirchhoff-Helmholtz integral \eqref{Eq:SFS_theory:Kirchhoff_appr} or \eqref{Eq:HF_appr:Kirchhoff_approximation} with the general SFS equation \eqref{Eq:Theory:3D_SFS} reveals, that the Kirchhoff approximation implicitly contains the driving functions for a general enclosing SSD, and the driving function is given by
\begin{equation}
D(\vxo,\omega) = - 2w(\vxo)\frac{\partial P(\vxo,\omega)}{\partial \vni}, 
\label{Eq:Theory:2D_3D_WFS_driv_fun}
\end{equation}
or making use of the high-frequency gradient approximation
\begin{equation}
D(\vxo,\omega) = 2 w(\vxo) \ti k_{\mathrm{n}}^P(\vxo) P(\vxo,\omega)
\label{Eq:Theory:2D_3D_WFS_driv_fun_2}
\end{equation}
with $k_{\mathrm{n}}^P(\vxo)$ being the normal component of the target field's local wavenumber vector taken on the SSD and $w(\vxo)$ being the window function, as introduced in the previous chapter:
\begin{equation}
w(\vxo) = \begin{cases}
                        1, \hspace{3mm} \forall \hspace{3mm} \langle \mathbf{k}(\vxo) \cdot \mathbf{n}_{\text{in}}(\vxo) \rangle > 0 \\
                        0  \hspace{3mm} \text{elsewhere}.
                    \end{cases}
\end{equation}
The driving function \eqref{Eq:Theory:2D_3D_WFS_driv_fun_2} is a common generalization of the 3D WFS driving function given by \cite[Eq. 20.]{Zotter2013:uniqueness} for a virtual point source.
Both formulations are valid in the high-frequency region, for convex SSDs within the validity of the Kirchhoff approximation: in the far-field of the virtual source distribution generating the virtual sound field---i.e. where the local plane wave approximation of the virtual field holds---. %, for which $k \rho_i \gg 1$  with $\rho_i$ being the principal radii of the SSD surface.
In the context of WFS the windowing is termed \emph{secondary source selection criterion} \cite{Spors2007, Spors2007:DAGA:SS_selection_criterion}, selecting the \emph{active secondary sources} contributing to the synthesized field. 

\vspace{3mm}
In the special case of an infinite planar SSD surface located along the plane $y = 0$, the Kirchhoff-Helmholtz integral simplifies to the Neumann Rayleigh integral representing the field of any source distribution located at $y<0$, as discussed in \ref{Section:Theory:Rayleigh}.
Therefore---as comparison of the general SFS equation \eqref{Eq:Theory:3D_SFS} with the Rayleigh integral \eqref{Eq:Theory:RayleighI} reveals---the driving function \eqref{Eq:Theory:2D_3D_WFS_driv_fun} is capable of the perfect synthesis of an arbitrary virtual sound field over the listening half-space $y>0$ without any approximations involed.
In this case no windowing is required, i.e. $w(\vxo) \equiv 1$ and the normal derivative is simply given by the $y$-derivative of the target/virtual sound field.

%Comparison with the explicit solution \eqref{Eq:Theory:Planar_explicit_driv_fun_spatial} reveals also the equality of the implicit and the explicit solutions.
%The equivalence of the explicit approach and the simple source formulation follows from the uniqueness of the solution for the inverse problem in the case of a planar geometry \cite{Fazi2010}.
%It should be noted, that the traditional derivation of the Rayleigh-integral follows the Neumann Green's function approach, therefore the equivalence of all three approaches accidental, and is valid only for the planar geometry.
%
%%As a conclusion: all three approaches lead to the very same result for a planar SSD geometry: an arbitrary source free sound field may be perfectly synthesized by a set of point sources distributed along an infinite plane by driven by the driving function \eqref{Eq:Theory:3D_WFS_driv_fun}.
%\vspace{3mm}
%In the high frequency region the Kirchhoff approximation provides implicitly the driving functions for an arbitrary smooth, convex enclosing SSD given by
%\begin{equation}
%D(\vxo,\omega) = - 2w(\vxo)\frac{\partial P(\vxo,\omega)}{\partial \vni}.
%\label{eq:theory:gen_WFS}
%\end{equation}
%The KHIE therefore locally approximated by the Rayleigh-integrals, and high-frequency driving functions are given by the planar driving functions taken locally on the SSD surface.
%This result is not exclusively valid for WFS: theoretically any planar driving function may be applied for arbitrary SSD surfaces using the Kirchhoff approximation \cite{Ahrens2012}, however only WFS provides an easily implementable approach.

%%When compared to the explicit solution a further drawback is that simple source approach allows only point secondary sources.

\subsection*{Application example: 3D synthesis of a virtual point source}

\begin{figure}  
\small
  \begin{minipage}[c]{0.64\textwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/SFS_theory/3D_WFS_general.png}
	\end{overpic}   \end{minipage}\hfill
	\begin{minipage}[c]{0.35\textwidth}
    \caption{3D synthesis of a 3D point source located at $\vxs = \posvec{3}{0.4}{2.5}{0}$, radiating at $\omega_0 = 2\pi \cdot 1.5 \mathrm{krad}/s$.
    The SSD surface is chosen to be independent of $z$-coordinate, i.e. as illustrated in \ref{fig:SFS_theory:WFS_geometry}.
	Obviously, instead of a vertically infinite SSD, the SSD was truncated and tapered along the vertical dimension by choosing parameters, so that the diffraction effects due the truncation are not considerable in the simulation results.
    Figure (a) depicts the real part of the synthesized field, (b) presents the absolute error of synthesis (i.e. the discrepancy between the synthesized and the target sound field) in a logarithmic scale measured in the horizontal plane, containing the virtual point source.
	The active arc of the SSD is denoted by solid black line, and the inactive part with dotted by black line.
    }
\label{fig:SFS_theory:3D_WFS_general}  \end{minipage}
\end{figure}

As a simple example the 3D WFS of a virtual point source is discussed.
Assume a 3D point source located at $\vxs = \posvec{3}{x_s}{y_s}{z_s}$.
Substituting the Green's function into \eqref{Eq:Theory:2D_3D_WFS_driv_fun_2} yields the point source specific 3D WFS driving function
\begin{equation}
D(\vxo,\omega) = w(\vxo)  \frac{\ti k }{2\pi} \frac{\left< \vxo-\vxs \cdot \vn(\vxo) \right> }{|\vxo-\vxs|} \frac{\te^{-\ti k |\vxo-\vxs|}}{|\vxo-\vxs|},
\end{equation}
begin equivalent to \cite[Eq. 20.]{Zotter2013:uniqueness} and \cite[Eq. 19.]{Spors2008:WFSrevisited}.

The result of synthesis is depicted in Figure \ref{fig:SFS_theory:3D_WFS_general} for the special case of an SSD surface, being independent of the $z$-coordinate, as illustrated by Figure \ref{fig:SFS_theory:WFS_geometry} in the following section.
As it can be seen, the driving functions ensure amplitude correct synthesis within the validity of the Kirchhoff-approximation:
amplitude errors arise 
\begin{itemize}
\item in the proximity of SSD elements with large local curvature of the SSD surface, due to the local failure of the tangent plane approximation
\item in the proximity of SSD elements where the normal component of the local wavenumber vector is small---i.e. parts off the SSD, nearly parallel to the local virtual field propagation direction---, since at these positions the high-frequency gradient approximation fails, with also the lack of diffractional waves causing amplitude errors.
\item at space regimes for which the above described SSD elements serve as a stationary position as discussed in \label{Sec:HS_approx:SPA_for_Rayleigh}.
\end{itemize}
% On other space regimes, for which the corresponding stationary SSD element satisfies assumptions for the Kirchhoff approximation, amplitude correct synthesis is achieved.

\subsection{The 2.5D Kirchhoff approximation}

Before dealing with the question of 2.5D Wave Field Synthesis a further simplification of the Kirchhoff approximation is introduced.
This simplification reduces the 3D Kirchhoff integral into a 2D contour integral describing a 3D sound field with the integral kernel being the 3D Green's function.
The approximation is therefore referred to as the \emph{2.5D Kirchhoff integral}, frequently occurring in the field of seismic migration and inversion problems.
The dimensionality reduction is performed by applying the stationary phase method to the Kirchhoff integral along the vertical dimension.

Assume a 3D interior radiation problem, with the sound field under consideration described by the Kirchhoff integral \eqref{Eq:HF_appr:Kirchhoff_approximation} written on a surface, being independent of the $z$-coordinate.
The problem geometry is depicted in Figure \ref{fig:SFS_theory:WFS_geometry}.
In the followings the receiver position is assumed to be at $z=0$ inside the enclosure, i.e. $\vx = \posvec{3}{x}{y}{0} \in \Omega$.
%
\begin{figure}  
\begin{minipage}[c]{0.6\textwidth}
  \hspace{0cm}
	\begin{overpic}[width = 1\columnwidth ]{Figures/SFS_theory/WFS_geometry.png}
	\small
	\put(82,51){$x$}
	\put(91.5,33){$y$}
	\put(95,65.5){$z$}
	\put(48,35.5){$\vx$}
	\put(65,45.5){$\vxo$}
	\put(7,22){plane of interest}
	\put(30,8){$\dO$: 3D surface}
	\put(48,24.5){$C$: 2.5D contour}
	\end{overpic}  \end{minipage}\hfill
	\begin{minipage}[c]{0.37\textwidth}
    \caption{
    Geometry for the derivation of 2.5D Kirchhoff integral.
The enclosing surface $\dO = f(x_0,y_0)$ is chosen to be independent of the $z$-coordinate in order to be able to evaluate the Kirchhoff integral with respect to $z_0$ using the SPA. 
If the sound field to be described is a 2D one, propagating in the direction parallel to the listening plane, then the surface can be interpreted as a continuous set of infinite vertical line sources along $C$ (described by the 2D Green's function), capable of the perfect description of a 2D field inside the enclosure by a 2D countour integral.}
\label{fig:SFS_theory:WFS_geometry}  
\end{minipage}
\end{figure}
%
In this special geometry the integral variables are separable and the Kirchhoff integral can be written as
\begin{equation}
P(\vx,\omega) = 
\oint_{C} \int_{-\infty}^{\infty} 
2 w(\vxo) \ti k_{\mathrm{n}}^P(\vxo) 	
P(\vxo,\omega) G(\vx-\vxo,\omega)  \td z_0 \td s,
\label{Eq:SFS_theory:Kirchhoff_spec_geom}
\end{equation}
with the integral variable $\td s$ being the arc length along the contour $C = f(x_0,y_0,0)$.

The integral is approximated applying the stationary phase approximation along the $z_0$-dimension.
Since the contour of integration is chosen to lie at the $z=0$ plane, therefore the vertical stationary position has to be found at $z_0^* = 0$.
Based on the foregoing this requirement can be formulated as
\begin{equation}
k_z^P(x_0,y_0,0) = - k_z^G(x-x_0,y-y_0,0) = 0,
\end{equation}
stating the trivial fact, that a sound field can be described by a 2.5 dimensional contour integral only in the plane where all the sound sources are located, and which plane the emerging waves propagate parallel with.
In the plane of investigation $k_z^P(x,y,0) \equiv 0$ holds, being valid for 3D sources located at the plane of investigation and for 2D sources being invariant along the vertical dimension.

Having the vertical stationary position fixed to $z_0^* = 0$ the vertical integral can be approximated by the SPA.
Application of the 1D SPA formulation \eqref{Eq:SPAResult} requires the sign of the phase function's second derivative at the stationary position reading
\begin{equation}
\phi''_{zz}(x_0,y_0,0) = \phi^{P''}_{zz}(x_0,y_0,0) +\phi^{G''}_{zz}(x-x_0,y-y_0,0) = -\left( \kappa_2^P(\vxo) + \kappa_2^G(\vx-\vxo) \right),
\end{equation}
which in the present case is the negative sum of the principal curvatures of sound field $P$ and the Green's function as discussed in appendix \ref{App:Hessian} in details.
By definition, for an arbitrary diverging sound field the principal curvatures are positive.
For a converging wavefront the signature of the resultant curvature depends on the receiver position $\vx$: in regions of the receiver plane where sound field $P$ locally converges the resultant curvature is negative, while in regions where the sound field diverges, e.g. after passing a focal point the resultant curvature is positive.
In the present thesis only locally diverging wave fields are discussed, ensuring that $\mathrm{sign} \left( \phi''_{zz}(x_0,y_0,0) \right) = -1$ holds.

With these considerations application of the SPA to \eqref{Eq:SFS_theory:Kirchhoff_spec_geom} results in the \emph{2.5D Kirchhoff integral}, reading as
\begin{equation}
P(\vx,\omega) = 
\oint_{C}
2 w(\vxo) 
\sqrt{\frac{2 \pi}{\ti |\phi^{P''}_{zz}(\vxo) +\phi^{G''}_{zz}(\vx-\vxo)|}}
\underbrace{\ti k_{\mathrm{n}}^P(\vxo) 	P(\vxo,\omega) }_{ - \frac{\partial P(\vxo,\omega)}{\partial \vn_{\mathrm{in}}}}
G(\vx-\vxo,\omega) \td s, 
\label{Eq:SFS_thery:25_KI}
\end{equation}
with both $\vx = \posvec{3}{x}{y}{0}$ and $\vxo = \posvec{3}{x_0}{y_0}{0}$ now denoting in-plane positions.

\subsection{2.5D Wave Field Synthesis}

The 2.5D Kirchhoff integral implicitly contains the 2.5D WFS driving functions for a convex continuous contour of 3D point sources at the $z = 0$ plane.
%Comparing the expression for the synthesized field \eqref{Eq:Theory:25D_SFS} with \eqref{Eq:SFS_thery:25_KI} implicates that the required driving functions can be extracted from the 2.5D Kirchhoff integral.
The resulting driving functions are however still dependent on the listener position through the argument of $\phi^{G''}_{zz}(\vx-\vxo)$, which dependency may be avoided by fixing the listener position.
This strategy would only allow the synthesis of the virtual field, optimized to a single, fixed receiver position termed the \emph{reference point}, while in other points in the listening plane amplitude errors would be present.
In the followings it is presented how these driving functions can be further manipulated in order to ensure correct synthesis along an arbitrary receiver curve, termed the \emph{reference curve} within the validity of the stationary phase approximation, resulting in the \emph{unified 2.5D WFS theory}.

\vspace{3mm}
As it was stated in section \ref{Sec:HS_approx:SPA_for_Rayleigh}, for any receiver position $\vx$ the Kirchhoff integral is dominated by that stationary contour element $\vxo^*(\vx)$, from which the emerging spherical wavefronts locally coincide with the the target field wavefront, i.e. where $\vk^P(\vxo^*(\vx)) = \vk^G(\vx - \vxo^*(\vx))$ is satisfied.
As a consequence, the 2.5D Kirchhoff integral may be further approximated by expressing the amplitude factor with its value at the stationary position as
\begin{equation}
P(\vx,\omega) = 
\oint_{C}
- 2 w(\vxo) 
\sqrt{\frac{2 \pi}{\ti |\phi^{P''}_{zz}(\vxo) +\phi^{G''}_{zz}(\vx-\vxo^*(\vx))|}}
\ti k_{\mathrm{n}}^P(\vxo) 	P(\vxo,\omega)
G(\vx-\vxo,\omega) \td s,
\label{Eq:SFS_theory:25D_KI_appr}
\end{equation}
where $\vxo^*(\vx)$ is defined by the implicit relationship above.

The statement can be expressed by reversing causality, forming the main idea of 2.5D WFS: 
every point $\vxo$ on the secondary distribution contributes to the total sound field at the set of positions $\vx(\vxo)$ where the local propagation direction of a point source positioned at $\vxo$ coincides with that of the target field, i.e. where their local wavenumber vectors coincide.
Hence $\vx$ and $\vxo$ are \emph{stationary point pairs}, mutually determining each other.
By reversing the causality, i.e. choosing $\vxo$ as an independent parameter, the 2.5D WFS driving functions can be extracted from \eqref{Eq:SFS_theory:25D_KI_appr} resulting in the \emph{unified 2.5D Wave Field Synthesis driving functions}
\begin{equation}
D(\vxo, \omega) = -w(\vxo) 
\sqrt{\frac{8\pi}{\ti k}}\sqrt{\dref(\vxo)}
\ti k_{\mathrm{n}}^P(\vxo) 	P(\vxo,\omega),
\label{Eq:SFS_theory:25D_WFS_driv_fun}
\end{equation}
with the term $\dref(\vxo)$ denoting the \emph{referencing function}, defined as
\begin{equation}
\dref(\vxo) = \frac{k}{|\phi^{P''}_{zz}(\vxo) +\phi^{G''}_{zz}(\vxref(\vxo)-\vxo)|}.
\end{equation}
Position $\vxref(\vxo)$ is a point on a pre-defined \emph{reference curve} $C_{\mathrm{ref}}$, for which $\vxo$ is a stationary position on the SSD, thus defined by
\begin{equation}
\vk^P(\vxo) = \vk^G(\vxref(\vxo) - \vxo),
\label{Eq:SFS_theory:WFS_General_Stat_pos}
\end{equation}
with $\vxref(\vxo) \in C_{\mathrm{ref}}$.
The reference curve must be a smooth convex curve inside the listening region, ensuring that each reference point has a unique stationary point pair.
Once the reference position $\vxref(\vxo)$ is known for each SSD element the WFS driving functions \eqref{Eq:SFS_theory:25D_WFS_driv_fun} can be evaluated.
%Since \eqref{Eq:SFS_theory:25D_KI_appr} holds in case $\vx$ and $\vxo$ are stationary point pairs, the introduced driving function driving functions will ensure amplitude correct synthesis over the reference curve within the validity of the SPA.
Referencing the WFS driving function is therefore done by prescribing a unique reference point for each SSD element, so that the set of these reference points form the continuous reference curve.
The resulting driving functions will result in amplitude correct synthesis over the reference curve within the validity of integral formulation \eqref{Eq:SFS_theory:25D_KI_appr}.

%
\begin{figure}
	\centering
	\begin{overpic}[width = .75\columnwidth]{Figures/SFS_theory/WFS_ref_point.png}
	\small
	\put(31,32){$\vxo$}
	\put(48,25){$\vxref^*(\vxo)$}
	\begin{turn}{-12.5}
	\put(28,33){$\vk^P(\vxo)$}
	\end{turn}
	\begin{turn}{18}
	\put(52,1){reference curve}
	\end{turn}
	\end{overpic}
    \caption{
    Illustration for the location of the reference position for an SSD element located in $\vxo$.
    Due to the phase characteristics of the Green's function, as a simple geometrical consideration, the reference position $\vxref^*(\vxo)$ for an arbitrary SSD element  can be found at the intersection of the reference curve and the line emerging from $\vxo$ pointing into the local wavenumber vector of the virtual field $\vk^P(\vxo)$.
	The location of the arbitrarily chosen reference curve is denoted by dashed black line, with solid line indicating the positions, for which a stationary SSD position can be found.
	Amplitude correct synthesis may be only achieved along this part of the reference curve.
   }
\label{fig:SFS_theory:WFS_ref_point}  
\end{figure}
%
By substituting the explicit expression for the Green's function's wavenumber ($\vk^G(\vx) = k\frac{\vx}{|\vx|}$) into \eqref{Eq:SFS_theory:WFS_General_Stat_pos}, the set of positions for which a given $\vxo$ serves as stationary point reads as
\begin{equation}
\vx = \vxo + \hat{\vk}^P(\vxo) |\vx-\vxo|.
\end{equation} 
The equation describes straight lines passing through $\vxo$, being parallel to the local wavenumber vector of the target sound field $\vk^P(\vxo)$ .
Each SSD element therefore dominates the synthesized field towards the direction of the virtual field's local propagation direction at the SSD position.
Along this straight line inside the SSD the virtual field wavefront matches the actual SSD element's wavefront, and the reference position for the actual SSD element is found at the intersection of this straight line and the reference curve.
The location of the reference position for a given SSD element is illustrated in Figure \ref{fig:SFS_theory:WFS_ref_point} for the case of a virtual point source. 
Once the reference position is expressed for each SSD element, the driving functions can be evaluated.

In order to gain a physical interpretation on the structure of the resulting driving functions, the referencing function can be expressed in terms of the principal radii of the virtual field and the Green's function. 
This results in the driving function expression
\begin{equation}
\label{Eq:SFS_theory:25D_WFS_driv_fun_ver_2}
D(\vxo, \omega) = 
\underbrace{\sqrt{\frac{2\pi \rho^G(\vxref(\vxo)-\vxo) }{\ti k}}}_{{\substack{\text{SSD}\\\text{compensation}}}}
\underbrace{\sqrt{ \frac{\rho^P(\vxo) }{\rho^P(\vxo) +  \rho^G(\vxref(\vxo)-\vxo) } }}_{{\substack{\text{virtual source}\\\text{compensation}}}}
\underbrace{\left(-2\right) w(\vxo)  \ti k_{\mathrm{n}}^P(\vxo) 	P(\vxo,\omega)}_{\substack{\text{2D}\\\text{driving function}}},
\end{equation}
where $\rho^P$ and $\rho^G$ are the principal radii of the virtual field and the Green's function along the vertical direction normalized by $k$, with the absolute value operation omitted due to their positive sign for diverging virtual fields.
As it is later verified in \eqref{Eq:principal_radii_addition} furthermore $\rho^P(\vx) = \rho^P(\vxo) +  \rho^G(\vxref(\vxo)-\vxo)$ holds.

The terms in the driving function can be identified as compensation factors for the \emph{dimensionality mismatch}, present in the 2.5D Kirchhoff integral.
According to the 2D Kirchhoff approximation given by \eqref{Eq:SFS_theory:Kirchhoff_appr}, an arbitrary 2D sound field may be described in the area of investigation by a contour integral.
The enclosing boundary can be interpreted as the continuous distribution of two dimensional secondary point sources described by the 2D Green's function, being infinite vertical line sources in three dimensions.
The 2D Green's function is weighted by the normal derivative of the 2D sound field, taken on the SSD contour.

\begin{figure}  
\small
  \begin{minipage}[c]{0.64\textwidth}
	\begin{overpic}[width = 1\columnwidth ]{Figures/SFS_theory/25D_WFS_general.png}
	\end{overpic}   \end{minipage}\hfill
	\begin{minipage}[c]{0.35\textwidth}
    \caption{2.5D synthesis of a 3D point source located at $\vxs = \posvec{3}{0.4}{2.5}{0}$, radiating at $\omega_0 = 2\pi \cdot 1.5 \mathrm{krad}/s$ in order to ensure high-frequency conditions.
    Figure (a) depicts the real part of the synthesized field, (b) presents the absolute error of synthesis in a logarithmic scale.
	The reference curve is derived by rescaling the SSD contour.
	The active arc of the SSD is denoted by solid black line, and the inactive part with dotted by black line.
	The reference position on the reference curve for each active SSD element is evaluated numerically.
	Obviously in the present geometry there exist SSD elements, for which no unique reference position can be found.
	In order to ensure smooth driving functions and avoid truncation artifacts for these SSD positions, the referencing function is extrapolated. %\footnote{For general enclosing SSDs the normal component of the local wavenumber vector tends to zero smoothly, ensuring driving functions with smooth envelope.
%	In case the SSD is truncated diffraction waves are present emerging from the SSD edges, resulting in strong ringing artifacts in the listening area.}
    }
\label{fig:SFS_theory:25D_WFS_generals}   \end{minipage}
\end{figure}
%
Application of the 2.5D WFS driving functions aims to describe a 3D sound field in terms of a 2D contour integral with the kernel being the 3D Green's function,
weighted by the normal derivative of the 3D sound field.
This  results in a dimensionality mismatch for both the virtual field and the secondary source elements.
The interpretation of the compensation factors in the driving function is then the following:
\begin{itemize}
\item Term $\sqrt{\frac{ 2\pi |\vxref(\vxo)-\vxo| }{ \ti k }}$ is the compensation factor for the \emph{secondary source dimensionality mismatch}, by expressing the principal radius for the 2D and 3D Green's function as $\rho^G(\vxref(\vxo)-\vxo) = |\vxref(\vxo)-\vxo)|$.
	Comparison with \eqref{eq:HF_approx:2D_vs_3D_GF} indicates, that the compensation factor approximates the frequency response and attenuation factor of the 2D Green's function in terms of the 3D Green's function.
	Obviously, the attenuation factors can be matched only at a particular position of the space for a given SSD element, chosen to be at the reference position $\vxref$.
%
\item The virtual source compensation factor resolves the \emph{virtual source dimensionality mismatch}, correcting the virtual source attenuation factor.
In case of a virtual point source, located at $\vxs$ the principal radius is given by $\rho^P(\vxo)=|\vxo-\vxs|$ and around the horizontal stationary point $\rho^P(\vxo) +  \rho^G(\vxref(\vxo)-\vxo) = |\vxref(\vxo)-\vxs|$ holds.
The numerator of the correction factor then corrects the 3D driving function to an ideal 2D one, while the denominator ensures the correct attenuation of the virtual field at the reference position, as described in details in appendix \ref{App:25D_KI}.
Formulating the correction factors in terms of the principal radii is a straightforward generalization of the foregoing towards general 3D virtual fields.
\end{itemize}
Referencing the synthesis therefore can be interpreted physically by adjusting both attenuation correction factors for each SSD element to be amplitude correct on the reference curve.

\vspace{3mm}
The introduced driving function is capable of the synthesis of arbitrary sound fields applying arbitrary shaped convex SSDs, referencing the synthesis to an arbitrary reference curve. 
% Obviously, for the general case it involves the numerical solution for the referencing position.
The result of such a general 2.5D WFS scenario is presented in Figure \ref{fig:SFS_theory:25D_WFS_generals}.
As the image depicting the synthesis error indicates: on those part of the reference curve for which a stationary point pair can be found on the SSD amplitude correct synthesis is ensured, as the error exhibits a minimum.
%

If a parametrization of the SSD contour and the reference curve is known, the referencing function can be expressed analytically, resulting closed form driving functions specific to the SSD and the referencing contour. 
The following two examples are presented in order to demonstrate the analytical application of the presented driving functions.

The presented referencing approach is not only capable of deriving referencing functions for arbitrary SSD-reference curve geometries, but also allows the analysis of former WFS approaches in the aspect of the positions of amplitude correct synthesis.
These former approaches include traditional WFS, which references the synthesis of a point source to a reference line as discussed via the following example \cite{Berkhout1993:Acoustic_control_by_WFS,  Start1997:phd, Verheijen1997:phd}, and revisited WFS formulation, which applies a target field independent constant referencing function without taking the virtual source dimensionality mismatch into consideration \cite{Spors2008:WFSrevisited}.
The further analysis of the latter approach is not included in the present thesis, a thorough discussion of the topic can be found in \cite{Firtha2016}.

\subsection*{Application example: Synthesis of a 3D point source applying a linear SSD}

As a first example assume an infinite linear SSD located at $\vxo = \posvec{3}{x_0}{0}{0}$.
The reference contour is set to be an infinite line parallel to the SSD, located at $\vxref = \posvec{3}{x}{y_{\mathrm{ref}}}{0}$.
This geometry has a distinctive role in the field of sound field synthesis, being the arrangement for which traditional WFS was first formulated.
Since the driving functions may be derived directly by applying the SPA to the Rayleigh integral describing an arbitrary sound field perfectly in terms of a planar integral, therefore application of a linear SSD involves the least approximations avoiding errors due to the application of the Kirchhoff approximation.
Choosing a reference line parallel to the SSD also ensures a unique reference position for each SSD element.
As a consequence amplitude correct synthesis may be ensured on the entire reference line.
Furthermore, explicit solution can be found for this special geometry as described in the following section.

Evaluation of the 2.5D WFS driving functions \eqref{Eq:SFS_theory:25D_WFS_driv_fun} requires determining the distance  of the reference position on the reference line from the corresponding SSD elements, i.e. equation
\begin{equation}
\vxref(\vxo) = \vxo + \hat{\vk}^P(\vxo) |\vxref(\vxo)-\vxo|
\label{eq:sfs_theory:ref_pos}
\end{equation}
has to be solved for $|\vxref(\vxo)-\vxo|$ termed the \emph{reference distance}.
The terminology indicates that it denotes the distance measured from the SSD elements at which the synthesis is optimized.
For a 2D virtual field, for which $\phi^{''P}_{zz}(\vx) = 0$ the reference distance is the referencing function itself.


\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth ]{Figures/SFS_theory/25D_WFS_linear_SSD.png}
	\small
	\put(0, 0){(a)}
	\put(47,0){(b)}	
	\end{overpic}   
    \caption{2.5D synthesis of a 3D point source located at $\vxs = \posvec{3}{0}{-2}{0}$, radiating at $\omega_0 = 2\pi \cdot 1 \mathrm{krad}/s$ with the reference line set at $y_{\mathrm{ref}} = 1.5~\mathrm{m}$.
    Figure (a) depicts the real part of the synthesized field, (b) shows the error of synthesis.
    Based on the equivalent scattering interpretation of the synthesis the discrepancy between the synthesized field and the virtual field at $y<0$ can be interpreted as the field of a point source reflected from a planar scatterer surface. 
    Due to the problem symmetry the scattered field is given amplitude correctly along $y = - y_{\mathrm{ref}}$.
    }
\label{fig:SFS_theory:25D_WFS_linear_ssd}  
\end{figure}

In the present geometry equation \eqref{eq:sfs_theory:ref_pos} has to be solved so that both $\vxo$ and $\vxref$ are lying along infinite parallel lines.
As a general case assume that the direction of the SSD and reference line are described by the unit vector $\mathbf{v}$ and their normal vector is given by $\mathbf{n}$, with the distance between them being $d$.
From simple geometrical considerations the reference position for a given SSD position
\begin{equation}
\vxref(\vxo) = \vxo + d \mathbf{n} + \mathbf{v} \left< |\vxref(\vxo)-\vxo| \hat{\vk}^P(\vxo) \cdot \mathbf{v} \right>
\end{equation}
must hold.
The reference distance therefor can be expressed by solving 
\begin{equation}
\hat{\vk}^P(\vxo) |\vxref(\vxo)-\vxo| = d \mathbf{n} + \mathbf{v} \left< |\vxref(\vxo)-\vxo| \hat{\vk}^P(\vxo) \cdot \mathbf{v} \right>
\end{equation}
for $|\vxref(\vxo)-\vxo|$.
In the present case $\mathbf{v} = \posvec{3}{1}{0}{0}$, the normal is given by $\mathbf{n} = \posvec{3}{0}{1}{0}$ and $d = y_{\mathrm{ref}}$ and solving the equation for the second coordinate
yields the reference distance
\begin{equation}
|\vxref(\vxo)-\vxo| = \frac{y_{\mathrm{ref}}}{\hat{k}_y^P(\vxo)} = \frac{k}{\phi^{''G}_{zz}(\vxref(\vxo) - \vxo)} .
\end{equation}
Hence the general 2.5D WFS driving function, ensuring amplitude correct synthesis on a reference line reads as
\begin{equation}
D(\vxo, \omega) = 
-\sqrt{\frac{8\pi}{\ti k}}\sqrt{\frac{k}{|\phi^{P''}_{zz}(\vxo)| + \frac{k_y^P(\vxo)}{y_{\mathrm{ref}}}}}
\ti k_y^P(\vxo) 	P(\vxo,\omega).
\end{equation}

For the special case of a virtual point source $|\phi^{P''}_{zz}(\vxo)| = \frac{k}{|\vxo-\vxs|}$ and $k_y^P(\vxo) = k \frac{y_0-y_s}{|\vxo-\vxs|}$ holds and the driving function simplifies to
\begin{equation}
D(\vxo, \omega) =  \frac{1}{4\pi}
\sqrt{\frac{8\pi}{\ti k}}
\sqrt{\frac{y_{\mathrm{ref}}}{y_{\mathrm{ref}} -y_s } }
\ti k y_s \frac{\te^{-\ti k |\vxo-\vxs|}}{|\vxo-\vxs|^{\frac{3}{2}}}.
\label{eq:SFS_theory:WFS_point_source}
\end{equation}
This result is precisely equivalent with the traditional WFS driving function \cite[(2.27)]{Verheijen1997:phd}, \cite[(3.16)\&(3.17)]{Start1997:phd} of a point source, and furthermore identical to the farfield/high-frequency approximated explicit solution presented in the next section \cite[(25)]{Spors10ahrens:analysis}, \cite[Ch. 2.3]{Schultz2016}. 

The result of synthesis is depicted in Figure \ref{fig:SFS_theory:25D_WFS_linear_ssd} confirming, that by applying the derived driving functions amplitude correct synthesis is ensured along the reference line.

\subsection*{Application example: Synthesis of a plane wave applying a circular SSD}

As a second example the synthesis of a plane wave applying a circular SSD with the radius of $R_{\mathrm{SSD}}$ is presented.
The synthesis is referenced to a concentric circle inside the SSD with the radius $R_{\mathrm{ref}}$.
For this geometry the explicit driving functions are also known, which are however not discussed in details in the present thesis.

\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth ]{Figures/SFS_theory/25D_WFS_circular_SSD.png}
	\end{overpic}   
    \caption{2.5D synthesis of a 2D plane wave with the angular frequency $\omega_0 = 2\pi \cdot 1 \mathrm{krad}/s$ propagating into the direction $\vk^{\mathrm{PW}} = \posvec{3}{k_x^{\mathrm{PW}} }{0}{0}$.
    The SSD is a circular one, with the radius $R_{\mathrm{SSD}} = 2~\mathrm{m}$.
    The reference curve is a circle with the radius $R_{\mathrm{ref}} = 1.5~\mathrm{m}$.
    Figure (a) depicts the real part of the synthesized field, (b) shows the error of synthesis.
    }
\label{fig:SFS_theory:25D_WFS_circular_ssd}  
\end{figure}

Again, the system of equations describing the reference distance for each SSD element is given by
\begin{align}
\vxref(\vxo) &= \vxo + \hat{\vk}^P(\vxo) |\vxref(\vxo)-\vxo|
\\
|\vxref(\vxo)| &= R_{\mathrm{ref}}.
\end{align}
Expressing the reference distance leads to a second order equation.
By exploiting that $|\vxo| = R_{\mathrm{SSD}}$, $|\hat{\vk}^P(\vxo)| = 1$ and taking only the smaller root into consideration---corresponding to the closer arc of the reference circle to the actual SSD position---yields the reference distance
\begin{equation}
|\vxref(\vxo)-\vxo| = - R_{\mathrm{SSD}} \left( \hat{k}^P_r(\vxo) + \sqrt{ \hat{k}^P_r(\vxo)^2 + \left( \frac{R_{\mathrm{ref}}}{R_{\mathrm{SSD}}} \right)^2 - 1 } \right),
\label{eq:SFS_theory:pw_circ_ref}
\end{equation}
with $\hat{k}^P_r(\vxo)$ denoting the radial component of the normalized wavenumber vector.
Applying the reference distance to the general 2.5D WFS driving functions \eqref{Eq:SFS_theory:25D_WFS_driv_fun} allows the synthesis of an arbitrary sound field referenced on a reference circle inside the SSD.

Assume the special case of a virtual 2D plane wave, propagating parallel to the synthesis plane described by the wavenumber vector $\vk^{\mathrm{PW}} = \posvec{3}{k_x^{\mathrm{PW}}}{k_y^{\mathrm{PW}}}{0}$.
For a 2D sound field $\phi^{''P}_{zz}(\vxo) = 0$ holds and the reference function is given by the reference distance itself.
In this case the actual form of the driving function reads
\begin{equation}
D(\vxo, \omega) = -w(\vxo) 
\sqrt{\frac{8\pi}{\ti k}}\sqrt{|\vxref(\vxo)-\vxo|}
\ti k_r^{\mathrm{PW}}(\vxo) 	\te^{-\ti \left< \vk^{\mathrm{PW}} \cdot \vxo \right> },
\end{equation}
with the reference distance given by \eqref{eq:SFS_theory:pw_circ_ref}.

The result of synthesis, along with the error of synthesis is depicted in Figure \ref{fig:SFS_theory:25D_WFS_circular_ssd}.

\section{Explicit solution: Spectral Division Method}

The explicit solution for the general SFS problem utilizes compact operator theory by exploiting that integral \eqref{Eq:Theory:3D_SFS} constitutes a compact Fredholm operator with the kernel being the Green's function \cite{Ahrens2012,MorseFeshbach1953}.
Such an operator and the involved acoustic fields can by expanded into the series of orthogonal eigenfunctions of the wave equation on a control surface, that form a complete basis of the solution.
The inverse problem can be straightforwardly solved for the driving function expansion coefficients by a comparison of the corresponding eigenvalues, as long as none of the expansion coefficients of the operator kernel is zero.
Otherwise the problem is termed \emph{ill-conditioned}.
Finally the explicit analytical solution is found for the driving function as an infinite sum of the weighted basis functions.
The method is often referred to as \emph{mode-matching} solutions, since the eigenfunctions of the given geometry are termed the \emph{modes}.

This solution utilizing the single layer potential is unique for general enclosures and also for the---strictly speaking---non-enclosing planar case as shown in \cite{Zotter2013:uniqueness} and \cite{Fazi2010} respectively. In contrary sound field control utilizing the Kirchhoff-Helmholtz formulation would be non-unique on the eigenfrequencies of the enclosure due to resonance phenomena.

The determination of the appropriate eigenfunctions for a general geometry is a tough challenge.
For spherical and circular geometries spherical and circular harmonics form the demanded basis functions. For a rigorous treatment for mode-matching SFS using spherical and circular SSDs see \cite{Ahrens2010phd,Zotter2009phd,Ahrens2012,Ahrens2009:circularSSD_mismatch,Ahrens2009:circular25D_SFR,Ahrens2008:Analytical_Circ_Spherical_SFS,Schultz2014:Comparing_approaches} and \cite{Koyama2014} for the cylindrical solution.
In the present thesis only the planar and linear geometries are investigated in details.
 
\subsection{3D Spectral Division Method}
%For the planar geometry Equation \eqref{Eq:Theory:3D_planar_SFS} is termed a Fredholm-integral of the first kind. Due to the infinite integration limit such integrals are called \emph{singular integrals}, thus not forming a compact operator \cite[p.~921.]{MorseFeshbach1953}. 
%In this case the infinite, non-denumerable eigenvalues of the problem form a continuous function \cite{MorseFeshbach1953,Schultz2014:Comparing_approaches}.
%However, due to the reciprocity of the integration kernel the inverse problem can be solved applying the convolution theorem, utilizing that basically \eqref{Eq:Theory:3D_planar_SFS} describes a continuous convolution along the $y=0$ plane:
Assume an infinite planar SSD along the $y = 0$ plane.
The synthesized field in this geometry is given by a Fredholm-integral of the first kind 
\begin{equation}
P(\vx,\omega) = \iint_{-\infty}^{\infty} D(x_0,z_0,\omega) G(x-x_0,y,z-z_0) \td x_0 \td z_0 = D(x,z,\omega)\ast_{x,z} G(x,y,z,\omega),
\end{equation}
describing a continuous convolution along the SSD plane.
Here $G(x,y,z,\omega)$ denotes the sound field of a secondary source element placed at the origin.

For this geometry the orthogonal basis is given by the continuous set of exponentials, therefore the decomposition of the involved quantities is given by a double Fourier-transform \cite{Ahrens2012, Arfken2005,Schultz2014:Comparing_approaches}, with the physical interpretation of a plane wave decomposition.
Applying the convolution theorem to the angular spectrum representation the convolution may be transformed into a multiplication \cite{Girod2001}:
\begin{equation}
\tilde{P}(k_x,y,k_z, \omega) = \tilde{D}(k_x,k_z, \omega)  \tilde{G}(k_x,y,k_z, \omega).
\end{equation}
%
The expansion coefficient are therefore obtained by a comparison of spectral coefficients and the driving function takes the form:
\begin{equation}
\tilde{D}(k_x,k_z,\omega) = \frac{\tilde{P}(k_x,y,k_z, \omega)}{ \tilde{G}(k_x,y,k_z, \omega)} = 
\frac{\mathcal{F}\left\{ P(\vx,\omega) \right\} }
{  \mathcal{F}\left\{ G(\vx,\omega) \right\} },
\label{Eq:Theory:Dkxkz}
\end{equation}
\begin{equation}
D(x_0,z_0,\omega) = \frac{1}{4\pi^2} \iint_{-\infty}^{\infty} \tilde{D}(k_x,k_z, \omega) \te^{-\ti (k_x x_0 + k_z z_0)} \td k_x \td k_z.
\label{Eq:Theory:Dkx_inverse_Fourier}
\end{equation}
Since the driving function spectrum is yielded by a division in the spectral domain the approach is termed the \emph{Spectral Division Method} \cite{Ahrens2010a, Ahrens2012:Ambisonics_for_planar_linear, Ahrens2011:icassp, Ahrens2010:Ambisonics_w_planar_linear}.

The method does not pose any constraint on the integral kernel. 
Theoretically an arbitrary transfer function may be assigned for the SSD elements: as long the problem is well-conditioned---i.e. the spectrum of the transfer function does not exhibit zeros---unique driving functions may be derived applying the above.

\vspace{3mm}
Substituting the $k_x-k_z$ representation of the 3D Green's function extracted from the \emph{Weyl's integral representation} \cite{Williams1999, Lalor1969} presented in table \ref{tab:theory:Greens_fun_representations} the driving function \eqref{Eq:Theory:Dkx_inverse_Fourier} reads as
\begin{equation}
D(x_0,z_0,\omega) = \frac{1}{4\pi^2} \iint_{-\infty}^{\infty} 2\ti k_y \frac{\tilde{P}(k_x,y,k_z, \omega)}{ \te^{ -\ti k_y  | y |  } } \te^{-\ti (k_x x_0 + k_z z_0)} \td k_x \td k_z.
\end{equation}
with $k_y$ defined as \eqref{eq:theory:k_y_definition} being $k_y = \sqrt{\left( \frac{\omega}{c}\right)^2 - k_x^2 - k_z^2}$ in the propagation region.	
Express the target field by it's spectrum measured along $y = 0$ by extrapolating according to \eqref{Eq:Theory:Wave_field_extrapolation}---i.e. as 
$
\tilde{P}(k_x,y,k_z, \omega) = \tilde{P}(k_x,0,k_z, \omega)  \te^{ -\ti k_y  y }
$
the spectral division can be carried out, with the exponential pressure propagators canceling out, and the driving function becomes independent from the $y$-coordinate. The driving function in the wavenumber domain therefore reads as
\begin{equation}
\tilde{D}(k_x,k_z,\omega) = 2\ti k_y \tilde{P}(k_x,0,k_z,\omega).
\label{Eq:Theory:Planar_explicit_driv_fun}
\end{equation}
Comparison with \eqref{eq:Theory:Fourier_diff} reveals, that multiplication by $k_y$ represents differentiation along the $y$-dimension, i.e.
\begin{equation}
\tilde{D}(k_x,k_z,\omega) = -2 \left. \frac{\partial}{\partial y} \tilde{P}(k_x,y,k_z,\omega) \right|_{y = 0}.
\label{Eq:Theory:Planar_explicit_driv_fun_spatial}
\end{equation}
Straightforwardly, the explicit expression of the driving function in the spatial domain is obtained by the corresponding inverse Fourier-transform according to \eqref{Eq:Theory:Dkx_inverse_Fourier}:
\begin{equation}
D(x_0,z_0,\omega) = -2 \left. \frac{\partial}{\partial y} P(\vx,\omega) \right|_{y = 0}.
\label{Eq:Theory:Planar_explicit_driv_fun_spatial}
\end{equation}

The planar SDM driving function are therefore completely equivalent to that of the implicit solution, in a planar geometry provided by the Rayleigh integral.
The coincidence of the explicit and implicit driving functions is a consequence of the uniqueness of the problem in the present geometry.
It is also indirectly proven above, that the wavefield extrapolation equations are the spectral domain representations of the Rayleigh integrals.
 
\subsection*{Application example: Synthesis of a 3D point source using a planar SSD}

\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/SFS_theory/Planar_SDM.png}
	\small
	\put(0, 0){(a)}
	\put(47,0){(b)}
	\end{overpic}
\caption{
Synthesis of a virtual point source using a planar SSD based on SDM driving functions.
The SSD is located at $\vxo = [x_0,\ 0,\ z_0]^{\mathrm{T}}$, denoted by a solid black line. 
The virtual source is located at $\vxs = [0,\ -2,\ 0]^{\mathrm{T}}$ oscillating at $\omega_0 = 2\pi \cdot 1 ~\mathrm{krad/sec}$.
The figures depict the real part of the synthesized field (a) and the deviation from the target sound field (b) measured at $z=0$.}
	\label{Fig:Theory:monopole_synthesis_by_planar_SDM}
\end{figure}

Assume a 3D virtual point source located at $\vxs = \posvec{3}{x_s}{y_s}{z_s}$, with $y_s<0$, i.e. behind the SSD plane, which is located at $\vxo = \posvec{3}{x_0}{0}{z_0}$.
The wavenumber domain representation of the driving function is obtained by substituting the angular spectrum of the virtual point source---applying the Fourier-shift theorem---into either \eqref{Eq:Theory:Dkxkz} or directly into \eqref{Eq:Theory:Planar_explicit_driv_fun}:
\begin{equation}
\tilde{D}(k_x,k_z,\omega) =  \frac{-\frac{\ti}{2} \frac{ \te^{-\ti k_y | y - y_s|} }{ k_y} \te^{\ti (k_x x_s +k_z z_s)} }{-\frac{\ti}{2} \te^{-\ti k_y | y |} / k_y   } = \te^{-\ti k_y |y_s|}\te^{\ti (k_x x_s +k_z z_s)}.
\label{Eq:Theory:Monopole_SDM_planar_driv_fun}
\end{equation}
The double inverse Fourier-transform may be carried out analytically, by taking the $y$-derivative of the Weyl's integral representation of a 3D point source (See \cite[(2.65)]{Williams1999}):
\begin{equation}
\frac{\partial}{\partial y} G(\vxo - \vxs,\omega ) = 
\frac{1}{4\pi^2} \iint_{-\infty}^{\infty} -\frac{1}{2} \te^{ -\ti k_y  | y - y_s |  }
\te^{\ti (k_x x_s + k_z z_s)} \te^{-\ti (k_x x_0 + k_z z_0)} \td k_x \td k_z,
\label{Eq:Theory:Weyls_derivative}
\end{equation}
Comparing \eqref{Eq:Theory:Monopole_SDM_planar_driv_fun} and \eqref{Eq:Theory:Weyls_derivative} it is revealed, that the driving function in the spatial domain is given by
\begin{equation}
D(x_0,z_0,\omega) = -2 \frac{\partial}{\partial y} \left. G(\vxo - \vxs,\omega )\right|_{y = 0} = -\frac{y_s}{2\pi} \left( \frac{1}{|\vxo-\vxs|} + \ti k\right) \frac{\te^{-\ti k |\vxo-\vxs|}}{|\vxo-\vxs|^2},
\end{equation}
which is in agreement with equation \eqref{Eq:Theory:Planar_explicit_driv_fun_spatial}.

The result of synthesizing a steady-state point source is illustrated in Figure \ref{Fig:Theory:monopole_synthesis_by_planar_SDM}. In the target sound field perfect synthesis is achieved, as it is indicated in Figure \ref{Fig:Theory:monopole_synthesis_by_planar_SDM} (b) depicting the difference between the synthesized and the target sound field. 
Obviously, the figure also presents the result of 3D WFS of a spherical wave without applying the high-frequency gradient approximation.
%Since in this case the SSD is a quasi-enclosing surface, the equivalent scattering interpretation of the synthesis---detailed in the next section---holds. The image of discrepancy therefore depicts the scattering of a point source from an infinite sound soft plane. 


\subsection{2.5D Spectral Division Method}

Assume an infinite linear set of point sources, located at $\vxo = \posvec{3}{x_0}{0}{0}$.
The synthesized field in this arrangement reads as
\begin{equation}
P(x,y,z,\omega) = \int_{-\infty}^{\infty} D(x_0,\omega) G(x-x_0,y,z,\omega) \td x_0.
\end{equation}
Similarly to the planar case the basis functions for a linear SSD are given by exponentials:
by realizing that the above equation is a convolution along the $x$-axis, the convolution is transformed into a multiplication by means of a forward Fourier-transform
\begin{equation}
\tilde{P}(k_x,y,z, \omega) = \tilde{D}(k_x,\omega)\tilde{G}(k_x,y,z, \omega).
\end{equation}
The driving function spectra is then obtained as a spectral ratio
\begin{equation}
\tilde{D}(k_x,\omega) = \frac{\tilde{P}(k_x,y,z, \omega)}{\tilde{G}(k_x,y,z, \omega)} = \frac{\mathcal{F}_x\left\{ P(\vx,\omega) \right\}}{\mathcal{F}_x\left\{ G(\vx,\omega) \right\}},
\label{Eq:SFS_Theory:LinearSDM_spectral}
\end{equation}
and the frequency domain driving function therefore reads as
\begin{equation}
D(x_0,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \frac{\tilde{P}(k_x,y,z, \omega) }{\tilde{G}(k_x,y,z, \omega)} \te^{-\ti k_x x_0} \td k_x.
\label{Eq:Theory:LinearSDM1}
\end{equation}

Again, theoretically the transfer function may describe the field of an arbitrary sound source, as long as it does not exhibit zeros in order to keep the problem well-conditioned.
%When applying 3D point sources as SSD elements the Fourier-transform coefficients of the Green's function is given in \ref{tab:theory:Greens_fun_representations} and the driving function takes the form
%\begin{equation}
%D(x_0,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \frac{\tilde{P}(k_x,y,z, \omega) }{-\frac{\ti}{4} H_0^{(2)}\left( \sqrt{ \left( \frac{\omega}{c} \right)^2 - k_x^2 } \sqrt{ y^2 + z^2 } %\right)} \te^{-\ti k_x x_0} \td k_x.
%\end{equation}

\vspace{3mm}
Unlike the planar case the present driving function contains both $y$ and $z$ positions, thus the driving function depends on the listener position: Equation \eqref{Eq:Theory:LinearSDM1} may be solved only for positions on the surface of a cylinder with fixed radius $d = \sqrt{y^2 + z^2}$ \cite[p.~60.]{Ahrens2010phd}.
This is a direct consequence of the fact, that the pressure of an arbitrary 3D sound field measured on the SSD does not determine completely the pressure on the reference line---and vice versa---.
Furthermore an infinite line source---i.e. the SSD---can only radiate wavefronts with cylindrical symmetry as it was discussed in details in \ref{sec:greens_function_spectrum},
therefore phase correct synthesis may be assured only in a plane containing the SSD in which the radial wavenumber of the synthesized field and the target field coincide. 
Amplitude correct synthesis is assured in this plane at a distance $\dref = \sqrt{y^2 + z^2}$ for which driving functions are calculated.

For practical applications we choose the horizontal plane $z=0$ for the plane of synthesis, reference the driving functions to the \emph{reference line}, by setting $y = \yref$ and require that for the virtual field $k_z(x,y,0) = 0$ holds.
The driving function thus reads as
\begin{equation}
D(x_0,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \frac{\tilde{P}(k_x,\yref,0, \omega) }{\tilde{G}(k_x,\yref,0, \omega)} \te^{-\ti k_x x_0} \td k_x.
\label{Eq:Theory:Linear_SDM}
\end{equation}
In this geometry amplitude correct synthesis is restricted to the reference line.

\vspace{3mm}
It is worth noting that the analytic Fourier-transform coefficients of the target sound field are available only for limited simple virtual source models. 
Even in these cases the inverse transform of the driving functions rarely can be evaluated analytically, therefore numerical transforms are needed.
For a practical and optimized implementation of the SDM for an arbitrary target sound field refer to \cite{ahrens2013a:efficientSDM}.

\subsection*{Application example: Synthesis of a 3D point source using a linear SSD}

\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figures/SFS_theory/Linear_SDM.png}
	\footnotesize
	\put(0, 0){(a)}
	\put(45,0){(b)}
	\end{overpic}
\caption{Synthesis of a virtual point source using a linear SSD applying the SDM driving functions.
The SSD is located at $\vxo = [x_0,\ 0,\ 0]^{\mathrm{T}}$, denoted by a solid black line. 
The virtual source is located at $\vxs = [0,\ -2,\ 0]^{\mathrm{T}}$ oscillating at $\omega_0 = 2\pi \cdot 1000 ~\mathrm{rad/sec}$. 
The reference line was set to $\yref = 1.5~\mathrm{m}$.
The figure depicts the synthesized field at the synthesis plane ($z = 0$) with (a) depicting the real part of the synthesized field, (b) depicting the error of synthesis.}
	\label{Fig:Theory:monopole_synthesis_by_linear_SDM}
\end{figure}

As an example for the 2.5D explicit driving functions the synthesis of a 3D point source, positioned at $\vxs = \posvec{3}{x_s}{y_s}{0}$, with $y_s<0$ is presented. 
The SSD is a linear one, located at $\vxo = \posvec{3}{x_0}{0}{0}$
The explicit driving function for a linear SSD is given by \eqref{Eq:Theory:Linear_SDM}. 
Substituting the spectra of the virtual and the secondary point sources as given in table \ref{tab:theory:Greens_fun_representations}, with applying the Fourier-shift theorem the driving function 
is given as
\begin{equation}
\hat{D}(k_x,\omega) = 
\frac{ -\frac{\ti}{4} H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - k_x^2} |\yref - y_s| \right)  \te^{\ti k_x x_s} }
     { -\frac{\ti}{4} H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - k_x^2} |\yref|       \right)  }
,
\end{equation}
and in the spatial domain as
\begin{equation}
\label{Eq:Theory:SDM_point_source}
D(x_0,\omega) = \frac{1}{2\pi} \int_{-\infty}^{\infty} 
\frac{  H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - k_x^2} |\yref - y_s| \right)  }
     {  H_0^{(2)} \left( \sqrt{ \left(\frac{\omega}{c}\right)^2 - k_x^2} |\yref|       \right)  }
\te^{- \ti k_x (x_0 - x_s)}
\td k_x.
\end{equation}
The synthesized field using this driving function is depicted in \ref{Fig:Theory:monopole_synthesis_by_linear_SDM} (a). 
As it can be seen from Figure (b) displaying the deviation of the synthesized field from the target field, application of the explicit driving function ensures perfect synthesis on the reference line. 
In other parts of the space amplitude errors are present.

As discussed in \cite{Spors10ahrens:analysis} the derived driving function spectrum can be simplified by applying the large-argument/asymptotic approximation of the Hankel function, given by \eqref{Eq:HF_approx:Hankel_asymptotic_form}.
The asymptotic form gives a fair approximation for \eqref{Eq:Theory:SDM_point_source} if $k_y |\yref| \gg 1$ holds (since $\yref-y_s> \yref$), which is valid in the far field of the SSD in front of the virtual source, where $k_y \gg k_x$ dominates the inverse transform.
Applying the Hankel's function approximation the inverse transform can be carried out analytically, resulting in
\begin{equation}
D(x_0,\omega) \approx \frac{1}{2} \sqrt{\frac{\yref}{\yref-y_0}} \ti \frac{\omega}{c} \frac{y_0}{|\vxo-\vxs|} H_1^{(2)}\left( \frac{\omega}{c} |\vxo-\vxs| \right)
\end{equation}
as given by \cite[(24)]{Spors10ahrens:analysis}.
By a further large-argument approximation of the Hankel function returns the 2.5D WFS driving function for a 3D point source referencing the synthesis on a reference line, given by \eqref{eq:SFS_theory:WFS_point_source}.
The equivalence of the SDM and 2.5D WFS referencing the synthesis of a virtual plane wave on a reference line was further discussed in \cite{Firtha2016, Schultz2016:DAGA,Schultz2016}.
The general relation of the explicit solution and 2.5D WFS is discussed in the following section.

\subsection{Approximate explicit solution in the spatial domain}

As discussed in \ref{Sec:SPA_for_Fourier} the stationary phase approximation allows the evaluation of forward and inverse Fourier integrals	around stationary positions in the spatial and spectral domain.
In the followings the SPA is employed in order to give an approximate formulation for the 2.5D explicit driving functions purely in the spatial domain.
The derivation consists of two main steps
\begin{itemize}
%
\item First the spectral driving functions are expressed in an asymptotic form. 
The calculus can be done by assuming, that the involved spectra are obtained via the SPA of the corresponding forward Fourier-transforms. 
This step links the spectral coefficients to stationary positions in the spatial domain.
%
\item It is followed by the inverse Fourier transform of the asymptotic spectral driving functions.
The evaluation of the inverse transform with the SPA relates the forward transform stationary positions to positions along the SSD.
\end{itemize}

\subsubsection{Asymptotic approximation of the explicit driving functions}

The derivation starts from the 2.5D explicit driving functions in the wavenumber domain given by \eqref{Eq:SFS_Theory:LinearSDM_spectral}
\begin{equation}
\tilde{D}(k_x,\omega) = \frac{\tilde{P}(k_x,y,0, \omega)}{\tilde{G}(k_x,y,0, \omega)},
\end{equation}
ensuring perfect synthesis along a line with fixed $y$-coordinate.
In the following for the sake of brevity and transparency $\omega$ and $z$ dependency is suppressed, the latter since the driving functions are defined at $z=0$.
By definition the wavenumber content of the involved quantities is obtained via a forward Fourier transform, with the involved sound fields expressed by their polar form
\begin{align} 
\hat{P}(k_x,y) = \int\limits_{-\infty}^{\infty} A^P(x,y) \, \te^{\ti \phi^P(x,y)} \, \te^{\ti k_x x} \td x, \\
\hat{G}(k_x,y) = \int\limits_{-\infty}^{\infty} A^G(x,y) \, \te^{\ti \phi^G(x,y)} \, \te^{\ti k_x x} \td x.
\end{align}
It is assumed, that the involved spectra are obtained by using the SPA:
under high-frequency assumptions the Fourier integrals may be approximated by evaluation around their stationary point $x^*_P(k_x)$ and $x^*_G(k_x)$, where their phase derivative vanishes, i.e.
the stationary positions are defined as
\begin{align}
\label{eq:xP_xG_in_spatial_domain}
\left. \frac{\partial}{\partial x} \left(  \phi^P(x,y) + k_x x \right )\right|_{x =x^*_P(k_x)} = 0
\hspace{3mm} &\rightarrow \hspace{3mm}
k_x^P(x^*_P(k_x),y) = k_x \nonumber
\\ 
\left. \frac{\partial}{\partial x} \left(  \phi^G(x,y) + k_x x \right )\right|_{x =x^*_G(k_x)} = 0
\hspace{3mm} &\rightarrow \hspace{3mm}
k_x^G(x^*_G(k_x),y) = k_x.
\end{align}
Again, since it is assumed, that $k_z^P(x,y) = k_z^G(x,y) = k_z = 0$ holds in the plane of investigation, therefore the stationary positions are found along a given $y$, where the local propagation direction of the virtual field and the Green's function matches to that of the spectral plane wave, defined by $k_x$.
The properties of the involved wave fields at these positions will dominate the corresponding Fourier integrals.
Hence, the forward transform defines two particular positions in the space, linked together via the actual spectral wavenumber.
Note, that it is assumed, that in the virtual sound field each local propagation direction is unique, i.e. a unique stationary position can be found.
This statement trivially does not hold even in the simplest case of a virtual plane wave.
The final result of the derivation however may be applied for such virtual fields without any modification.

Having defined the stationary positions, the forward Fourier transforms can be evaluated by the SPA. 
With accounting for the negative second phase-derivatives---since both the virtual sound field and the Green's function are diverging--- their spectra can be approximated as \cite[Ch. 5]{Tracy2014}
\begin{align}
\hat{P}(k_x,y) \approx& \sqrt{\frac{2\pi}{\ti \, |\phiPxx(x^*_P(k_x),y)|}} A^P(x^*_P(k_x),y) \, \te^{\ti \phi^P(x^*_P(k_x),y)} \, \te^{\ti k_x \cdot x^*_P(k_x)},\\
\hat{G}(k_x,y) \approx& \sqrt{\frac{2\pi}{\ti \, |\phiGxx(x^*_G(k_x),y)|}} A^G(x^*_G(k_x),y) \, \te^{\ti \phi^G(x^*_G(k_x),y)} \, \te^{\ti k_x \cdot x^*_G(k_x)}.
\end{align}
The asymptotic approximation of the SDM driving functions on a given spectral component therefore reads
\begin{equation}
\label{eq:hfapproxspectra}
\hat{D}(k_x,y)
\approx  
\sqrt{\frac{|\phi_{G,xx}''(x^*_G(k_x),y)|}{|\phi_{P,xx}''(x^*_P(k_x),y)|}}
\, \frac{P(x^*_P(k_x),y)}{G(x^*_G(k_x),y)}
\, \te^{\ti k_x \cdot \left( x^*_P(k_x) - x^*_G(k_x)\right)}.
\end{equation}

\subsubsection{Explicit driving functions in the spatial domain}

Using the asymptotic approximation of the SDM spectrum the spatial driving functions are obtained via an inverse spatial Fourier transform:
%
\begin{equation}
\label{Eq:inverse_transform_def}
D(x_0,y)
=  \frac{1}{2\pi} \int\limits_{-\infty}^{\infty}
\sqrt{\frac{|\phi_{G,xx}''(x^*_G(k_x),y)|}{|\phi_{P,xx}''(x^*_P(k_x),y)|}} 
\frac{P(x^*_P(k_x),y)}{G(x^*_G(k_x),y)}
\,\te^{\ti k_x \cdot\left( x^*_P(k_x) - x^*_G(k_x)\right)}
\,\te^{-\ti k_x x_0} \td k_x
.
\end{equation}
Again, the integral is approximated using the SPA, with the phase function under investigation given by
\begin{equation}
\label{Eq:inverse_transform_phase_function}
{\Phi}(k_x) = \phi^P[x^*_P(k_x),y] -  \phi^G[x^*_G(k_x),y] +  k_x \, x^*_P(k_x) - k_x\, x^*_G(k_x) -  k_x x_0.
\end{equation}
%
As it was discussed in \ref{Sec:SPA_for_Fourier}, generally speaking in the inverse transform of an arbitrary wave field $P$ each wavenumber component $k_x$ will dominate one spatial position $x_0$, where the actual wavenumber component $k_x(x_0)$ coincides with the local wavenumber of the sound field $k_x^P(x_0)$.
For the present case this wavenumber is found as the stationary phase wavenumber $k_x^*(x_0)$ of integral \eqref{Eq:inverse_transform_def} \cite{Tracy2014}.

The derivative of the spectral phase function \eqref{Eq:inverse_transform_phase_function} can be evaluated by applying the chain rule, resulting in
\begin{multline}
\label{eq:spectral_phase_first_derivative}
\frac{\partial}{\partial k_x}\Phi(k_x) = \\ 
  x^{*'}_{P,k_x}(k_x) \underbrace{ \left( \phi^{P'}_x[x^*_P(k_x),y]  + k_x \right)}_{ = 0} 
- x^{*'}_{G,k_x}(k_x) \underbrace{ \left( \phi^{G'}_x[x^*_G(k_x),y]  + k_x \right) }_{ = 0} 
+x^*_P(k_x)- x^*_G(k_x) -  x_0,
\end{multline}
where $x^{*'}_{k_x}(k_x)$ is the rate of change of the forward transform stationary positions with respect to the change of the spectral wavenumber, and the bracketed terms cancel out according to the definition of the stationary points \eqref{eq:xP_xG_in_spatial_domain}.
The stationary wavenumber $k_x^*(x_0)$ is then found where
\begin{equation}
\label{eq:xP_xG_in_spectral_domain}
\left. \frac{\partial}{\partial k_x}\Phi(k_x) \right|_{k_x=k_x^*(x_0)} = x^*_P(k_x^*(x_0))- x^*_G(k_x^*(x_0)) -  x_0 = 0
\end{equation}
holds.
This definition relates the evaluation points $x^*_P$ and $x^*_G$ directly to the actual SSD coordinate $x_0$, therefore the intermediate stationary wavenumber ($k_x^*$) dependency may be omitted i.e. $x^*_P(k_x^*(x_0)) \rightarrow x^*_P(x_0)$ and $x^*_G(k_x^*(x_0)) \rightarrow x^*_G(x_0)$ may be written. 

The definitions for the forward and inverse transform stationary points \eqref{eq:xP_xG_in_spatial_domain} and \eqref{eq:xP_xG_in_spatial_domain} completely define the evaluation points $x^*_P$,$x^*_G$ for a given SSD position $x_0$ independently of the spectral wavenumber:
by expressing \eqref{eq:xP_xG_in_spatial_domain} with \eqref{eq:xP_xG_in_spectral_domain} for and arbitrary $x_0$ position the evaluation points along a fixed $y$ is found, where
%
\begin{align} 
\label{Eq:stationary_evaluation_points}
k_{x}^P(x^*_P(x_0),y) = k_{x}^G(x^*_P(x_0) - x_0,y),
\end{align}
is satisfied.
This results states, that \emph{for a given SSD coordinate $x_0$ the evaluation point $x^*_P$ is found on the reference line, where the local propagation direction of the target field $P$ coincides with that of a point source positioned at $\posvec{3}{x_0}{0}{0}$ measured on the reference line}. 
For an illustration refer to Figure \ref{fig:SFS_theroy:explicit_sol_stationary_points}.
%
\begin{figure}[t!]
\small
  \begin{minipage}[c]{0.58\textwidth}
%  \hspace{1cm}
	\small
%	\centering
%	\hspace{-30mm}
	\begin{overpic}[width = \textwidth ]{Figures/SFS_theory/explicit_sol_stationary_point.png}
	\put(96,30){$x$}
	\put(15,80){$y$}
	\put(79.5,29.5){$x^*_P(x_0)$}
	\put(62.5,29.5){$x_0$}
	\put(52,72){$\vk^P(x^*_P,y) = \vk^G(x^*_P-x_0,y)$}
	\end{overpic}  \end{minipage}\hfill
	\begin{minipage}[c]{0.4\textwidth}
    \caption{
       Illustration of the evaluation position $x^*_P(x_0)$ (and $x^*_G(x_0)$) as the function of $x_0$. 
	   For a given SSD position $x_0$ the stationary positions is found on a given reference line $y=\text{const}$, where the virtual field propagation direction coincides with that of the Green's function translated into $x_0$. 
	   At $x^*_P(x_0)$ the local curvature of the translated Green's function is always greater, than that of the virtual field.
       } 
       \label{fig:SFS_theroy:explicit_sol_stationary_points}.
  \end{minipage}
\end{figure}
%

Having found the stationary position for \eqref{Eq:inverse_transform_def} in order to apply the SPA one still needs the phase function's second derivative around the stationary position and its sign.
The second derivative is obtained by a further differentiation of \eqref{eq:spectral_phase_first_derivative} with respect to $k_x$ leads to
\begin{multline}
\frac{\partial^2}{\partial k_x^2}\Phi(k_x) = 
  x^{*''}_{P,k_x k_x}(k_x) \underbrace{ \left( \phi^{P'}_x[x^*_P(k_x),y]  + k_x \right)}_{ = 0} + 
  x^{*'}_{P,k_x}(k_x) \left( x^{*'}_{P,k_x}(k_x) \phi^{P''}_{xx}[x^*_P(k_x),y]  +2  \right)  -\\
- x^{*''}_{G,k_x k_x}(k_x) \underbrace{ \left( \phi^{G'}_x[x^*_G(k_x),y]  + k_x \right) }_{ = 0} 
- x^{*'}_{G,k_x}(k_x) \left( x^{*'}_{G,k_x}(k_x)  \phi^{G''}_{xx}[x^*_G(k_x),y]  + 2\right).
\end{multline}
The required rate of change of the stationary positions ($x^{*'}_P(k_x)$ and $x^{*'}_G(k_x)$) the second derivative can be obtained by differentiating equations \eqref{eq:spectral_phase_first_derivative} with respect to $k_x$, resulting in
\begin{equation}
x^{*'}_{P,k_x}(k_x) = -\frac{1}{\phi^{P''}_{xx}[x^*_P(k_x),y]}, \hspace{5mm} x^{*'}_{G,k_x}(k_x) = -\frac{1}{\phi^{G''}_{xx}[x^*_G(k_x),y]}.
\end{equation}
Thus the second derivative is given by
\begin{equation}
\label{eq:SFS_theory:second_Derivative_2}
\frac{\partial^2}{\partial k_x^2}\Phi(k_x) = 
\frac{\phi^{P''}_{xx}[x^*_P(k_x),y] - \phi^{G''}_{xx}[x^*_G(k_x),y]}{\phi^{P''}_{xx}[x^*_P(k_x),y] \, \phi^{G''}_{xx}[x^*_G(k_x),y]}.
\end{equation}
The second derivatives describe the curvature of the wavefront along the $x$-direction, as given by \eqref{Eq:App:Hessian_inplane}, being maximal in absolute value for a point source.
Obviously, for any source distribution behind the SSD the wavefront curvature is smaller at $y>0$ than the curvature of the stationary SSD element's wavefront, i.e.
\begin{equation}
\phiPxx(x^*_P(k_x),y) > \phiGxx(x^*_G(k_x),y)
\end{equation}
holds and the sign of \eqref{eq:SFS_theory:second_Derivative_2} is positive. 

These results now may be substituted back into the SPA \eqref{Eq:SPAResult} of the inverse transform \eqref{Eq:inverse_transform_def}.
For the sake of brevity in the followings the evaluation point is denoted by $x^*_P \rightarrow x^*$. 
Denoting the stationary position by $\vxref(\vxo) = \posvec{3}{x^*(x_0)}{y}{0}$ the resulting driving function is formulated as
\begin{equation}
\label{eq:SFS_theory:spatial_sdm}
D(x_0) =
\sqrt{\frac{ \left| \phiGxx(\vxref(\vxo)-\vxo )\right|^2}{\left| \phiPxx(\vxref(\vxo)) - \phiGxx(\vxref(\vxo)-\vxo)\right|}}
\sqrt{\frac{\ti}{2\pi}} 
\frac{P(\vxref(\vxo))}{G(\vxref(\vxo)-\vxo)},
\end{equation}
where $k_x^P(\vxref(\vxo)) = k_x^G(\vxref(\vxo)-\vxo)$ holds.
This result states, that an arbitrary sound field may be synthesized by finding the positions along the reference line, where the propagation direction/wavefront of the target field matches the field of the actual SSD elements.
In this stationary position the driving functions are obtained by the ratio of the target field and the actual SSD element, corrected by the factor, containing the wavefront curvatures at the same position.
Therefore the explicit, global solution can be approximated by simple local wavefront matching.

Expressing the second derivatives in terms of the principal radii according to \eqref{Eq:App:Hessian_inplane} and exploiting, that by definition $ \hat{k}_y^{G}(\vxref(\vxo)-\vxo) = \hat{k}_y^{P}(\vxref(x_0))$ holds the driving function can be cast into the form
\begin{equation}
\label{eq:SFS_theory:spatial_sdm_2}
D(x_0) =
\underbrace{\sqrt{\frac{\rho^P(\vxref(\vxo))}{\rho^P(\vxref(\vxo))-\rho^G(\vxref(\vxo)-\vxo) }}}_{{\substack{\text{virtual source}\\\text{compensation}}}}
\underbrace{ \sqrt{\frac{\ti k}{2\pi \rho^G(\vxref(\vxo)-\vxo)}} }_{{\substack{\text{SSD}\\\text{compensation}}}}
\underbrace{\frac{\hat{k}_y^{P}(\vxref(x_0))P(\vxref(\vxo))}{G(\vxref(\vxo)-\vxo)}}_{\substack{\text{2D explicit}\\\text{driving function}}},
\end{equation}
with $\rho^P$ and $\rho^G$ being the principal radii of the target field and the Green's function along the horizontal direction normalized by $k$.
The formulation implies the fact, that similarly to the implicit solution, the explicit driving functions also applies the derivative of the target field, measured on the reference position.
Furthermore, the driving function explicitly contains the SSD compensation factor presented in \eqref{Eq:SFS_theory:25D_WFS_driv_fun_ver_2}, correcting the applied 3D SSD elements to 2D ones.
The virtual source compensation factor is the reciprocal of that, presented for the implicit solution, given by $\sqrt{ \rho^P(\vxref)/\rho^P(\vxo) }$.

One important fact is pointed out here: although having derived the above driving functions in terms of a forward an inverse spatial Fourier transform along a straight line, there is no restriction on the $y$-coordinate of the stationary point in \eqref{eq:SFS_theory:spatial_sdm} due to the local approximations involved: the $y$-coordinate might be $x_0$-dependent.
This means, that an arbitrary referencing curve may be defined as $\vxref(x_0)$, and the driving functions can be calculated by finding the stationary positions 
satisfying $k_x^P(\vxref(x_0)) = k_x^G(\vxref(x_0) - \vx_0)$ along this curve.
Evaluating the driving functions in the stationary positions will result in amplitude correct synthesis along the reference curve. 
This means, that the presented driving functions are equivalent to the 2.5D WFS driving functions with the important difference that here the target field needs to be evaluated on the reference curve.
Furthermore, within the validity of the Kirchhoff-approximation also the SSD has to be not necessarily linear: the spatial explicit driving functions can be applied using an arbitrary shaped SSD contour.
Obviously in that case \eqref{eq:SFS_theory:spatial_sdm_2} has to be evaluated with $\hat{k}_y^{P}(\vxref(x_0)) \rightarrow \hat{k}_{\mathrm{n}}^{P}(\vxref(x_0))$, i.e. with the wavenumber component along the normal of the actual SSD element.
Similarly the second derivatives in \eqref{eq:SFS_theory:spatial_sdm} have to be evaluated along the direction, defined by the actual SSD element.

In the followings first a simple example is presented in order to demonstrate the validity of the spatial SDM driving functions.

\subsection*{Application example: Synthesis of a 3D point source using a linear SSD}

Consider the synthesis of a 3D point source at $\vxs = [x_s,\ y_s,\ 0]^{\mathrm{T}}$ with $y_s < 0$, referencing the synthesis to a circle around the virtual point source with the radius of $R_{\mathrm{ref}}$.
The linear SSD is located at $\vxo = \posvec{3}{x_0}{0}{0}$.
Along with the equation describing the reference curve $\vxref(x_0) = \posvec{3}{x^*(x_0)}{y^*(x_0)}{0}$ the stationary points satisfy the following equations
\begin{align}
\vk^G(\vxref(\vxo)-\vxs) &= \vk^G(\vxref(\vxo)-\vxo), \\
|\vxref - \vxs|    &= R_{\mathrm{ref}}.
\end{align}
The~solution for the equations is given by
\begin{align}
\label{Eq:SFS_theory:spatial_SDM_circle_ref_points}
\vxref(\vxo) = \vxs + R_{\mathrm{ref}}\frac{\vxo-\vxs}{|\vxo-\vxs|}.
\end{align}
Substituting the spherical virtual field into \eqref{eq:SFS_theory:spatial_sdm_2}---with the principal radii given by simple distances from the point sources--- yields the explicit driving function in the spatial domain for a virtual point source.
\begin{equation}
D(x_0) =
\sqrt{\frac{|\vxref-\vxs|}{|\vxref-\vxs|-|\vxref-\vxo| }}
\sqrt{\frac{\ti k}{2\pi |\vxref-\vxo|}} 
\hat{k}_y^G(\vxref(\vxo)-\vxs)
\frac{G(\vxref(\vxo)-\vxs)}{G(\vxref(\vxo)-\vxo)}
\end{equation}
Substituting the reference position coordinates along the reference circle \eqref{Eq:SFS_theory:spatial_SDM_circle_ref_points} specifies the the driving functions optimizing the synthesis on the reference circle
\begin{equation}
D(x_0) =-y_s
\sqrt{\frac{R_{\mathrm{ref}}-|\vxo-\vxs|}{R_{\mathrm{ref}}}}
\sqrt{\frac{\ti k }{2\pi}} 
\frac{\te^{-\ti k |\vxo-\vxs|}}
{ |\vxo-\vxs|^{\frac{3}{2}} }.
\end{equation}
%
\begin{figure}
\centering
	\begin{overpic}[width = 1\columnwidth ]{Figures/SFS_theory/25D_spatial_SDM_linear_SSD.png}
	\end{overpic}   
    \caption{2.5D synthesis of a 3D point source located at $\vxs = \posvec{3}{0}{-2}{0}$, radiating at $\omega_0 = 2\pi \cdot 1 \mathrm{krad}/s$.
	The synthesis is referenced on a circle around the virtual source, with a radius of $R_{\mathrm{ref}} = 4 ~ \mathrm{m}$.
    Figure (a) depicts the real part of the synthesized field, (b) shows the error of synthesis.
    }
\label{fig:SFS_theory:25D_spatial_SDM_linear_ssd}  
\end{figure}
Investigating Figure \ref{fig:SFS_theory:25D_spatial_SDM_linear_ssd} verifies, that the synthesis is optimized on the prescribed reference curve.


\section{Relation of implicit and explicit solutions}

Finally, utilizing the high-frequency spatial explicit driving functions \eqref{eq:SFS_theory:spatial_sdm} the general relationship between the explicit and implicit solutions is highlighted.
This is done by expressing the target field at the reference point by a 3D Neumann Rayleigh integral, approximated by the SPA along all dimensions.
\begin{equation}
P(\vx,\omega) = 2 \iint_{-\infty}^{\infty} \ti k_y^P(\vxo) P(\vxo,\omega) G( \vx - \vxo ) \td \vxo.
\end{equation}
As discussed in \ref{Sec:HS_approx:SPA_for_Rayleigh}, the stationary position on the Rayleigh plane $\vxo^*(\vx)$ is found, where
\begin{equation}
\label{Eq:SFS_theory:Rayleigh25D_horizontal_stat_point}
k_{x}^P(\vxo^*(\vx)) = k_{x}^G( \vx - \vxo^*(\vx))
\end{equation}
holds, with $\vx = \posvec{3}{x}{y}{0}$ and $\vxo^*(\vx) = \posvec{3}{x_0^*(x)}{0}{0}$, since the vertical stationary point trivially remains at $z=0$. 
Accounting for the negative second derivatives for a diverging field, around the stationary point the the asymptotic approximation of the 3D Rayleigh integral reads
\begin{multline}
\label{Eq:Asymptotic_Rayleigh_integral}
P(\vx) \approx 
-2 \frac{2\pi}{\ti}
\frac{1}{\sqrt{ \left| \phiPzz(\vxo^*(\vx)) + \phiGzz(\vx-\vxo^*(\vx)) \right| }}  
\frac{1}{\sqrt{ \left| \phiPxx(\vxo^*(\vx)) + \phiGxx(\vx-\vxo^*(\vx)) \right| }}  \times
\\ 
\left. \frac{ \partial P(\vx)}{\partial y}\right|_{\vx = \vxo^*(\vx)} G(\vx-\vxo^*(\vx)),
\end{multline}
or written in terms of the principal radii (and applying the high-frequency gradient approximation, in order to simplify by $k_y^P(\vx^*(\vxo))$)
\begin{equation}
\label{Eq:Rayleigh_integral_approx}
P(\vx) \approx 
4\pi
\sqrt{ \frac{\rho^P_1(\vxo^*) \rho^G_1(\vx-\vxo^*)}{\rho^P_1(\vxo^*) + \rho^G_1(\vx-\vxo^*)} }
\sqrt{ \frac{\rho^P_2(\vxo^*) \rho^G_2(\vx-\vxo^*)}{\rho^P_2(\vxo^*) + \rho^G_2(\vx-\vxo^*)} }
P(\vxo^*(\vx)) G(\vx-\vxo^*(\vx)),
\end{equation}

\vspace{3mm}
In order to express \eqref{eq:SFS_theory:spatial_sdm} in terms of the involved quantities measured along the SSD, one still needs to express the second derivative of the target field's phase $\phiPxx(\vx)$ at an arbitrary receiver position $\vx$ in terms of the second derivative taken on the SSD at the stationary point $\phiPxx(\vxo^*(\vx))$.
This is possible by expressing the second derivative of the asymptotic Rayleigh integral's phase function \eqref{Eq:Asymptotic_Rayleigh_integral}, i.e. from
\begin{multline}
\phiPxx(\vx) = \frac{\partial^2}{\partial x^2} \left( \phi^P(\vxo^*(\vx)) + \phi^G(\vx - \vxo^*(\vx)) \right) = 
\mathbf{x}^{*''}_{0,xx}(\vx)  \underbrace{\left( \phi^{P'}_x(\vxo^*(\vx)) - \phi^{G'}_x(\vx - \vxo^*(\vx)) \right)}_{ = 0} + \\
 + \mathbf{x}^{*'}_{0,x}(\vx)^2 \phi^{P''}_{xx}(\vxo^*(\vx))
 + (1 - \mathbf{x}^{*'}_{0,x}(\vx))^2\phi^{G''}_{xx}(\vx - \vxo^*(\vx)).
\end{multline}

Again, the rate of change of the stationary position due to change in the evaluation position $\mathbf{x}^{*'}_{0,x}(\vx)$ has to be expressed, found by the differentiating the implicit definition of the stationary position \eqref{Eq:SFS_theory:Rayleigh25D_horizontal_stat_point}:
\begin{equation}
\mathbf{x}^{*'}_{0,x}(\vx) = \frac{\phi^{G''}_{xx}(\vx - \vxo^*(\vx))}{ \phi^{G''}_{xx}(\vx - \vxo^*(\vx))  -   \phi^{P''}_{xx}(\vxo^*(\vx))}.
\end{equation}
Finally the required second derivative reads as
\begin{equation}
\label{Eq:Asymptotic_second_derivatives}
\phiPxx(\vx) = \frac{\phiPxx(\vxo^*(\vx)) \phiGxx(\vx- \vxo^*(\vx))}
{\phiPxx(\vxo^*(\vx)) + \phiGxx(\vx- \vxo^*(\vx))}
\end{equation}
valid assuming high frequency conditions.
In terms of the principal radii the equation states, that
\begin{equation}
\label{Eq:principal_radii_addition}
\rho^P(\vx)=  \rho^P(\vxo^*(\vx)) + \rho^G(\vx-\vxo^*(\vx))
\end{equation}
reflecting the simple fact, the principal radii of an arbitrary field grows simply linearly with further propagation from $\vxo$ to $\vx$, while obviously the curvature, and thus the second phase derivatives are added reciprocally.
This finding may be employed in order to simplify \eqref{Eq:Rayleigh_integral_approx}.
For the special case of the 3D Green's function $\rho^G_1(\vx-\vxo^*) = \rho^G_2(\vx-\vxo^*) = |\vx-\vxo^*|$ holds and by substituting the explicit expression for the Green's function the equation simplifies to
\begin{equation}
P(\vx) \approx 
P(\vxo^*(\vx))
\sqrt{ \frac{\rho^P_1(\vxo^*) \, \rho^P_2(\vxo^*)}{\rho^P_1(\vx) \, \rho^P_2(\vx)} }
\te^{-\ti k |\vx-\vxo^*(\vx)|},
\end{equation}
where $\rho^P_1(\vx) \cdot \rho^P_2(\vx)$ is the reciprocal of the Gaussian curvature of the wavefront.
Thus, in a ray-tracing manner the wave field is approximated locally by its value at the stationary position: the numerator of the amplitude factor approximates the field in the source position, attenuated by the denominator, given by \eqref{Eq:principal_radii_addition}, while a simple phase shift term corresponds to the propagation time delay.
Also, the equation reflects the fact, that the intensity of the wave field is proportional to the Gaussian curvature of the wavefront, being a well-known fact in the field of optics \cite[Sec. 3.1]{Born1970}, \cite[Sec. 1.3]{Bouche1997}.

Comparing the definition of the stationary points for the Rayleigh integral \eqref{Eq:SFS_theory:Rayleigh25D_horizontal_stat_point} and the stationary SDM evaluation points \eqref{Eq:stationary_evaluation_points}, it is revealed, that they describe stationary point pairs.
Therefore in the spatial SDM driving function \eqref{eq:SFS_theory:spatial_sdm} both the target field and the second phase derivative at the evaluation point $x^*(x_0)$ can be expressed by the corresponding quantities taken at $x_0$, by using \eqref{Eq:Asymptotic_Rayleigh_integral} and \eqref{Eq:Asymptotic_second_derivatives}, respectively, with a substitution of $\vxo^*(\vx) \rightarrow \posvec{3}{x_0}{0}{0}$ and $\vx \rightarrow \posvec{3}{x^*(x_0)}{y}{0}$.

Substituting \eqref{Eq:Asymptotic_second_derivatives} into \eqref{eq:SFS_theory:spatial_sdm} yields the spatial SDM driving functions in terms of the curvatures measured on the SSD
\begin{equation}
D(x_0) \approx 
\sqrt{\left| 
\phiPxx(x_0,0) + \phiGxx(x^*(x_0)-x_0,y)
\right|}
\\
\sqrt{\frac{\ti}{2\pi}} 
\frac{P(x^*(x_0),y)}{G(x^*(x_0) - x_0,y)}.
\end{equation}
Finally, by expressing the target field by \eqref{Eq:Asymptotic_Rayleigh_integral}, the Green's function vanishes and one obtains the asymptotic form of the spatial SDM driving functions written in terms of the target field taken on the SSD
\begin{equation}
\label{Eq:SDM_on_SSD}
D(x_0) \approx 
\sqrt{\frac{8\pi}{\ti}} \\
\frac{1}{\sqrt{ \left| \phiPzz(x_0,0) + \phiGzz(x^*(x_0)- x_0,y ) \right| }}
\ti k_y^P(\vxo)P(\vxo).
\end{equation}

Comparing with \eqref{Eq:SFS_theory:25D_WFS_driv_fun} reveals, that the asymptotic SDM driving functions exactly coincide the 2.5D WFS driving function.
It is important to note, that the WFS driving functions were obtained from the 2.5D Neumann Rayleigh integral in an intuitive manner, by introducing the reference curve concept with interchanging the role of the receiver position and its stationary SSD position. 
On the other hand the driving function \eqref{Eq:SDM_on_SSD} inherently contains the horizontal SPA and the reference curve concept.
It is therefore verified that under high-frequency assumptions WFS is the asymptotic or local approximation of the global explicit solution.

\section{Summary}

TODO: \\
- Write matlab code to regenerate figs 1.6 and 2.6 \\
- Check the stat.position def. for the Rayleigh and KHI! \\
- Check curvature / radii definitions, normalized or not! \\
- Check 3.2/3.3. what goes to appendix \\ 
- Maybe the beginning of 3.3 may go to the 2.3.2 (or to appendix) \\
- Check a (-1) multipl. in 3.15
