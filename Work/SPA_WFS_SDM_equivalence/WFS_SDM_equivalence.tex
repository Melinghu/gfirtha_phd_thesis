\documentclass[12pt,a4paper]{article}
%

\usepackage{layouts}
\usepackage{amsmath}
\usepackage{a4wide}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{graphicx,overpic,subfigure}
\usepackage{tikz}
\usetikzlibrary{positioning,arrows}
\usepackage{booktabs} 			% Nice tables
\usepackage{csquotes}			% Quotation
\usepackage{multirow} 			% Multirow cells in tables
\usepackage{rotating}
\usepackage{pdflscape}
\usepackage[small,bf]{caption}
\usepackage{ae,aecompl}
\usepackage{url}
\usepackage[american]{babel}
\usepackage{hyperref}
\usepackage{nomencl}
\usepackage[toc,page]{appendix}
\usepackage{amssymb}
\usepackage{steinmetz}
\usepackage{palatino}
\usepackage{array}
\usepackage{booktabs}
\usepackage{footnote}
\usepackage{multicol}
%

\newcommand{\dint}{\int\!\!\!\!\!\int}
\newcommand{\tint}{\int\!\!\!\!\int\!\!\!\!\int}
\newcommand{\qint}{\int\!\!\!\!\int\!\!\!\!\int\!\!\!\!\int}
\newcommand{\td}{\mathrm{d}}
\newcommand{\te}{\mathrm{e}}
\newcommand{\ti}{\mathrm{j}}
\newcommand{\sinfi}{\sin\varphi}
\newcommand{\cosfi}{\cos\varphi}
\newcommand{\sinteta}{\sin\theta}
\newcommand{\costeta}{\cos\theta}
\newcommand{\yref}{y_{\mathrm{ref}}}
\newcommand{\vxref}{\mathbf{x}_{\mathrm{ref}}}
\newcommand{\dref}{d_{\mathrm{ref}}}
\newcommand{\vx}{\mathbf{x}}
\newcommand{\vxo}{\mathbf{x}_0}
\newcommand{\vxs}{\mathbf{x}_{\mathrm{s}}}
\newcommand{\vk}{\mathbf{k}}
%
\title{Connection of the explicit solution and unified WFS theory}
\date{\today \\
Budapest University of Technology and Economics, \\ Dept. of Networked Systems and Services, \\ Laboratory of Acoustics and Studio Technologies}
\author{Firtha Gergely}

\begin{document}
\maketitle

\section{Preliminary concepts}
Consider the explicit driving function for a linear SSD consisting of 3D point sources described by $G(\vx,\omega)$.
The driving functions are defined only in the synthesis plane $z=0$:
\begin{equation}
\tilde{D}(k_x,y,\omega) = \frac{\tilde{P}(k_x,y,0,\omega)}{\tilde{G}(k_x,y,0,\omega)}. 
\end{equation}
For the sake of simplicity in the followings both $z$ and $\omega$ dependencies are suppressed.
Restricting of both $P$ and $G$ to the synthesis plane will result up in phase correct synthesis of sound fields, that's local propagation direction is restricted to the same plane.
This can be formulated using the local wavenumber vector.

An arbitrary complex valued sound field may be written in a polar form as
\begin{equation}
P(\vx,\omega) = A_P(\vx,\omega) \te^{\ti \phi_P (\vx,\omega)},
\end{equation}
with $A_P(\vx,\omega), \phi_P(\vx,\omega) \in \mathbb{R} $.
Let's define the local wavenumber vector by
\begin{equation}
\vk^l_P(\vx) = [k_x^l(\vx),\ k_y^l(\vx),\ k_z^l(\vx)]^{\mathrm{T}} = -\nabla \phi_P(\vx,\omega),
\end{equation}
ie.\ as the gradient of the phase function.
The wavenumber vector points in the local propagation direction of an arbitrary sound field, with its magnitude equaling $k = \omega/c$ ie.\ the acoustic wavenumber.
Superscript $l$ is introduced in order to distinguish the here defined local wavenumber from the spectral components in the followings.
Throughout the derivation it is a pre-requisition, that $k_{z,P}^l(x,y,0) = 0$. 

Furthermore, for the sake of simplicity we restrict our investigation into non-converging, or non-focused waves, which we define from simple geometric considerations as waves, for 
\begin{eqnarray}
\frac{\partial}{\partial x} k_{x,P}^l(\vx) = -\frac{\partial^2}{\partial x^2} \phi_P (\vx,\omega) \geq 0, \hspace{3mm}\rightarrow \hspace{3mm} \frac{\partial^2}{\partial x^2} \phi_P (\vx,\omega) \leq 0\\
\frac{\partial}{\partial y} k_{y,P}^l(\vx) = -\frac{\partial^2}{\partial y^2} \phi_P (\vx,\omega) \geq 0, \hspace{3mm}\rightarrow \hspace{3mm} \frac{\partial^2}{\partial y^2} \phi_P (\vx,\omega) \leq 0\\
\frac{\partial}{\partial z} k_{z,P}^l(\vx) = -\frac{\partial^2}{\partial z^2} \phi_P (\vx,\omega) \geq 0 \hspace{3mm}\rightarrow \hspace{3mm} \frac{\partial^2}{\partial z^2} \phi_P (\vx,\omega) \leq 0
\end{eqnarray}
holds.
The equations trivially hold for an acoustic point source.

\section{Inverse Fourier transform of the driving functions}

\subsection{Approximation of wavenumber spectra}
By definition the wavenumber content of the involved quantities are obtained via a forward Fourier transform
\begin{equation}
\tilde{P}(k_x,y) = \int_{-\infty}^{\infty} P(x,y) \te^{\ti k_x x} \td x = \int_{-\infty}^{\infty} A_P(x,y) \te^{\ti \phi_P(x,y)} \te^{\ti k_x x} \td x,
\end{equation}
\begin{equation}
\tilde{G}(k_x,y) = \int_{-\infty}^{\infty} G(x,y) \te^{\ti k_x x} \td x = \int_{-\infty}^{\infty} A_G(x,y) \te^{\ti \phi_G(x,y)} \te^{\ti k_x x} \td x.
\end{equation}
Here $k_x$ denotes the corresponding wavenumber component of the actual global plane wave, constituting the expansion basis of the transform (ie.\ the actual spectral component).

Now consider, that the involved spectra are obtained by using the stationary phase approximation:
Under high-frequency assumptions ($\phi(x,y,\omega)+k_x x \gg 1$) the Fourier integral may be approximated by evaluation around its stationary point (assuming only one stationary point in the integral path).
The stationary point $x^*(k_x)$ is found, where the $x$-derivative of the exponent is zero, ie.\ where
\begin{equation}
- \left. \frac{\partial}{\partial x} \phi(x,y,\omega) \right|_{x = x^*(k_x)} = k_x^l(x^*(k_x),y,\omega) = k_x,
\end{equation}
holds: \emph{the greatest contribution to the wavenumber spectrum at an arbitrary wavenumber $k_x$ has the point in space, where the local wavenumber component $k_x^l(\vx)$ equals $k_x$}.
Note, that it is assumed, that in the sound field each local propagation direction is unique.
Since each $k_x$ wavenumber component assigns a new stationary point, therefore the stationary point for a given $k_x$ is denoted including its dependency by $x^*(k_x)$.

The stationary phase approximation states, that around the stationary point $x^*$ an arbitrary oscillating integral can be approximated as 
\begin{equation}
\int_{-\infty}^{\infty} F(x)\te^{\ti \phi(x)} \td x \approx \sqrt{\frac{2\pi}{| \left. \frac{\partial^2}{\partial x^2} \phi(x)\right|_{x = x^*}|  }}
F(x^*) \te^{\ti \phi(x^*) + 
\ti \frac{\pi}{4} \text{sgn}\left( \left. \frac{\partial^2}{\partial x^2} \phi(x)\right|_{x = x^*} \right)}
\end{equation}

\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth]{Figs/stationary_points.png}
	\scriptsize
	\end{overpic}
	\caption{Illustration of the spatial and spectral location of stationary positions during forward and inverse transform: Figure (a) shows the real part of a 3D point source field, with its wavenumber vector shown along $y_0 = 1.5~\mathrm{m}$, along with the $k^l_x(x,y_0)$ component (b).
Red dots denote three arbitrary chosen points, with $k^l_x(x,y_0) = -0.5,\ 0,\ 0.5$.
Figure (c) shows the wavenumber content $\tilde{P}(k_x,y_0)$ of the sound field.
The red dots in the spatial distribution will dominate the same wavenumber components in the spectrum, denoted by red dots again.
And vice versa, the spectrum in the proximity of these wavenumber components will dominate the spatial distribution in regions, where the local wavenumber components coincide with the spectral bins.}
	\label{fig:stationary_positions}
\end{figure}


Supposing, that $x^*_P(k_x)$ and $x^*_G(k_x)$ are the stationary positions for the corresponding integrals, i.e. 
\begin{eqnarray}
- \left. \frac{\partial}{\partial x} \phi_P(x,y,\omega) \right|_{x = x^*_P(k_x)} = k_{x,P}^l(x^*_P(k_x),y,\omega) = k_x, \\
- \left. \frac{\partial}{\partial x} \phi_G(x,y,\omega) \right|_{x = x^*_G(k_x)} = k_{x,G}^l(x^*_G(k_x),y,\omega) = k_x,
\label{eq:xP_xG_in_spatial_domain}
\end{eqnarray}
holds, and accounting for the negative derivatives---since both $P$ and $G$ are non-converging waves---their spectra can be approximated as
\begin{eqnarray}
\tilde{P}(k_x,y) \approx \sqrt{\frac{2\pi}{\ti |\phi_{P,x,x}''(x^*_P(k_x),y)|}} A_P(x^*_P(k_x),y) \te^{\ti \phi_P(x^*_P(k_x),y)} \te^{\ti k_x x^*_P(k_x)}
\\
\tilde{G}(k_x,y) \approx \sqrt{\frac{2\pi}{\ti |\phi_{G,x,x}''(x^*_G(k_x),y)|}} A_G(x^*_G(k_x),y) \te^{\ti \phi_G(x^*_G(k_x),y)} \te^{\ti k_x x^*_G(k_x)}
.
\end{eqnarray}
For the sake of simplicity the notation $\left. \frac{\partial^2}{\partial x^2} \phi(x)\right|_{x = x^*} = \phi_{x,x}''(x^*)$ is used.

Finally the driving function spectrum can be approximated as
\begin{multline}
\tilde{D}(k_x) \approx 
\sqrt{\frac{|\phi_{G,x,x}''(x^*_G(k_x),y)|}{|\phi_{P,x,x}''(x^*_P(k_x),y)|}}
\frac{A_P(x^*_P(k_x),y)}{A_G(x^*_G(k_x),y)}
\te^{\ti \left( \phi_P(x^*_P(k_x),y) - \phi_G(x^*_G(k_x),y)\right)}
\te^{\ti k_x \left( x^*_P(k_x) - x^*_G(k_x)\right)}=
\\
=\sqrt{\frac{|\phi_{G,x,x}''(x^*_G(k_x),y)|}{|\phi_{P,x,x}''(x^*_P(k_x),y)|}}
\frac{P(x^*_P(k_x),y)}{G(x^*_G(k_x),y)}
\te^{\ti k_x \left( x^*_P(k_x) - x^*_G(k_x)\right)}.
\end{multline}


\subsection{Approximation of the inverse transform}

By definition the inverse Fourier transform of the driving function spectrum is given as
\begin{equation}
D(x_0) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \tilde{D(k_x)} \te^{-\ti k_x x_0} \td k_x.
\label{eq:inverse_transform}
\end{equation}
and using the high-frequency approximate spectra
\begin{multline}
D(x_0) \approx \frac{1}{2\pi} \int_{-\infty}^{\infty} 
\sqrt{\frac{|\phi_{G,x,x}''(x^*_G(k_x),y)|}{|\phi_{P,x,x}''(x^*_P(k_x),y)|}}
\\
\frac{A_P(x^*_P(k_x),y)}{A_G(x^*_G(k_x),y)}
\te^{\ti \left( \phi_P(x^*_P(k_x),y) - \phi_G(x^*_G(k_x),y)\right)}
\te^{\ti k_x \left( x^*_P(k_x) - x^*_G(k_x)\right)}
 \te^{-\ti k_x x_0} \td k_x.
\label{eq:inverse_transform_2}
\end{multline}
As the next step let's evaluate this integral using the SPA:

This time the phase function under consideration is given by 
\begin{equation}
\varphi(k_x) =  \left( \phi_P(x^*_P(k_x),y) - \phi_G(x^*_G(k_x),y)\right) +  k_x \left( x^*_P(k_x) - x^*_G(k_x)\right) - k_x x_0,
\label{eq:phase_function}
\end{equation}
and the stationary wavenumber $k_x^*(x_0)$ found, where 
\begin{equation}
\frac{\partial}{\partial k_x}\left( \left( \phi_P(x^*_P(k_x),y) - \phi_G(x^*_G(k_x),y)\right) +  k_x \left( x^*_P(k_x) - x^*_G(k_x)\right) - k_x x_0 \right) = 0
\end{equation}
satisfies.

Applying the chain rule the derivative is given as
\begin{multline}
\frac{\partial}{\partial k_x} \varphi(k_x) = 
x^{*'}_{P,k_x}(k_x)\left( \phi'_{P,x}(x^*_P(k_x),y) + k_x \right) -\\	 
x^{*'}_{G,k_x}(k_x)\left( \phi'_{G,x}(x^*_G(k_x),y) + k_x \right)
+ \left( x^*_P(k_x) - x^*_G(k_x)\right) - x_0
\end{multline}
Comparing with \eqref{eq:xP_xG_in_spatial_domain} reveals, that  $\phi'_{P,x}(x^*_P(k_x),y) + k_x = 0$ and $ \phi'_{G,x}(x^*_G(k_x),y) + k_x = 0$, thus at the stationary wavenumber $k_x^*(x_0)$
\begin{equation}
\left( x^*_P(k_x^*(x_0)) - x^*_G(k_x^*(x_0))\right) - x_0 = 0
\label{eq:stat_pos_in_kx}
\end{equation}
holds.
Note, that the forward transform positions are dependent only on the evaluation position $x_0$, ie.\ the equation can be rewritten by omitting $k_x^*()$ dependency
\begin{equation}
x^*_P(x_0) -  x^*_G(x_0) - x_0 = 0.
\label{eq:stat_pos_in_kx_2}
\end{equation}

\begin{figure}
	\centering
	\begin{overpic}[width = 1\columnwidth ]{Figs/Spherical_wave_Stationary_point.png}
	\scriptsize
	\put(46.5,9){$x$}
	\put(4,32){$y$}
	\put(16.5,9){$x_0$}
	\put(30,9){$x^*_P(x_0)$}
	%\put(){$x^*_G(x_0) = x^*_P(x_0) - x_0$}
	\put(24,28){$\vk_{P}^l(x^*_P(x_0)) = \vk_{G}^l(x^*_P(x_0)-x_0)$}
	%
	\put(99,9){$x$}
	\put(56.5,32){$y$}
	\put(68.5,9){$x_0$}
	\put(72.5,9){$x^*_G(x_0) = x^*_P(x_0) - x_0$}
	\put(87,28){$\vk_{P}^l(x^*_P(x_0))$}
	\put(72,28){$\vk_{G}^l(x^*_G(x_0))$}
	\end{overpic}
	\caption{Illustration of the stationary points $x^*_P(x_0)$ and $x^*_G(x_0)$.}
	\label{fig:stationary_positions_2}
\end{figure}

In order to interpret this result it is important to realize, that in case of a forward and inverse Fourier transform the stationary positions in spatial and spectral domain mutually determine each other.
Therefore as already stated in the previous section in the spectrum of a wave field one spectral component $k_x$ will be dominated by that parts, of the space, where the local wavenumber $k_x(x^*)$ coincides $k_x$.
And vice versa: in the inverse transform \eqref{eq:inverse_transform} those wavenumber $k_x^*(x_0)$ will dominate the integral at $x_0$, that coincides with the local wavenumber vector of the sound field at $x_0$. 

The equation for the stationary position \eqref{eq:stat_pos_in_kx} therefore satisfies
\begin{eqnarray}
k_x^*(x^*_P(k_x^*(x_0))) = k^l_{x,P}(x^*_P(x_0)) \\
k_x^*(x^*_G(k_x^*(x_0))) = k^l_{x,G}(x^*_G(x_0))
\end{eqnarray}
Finally, reusing the definitions of the forward stationary points \eqref{eq:xP_xG_in_spatial_domain}
\begin{equation} 
k^l_{x,P}(x^*_P(x_0)) = k^l_{x,G}(x^*_G(x_0))
\end{equation}
must hold.
Substituting \eqref{eq:stat_pos_in_kx_2} the original stationary position $x^*_P(x_0)$ is found for a given $x_0$, where 
\begin{equation}
k^l_{x,P}(x^*_P(x_0)) = k^l_{x,G}(x^*_P(x_0) - x_0).
\end{equation}
This result is of central importance in the aspect of the present derivation: it states, that the driving function at $x_0$ is dominated by the stationary positions $x^*_P(x_0)$ and $x^*_G(x_0)$ taken at $y$, and these positions are defined as the positions, where the local propagation direction of the virtual sound field and the Green's function placed on the SSD at $x_0$ coincide.
See Figure \ref{fig:stationary_positions_2} for an illustration.

In order to evaluate the inverse integral using the SPA one still needs the second derivative of the phase function \eqref{eq:phase_function}, reading
\begin{multline}
\frac{\partial^2}{\partial k_x^2} \varphi(k_x) = 
 \left( x^{*'}_{P,k_x}(k_x)^2 \phi_{P,x,x}^{''}(x^*_P (k_x),y)  + 2 x^{*'}_{P,k_x}(k_x)\right) 
\\
-\left( x^{*'}_{G,k_x}(k_x)^2 \phi_{G,x,x}^{''}(x^*_G(k_x),y)  +  2 x^{*'}_{P,k_x}(k_x)\right) 
\label{eq:second_Derivative}
\end{multline}
The rate of change of the stationary positions $ x^{*'}_{P,k_x}(k_x)$ and $ x^{*'}_{G,k_x}(k_x)$ can be expressed by differentiating their definition expression \eqref{eq:xP_xG_in_spatial_domain} w.r.t. $k_x$:
\begin{eqnarray}
\phi'_{P,x}(x^*_P(k_x),y) + k_x = 0, \\
\phi'_{G,x}(x^*_G(k_x),y) + k_x = 0, \\
x^{*'}_{P,k_x}(k_x) = -\frac{1}{ \phi{''}_{P,x,x}(x^*_P(k_x),y) }, \\
x^{*'}_{G,k_x}(k_x) = -\frac{1}{ \phi{''}_{G,x,x}(x^*_G(k_x),y) }, 
\end{eqnarray}
and the second derivatives simplifies to
\begin{equation}
\frac{\partial^2}{\partial k_x^2} \varphi(k_x) = \frac{ \phi{''}_{P,x,x}(x^*_P(k_x),y) - \phi{''}_{G,x,x}(x^*_G(k_x),y)}{\phi{''}_{P,x,x}(x^*_P(k_x),y) \phi{''}_{G,x,x}(x^*_G(k_x),y)}.
\label{eq:second_Derivative_2}
\end{equation}
The second derivative of the phase function, ie.\ the rate of change of the wavenumber vector, is proportional to the curvature of the field at a given position (with a factor (-1) present).
However the curvature of any source positioned behind the SSD will be smaller, than that of a point source, located at $y = 0$ for any $y>0$ position.
Therefore, for an arbitrary simple sound field $k_{x,G,x}'(\vx) > k_{x,P,x}'(\vx)$ and $\phi{''}_{P,x,x}(x^*_P(k_x),y) - \phi{''}_{G,x,x}(x^*_G(k_x),y) >0$ holds.
This determinates the sign function in the SPA.

Finally, substituting this result (Eq.\eqref{eq:second_Derivative_2}) along with \eqref{eq:stat_pos_in_kx} into the SPA in order to evaluate integral \eqref{eq:inverse_transform_2} one obtains (due to the positive sign of the derivatives simplifications may be done)
\begin{equation}
D(x_0) \approx
\sqrt{\frac{\ti}{2\pi}} 
\sqrt{\frac{ \left| \phi{''}_{G,x,x}(x^*_G(x_0),y )\right|^2}{\left| \phi{''}_{P,x,x}(x^*_P(x_0),y) - \phi{''}_{G,x,x}(x^*_G(x_0),y)\right|}}
\frac{P(x^*_P(x_0),y)}{G(x^*_G(x_0),y)}
\end{equation}
Since the stationary positions are related as \eqref{eq:stat_pos_in_kx_2}, therefore it is feasible, to introduce $x^*(x_0) = x^*_P(x_0)$, and the driving function reads
\begin{equation}
D(x_0) \approx
\sqrt{\frac{\ti}{2\pi}} 
\sqrt{\frac{ \left| \phi{''}_{G,x,x}(x^*(x_0)-x_0,y )\right|^2}{\left| \phi{''}_{P,x,x}(x^*(x_0),y) - \phi{''}_{G,x,x}(x^*(x_0) - x_0,y)\right|}}
\frac{P(x^*(x_0),y)}{G(x^*(x_0) - x_0,y)}.
\label{eq:spatial_sdm}
\end{equation}

\begin{figure}
	\centering
	\begin{overpic}[width = .95\columnwidth ]{Figs/sdm_circle_referencing.png}
	\scriptsize
	\end{overpic}
	\caption{Synthesis of a 2D point source (a,c) and a 3D point source (b,d) located at $\vxs = [0,\ -1,\ 0]^\mathrm{T}$, oscillating at $\omega_0 = 2\pi \cdot 1 ~\mathrm{krad/s}$. The synthesis is referenced on a circle around the virtual source, with a radius of $R_{\mathrm{ref}} = 3~\mathrm{m}$.}
	\label{fig:sdm_spatial_1}
\end{figure}

The result is of primary importance in the aspect if the present treatise.
It states, that an arbitrary sound field may be synthesized by finding the positions along the reference line, at which the propagation direction/wavefront of the target field matches the field of the actual SSD elements.
In this stationary position the driving functions are obtained by the ratio of the target field and the SSD, corrected by the factor, containing the wavefront curvature at the same position.
Therefore the explicit, global solution can be approximated by simple local wavefront matching.

One important fact is pointed out here: although having derived the above driving functions in terms a forward an inverse spatial Fourier transform along a straight line, there is no restriction in the $y$-coordinate of the stationary point in \eqref{eq:spatial_sdm} due to the local approximations involved: the $y$-coordinate might be $x_0$-dependent. This means, that an arbitrary referencing curve may be defined as $\vxref(x,y)$, and the driving functions can be calculated by finding the stationary positions $k_{x,P}^l(\vxref(x_0)) = k_{x,P}^l(\vxref(x_0) - x_0)$ along this curve. Evaluating the driving functions in the stationary positions will result in amplitude correct synthesis along the reference curve. 


\subsubsection{Application example}
As a simple application consider the synthesis of a 2D/3D point source, referencing the synthesis to a circle around the virtual point source. For the sake of simplicity the source is located at $\vxs = [0,\ y_s,\ 0]^{\mathrm{T}}$. Along with the equation describing the reference curve the stationary points satisfy the following equations (since the phase function of a 2D and 3D point source is approximately the same for 2D and 3D point sources)
\begin{align}
k \frac{x^*(x_0)}{\sqrt{x^*(x_0)^2 + (y(x_0)-y_s)^2}} &= k \frac{x^*(x_0)-x_0}{\sqrt{(x^*(x_0)-x_0)^2 + y(x_0)^2}}, \\
x^*(x_0)^2 + (y(x_0)-y_s)^2     &= R_{\mathrm{ref}}^2.
\end{align}
The solution for the equations with taking only the positive root into consideration is given by
\begin{align}
x^*(x_0) &= x_0 \frac{ R_{\mathrm{ref}}}{\sqrt{x_0^2 + y_s^2}} \\
y(x_0) 	 &= y_s \left( 1 -  \frac{R_{\mathrm{ref}}}{\sqrt{x_0^2 + y_s^2}}\right)
\end{align}
Substituting into \eqref{eq:spatial_sdm} yields the explicit driving function in the spatial domain referencing the synthesis on a circle. In this case the only difference between the 2D and 3D point source driving functions is the actual form of $P(x^*(x_0),y(x_0))$.

Investigating Figure \ref{fig:sdm_spatial_1} verifies, that in both cases the synthesis is optimized on the prescribed reference curve.

\section{Inverse propagating the driving functions}

In order to show more connections between SDM and WFS our aim is to express the driving functions in terms of the target field taken on the SSD.
Let's express an arbitrary sound field at $\vx = [x,\ y,\ z]^{\mathrm{T}}$ using the 3D Rayleigh integral:
\begin{equation}
P(x,y,z) = \iint_{-\infty}^{\infty} \frac{\partial}{\partial y}P(x_0,0,z) G(x-x_0,y,z-z_0) \td z_0 \td x_0.
\end{equation}

\end{document}